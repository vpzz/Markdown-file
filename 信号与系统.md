# 绪论

1. 控制论的创始人维纳认为信号不是能量，也不是物质，信息论的创始人香农认为信号是用来消除不确定性的东西，它使用事情$x$发生的概率$p(x)$定义信息量，$-\log(p(x))$。
2. 信号是表达信息的符号。表达同一个信息可以有不同的方式，也就是不同的信号，例如烽火台，语音，文字等。利用光和电的变化来传递信息是现代科学的一大进展。
3. 信号的举例：
   1. 语音信号，一维，变化依赖于时间，幅值表示音量。男女生的频率不同。
   2. 图像信号，二维，像素值随着位置变化。
   3. 视频信号，三维，图像随着时间变化。
4. 隔着橱窗来拍里边的模特，就会得到一个带有街边景色反光的照片，这里橱窗+相机就是一个系统，输入是街边的景色还有模特，输出就是带有街边景色反光的照片。
5. 系统就是接受输入信号，运算后输出信号。复杂系统可以拆分为多个简单的子系统。

## 信号的分类

1. 信号可以分为确定信号和随机信号。也可以分为连续时间信号，离散时间信号（也称为序列）。连续信号用$x(t)$表示，离散信号用$x[n]$表示。
2. 确定信号可以表示为一个或几个自变量（多维）的函数。
3. 周期信号  $x(t+mT)=x(t)$或者$x[n+mN]=x[n]$​。m取整数，T和N为最小正周期。
4. 任何一个信号都可以分解为一个奇信号(奇部)+一个偶信号(偶部)。
5. 根据信号的值的取值范围，可以分为实信号和复信号。
6. 离散时间信号是针对于时间来说的，只在特定时间点上有意义，其外没有定义。
7. 数字计算机只能处理数字信号（幅值量化后的离散时间信号）。模拟电路才可以处理连续时间信号。
8. 对连续时间信号采样即可获得离散时间信号。离散时间信号的自变量一般取整数。
9. 一维连续信号的能量和平均功率（如果是复信号或向量，绝对值符号表示取模）：
   1. 连续时间信号在$[t_1,t_2]$区间的能量定义为$E=\int_{t_1}^{t_2}|x(t)|^2dt$。平均功率为$P=E/(t_2-t_1)$。将区间$[t_1,t_2]$取极限，就可以得到无限区间上连续时间信号的总能量：$E_\infty=\lim\limits_{T\to \infty} \int_{-T}^T |x(t)|^2dt=\int_{-\infty}^\infty |x(t)|^2dt$和平均功率：$P_\infty=\lim\limits_{T\to \infty}\frac{1}{2T} \int_{-T}^T |x(t)|^2dt$。
   2. 离散时间信号在区间$[n_1,n_2]$的能量为：$E=\sum\limits_{n=n_1}^{n_2}|x(n)|^2$，平均功率为：$P=E/(n_2-n_1+1)$。包括端点，一共$n_2-n_1+1$个点。将$[n_1,n_2]$取极限，可得无限区间上离散时间信号的总能量：$E_\infty=\lim\limits_{N\to\infty}\sum\limits_{-N}^N|x(n)|^2=\sum\limits_{-\infty}^\infty|x(n)|^2$和平均功率：$P_\infty=\lim\limits_{N\to\infty}\frac{1}{2N+1}\sum\limits_{-N}^N|x(n)|^2$。

10. 任何时间信号都可以看做是无限时间的。周期信号的功率可以只计算周期内的能量，将其除以周期大小即可。
11. 三类重要信号：
    1. 能量信号：总能量是有限的。$E_\infty<\infty$，$P_\infty=0$。
    2. 功率信号：信号具有无限的能量，但是平均功率有限。$E_\infty=\infty$，$0<P_\infty<\infty$。
    3. 信号的总能量和功率都是无限的，$E_\infty<\infty$，$P_\infty=\infty$。
12. 周期信号一定是功率信号。因为区间无限，幅值重复，总能量是无限的，无限区间的平均功率=一个周期内的平均功率，是有限的。
13. <img src="信号与系统.assets/image-20210314093555817.png" alt="image-20210314093555817" />
14. 有限长序列或绝对可和的无限长序列都是能量信号。
15. 一般提到信号时，正弦和余弦信号统称为正弦信号。

## 自变量变换

1. 自变量的变化，实际上是信号的变换。
2. 时移变换：$x(t)\to x(t-t_0)$，当$t_0>0$时，相当于信号向右平移$t_0$。遵循左加右减的规则，$x(-t+t_0)$相当于$x(-t)$右移$t_0$。
3. 将时移后的信号和原信号叠加，可以模拟出回声或者卡拉OK的感觉。
4. 反转变换：$x(t)\to x(-t)$，信号以$t=0$做镜像对称。$x(t-t_0)$和$x(-t-t_0)$镜像对称。
5. 尺度变换，$x(t)\to x(at)$，信号在时间上压缩或扩展。a>1时，表示压缩。对离散时间信号进行尺度变换有可能漏掉部分信号，因此一般只对连续时间信号进行尺度变换。这里的压缩扩展的中心都是原点。
6. 对于离散时间信号来说，尺度变换$x[mn]$当$m>1$时，称为抽取序列或下采样（因为采样间隔是mT，原来的m倍）。例如$x[n]=\{0,1,2,3,4,5,6\}$，则$x[2n]=\{0,2,4,6\}$。尺度变换$x[n/m]$当$m>1$时，称为插值序列或上采样。此时$x[n/2]=\{0,0,1,0,2,0,3,0,4,0,5,0,6\}$。
7. 举例：将$x(t)$变成$x(3t-1/2)$有3种方法，前两种是常规的方法，都是用$at$或$t+t_0$替换现有的$t$。在做法一的第二步中，缩放的中心是原点，如果是对$t-1/2$​整体乘以3，那么相当于是把尺度变换的中心变为了1/2。
8. <img src="信号与系统.assets/image-20210314100222976.png" alt="image-20210314100222976"  />
9. <img src="信号与系统.assets/image-20210314100554262.png" alt="image-20210314100554262"  />
10. 最小正周期也成为基波周期。如果已知最小正周期内的信号，可以由此获得任意时刻的信号。
11. $x(t)=c$可以视为周期信号，但它的基波周期没有明确的定义。
12. $x[n]=c$可以视为周期信号，其基波周期为1。
13. 非周期信号可以延拓成周期信号。

## 复指数信号和正弦信号

1. 信号处理中之所以引入复信号，是为了方便数学处理和计算。引入复信号后，就不再需要对正弦信号进行和差化积了。实际上只存在实信号，因为传感器只能采集到实数。
2. 复信号可以在复平面和时间轴构成的三维空间中表示。同时可以分别向实（虚）轴和时间轴构成的平面上投影，得到的分别为实部和虚部的图像。

### 连续的复指数信号

1. $x(t)=Ce^{at}$。其中C和a是复数。如果C和a都是实数，那么称为实指数信号。否则它就是复指数信号。
   1. $a>0$时，单调上升，在实际应用中不希望看到，因为随着时间的推移，信号的能量不断增大，会导致系统被破坏。
   2. $a<0$时 ，单调下降趋于0，是一个能量信号。
   3. $a=0$时，$x(t)=C$。
2. 如果$a=j\omega_0,C=1$，那么$x(t)=\cos\omega_0t+j\sin\omega_0t$。实部和虚部都是正弦信号。$x(t)$是周期信号，它的基波周期为$2\pi/|\omega_0|$。
3. 即使C是一个复数，例如$C=a+jb$，那么可以将复数C写作指数表示为$\sqrt{a^2+b^2}e^{j\arctan{b/a}}$。将复数C乘上$e^{j\omega_ot}$就相当于，随着时间变化，复数C在复平面上绕原点转动。
4. 根据欧拉公式，$x(t)=A\cos(\omega_0t+\phi)=\frac{A}{2}e^{j\phi}e^{j\omega_0t}+\frac{A}{2}e^{-j\phi}e^{-j\omega_0t}$。
5. 复指数信号$x(t)=e^{j\omega_ot}$是一个功率信号。在无穷区间上，它的能量是无穷大的，但是平均功率是有限的，等于一个周期内的平均功率=1。$E_T=\int_0^{T_0}|e^{j\omega_0t}|^2dt=\int_0^{T_0}1\cdot dt=T_0$，$P_T=E_T/T_0=1$。
6. 成谐波关系的复指数信号的集合如下，他们的频率分别为$k\omega_0$，都是$\omega_0$的整数倍。因此称他们为谐波关系。$\phi_k(t)=\{e^{jk\omega_0t}\},k=0,\pm1,\pm2\cdots$。其中任意两个不同的信号，都是互相正交的。该集合构成一个完备正交函数基底。
7. 对于一般的复指数信号，作如下变换，该信号的实部和虚部都是幅值呈实指数变化规律的正弦震荡。
8. <img src="信号与系统.assets/image-20210314163214252.png" alt="image-20210314163214252"  />
9. $x(t)$的实部和虚部满足以下特点，幅值呈实指数变化规律的正弦震荡。
14. <img src="信号与系统.assets/image-20210314163622955.png" alt="image-20210314163622955"  />

### 离散的复指数信号

1. $x[n]=C\alpha^n$，此时指数的底数不使用e，而是使用一个复数。$C，\alpha$一般为复数。如果$C，\alpha$都是实数。

2. <img src="信号与系统.assets/image-20210314164634214.png" alt="image-20210314164634214"  />

6. 离散的正弦信号：$x[n]=e^{j\omega_0n}=\cos\omega_0n+j\sin\omega_0n$。

7. 一般的复指数信号$x[n]=C\alpha^n$也可以写作正弦信号，例如：

8. <img src="信号与系统.assets/image-20210314165303114.png" alt="image-20210314165303114"  />

9. 根据$|\alpha|$来区分震荡的特征，可以发现无论$\alpha$取什么值，实部或虚部的值总是震荡的：

10. <img src="信号与系统.assets/image-20210314165435850.png" alt="image-20210314165435850"  />

11. 对于连续时间信号$x(t)=e^{j\omega_0t}$来说，当$\omega_0$增大时，信号震荡的频率会越来越高，基波周期越来越小。

9. 而对于离散时间信号$x[n]=e^{j\omega_0n}$来说，当$\omega_k=\omega_0+2\pi k$时，$e^{j\omega_kn}=e^{j\omega_0n}$。因此$\omega_k$和$\omega_0$构成的信号本质是一个信号（因为他们对于任意n的结果是相同的）。所以离散时间信号的有效频率范围为$0\to 2\pi$。当$\omega_0=0$或$2\pi k$时，都对应最低频率。当$\omega_0=\pi$或$2\pi k+\pi$时，都对应最高频率，即周期最小。

18. 如果一个复信号是周期的，那么它的实部和虚部都应该是周期的，此处以实部来演示，下图中的周期依次为：1，16，8，4，2，4，8，16，1。

19. <img src="信号与系统.assets/image-20210315091453095.png" alt="image-20210315091453095" />

20. <img src="信号与系统.assets/image-20210315091704970.png" alt="image-20210315091704970" />

21. 对于$\omega_0=15\pi/8$，$\omega_0/2\pi=16/15$，得出N=16.即周期为16，频率$\omega=2\pi/N=\pi/8$。

22. 离散时间周期性复指数信号也可以构成一个呈谐波（频率倍数关系）关系的信号集。
    $$
    \phi_k[n]=\{e^{j\frac{2\pi}{N}kn}\}\quad k=0,\pm1,\pm2 \cdots
    $$

23. 对于$N=16，\omega=\pi/8$的情况，多次谐波分量的频率分别为$k\omega=0,\pi/8,\pi/4,3\pi/8\cdots$。周期N分别为1，16，8，16，4，16，8，16，2，16，8，16，4，16，8，16，1

24. 谐波的频率是基波频率的整数倍，但是他们的周期只能是基波的周期的因数。例如16的因数有16,8,4,2,1等。因此对于$e^{j\frac{2\pi}{16}n}$这样一个信号，他的谐波有$e^{j\frac{2\pi}{16}n}$，$e^{j\frac{2\pi}{8}n}$，$e^{j\frac{2\pi}{4}n}$，$e^{j\frac{2\pi}{2}n}$，$e^{j\frac{2\pi}{1}n}$。分别对应于k=1,2,4,8,16(0)。

25. 假如基波的周期$N=15,\omega=2\pi/15$，则多次谐波分量的频率分别为$k\omega=0,2\pi/15,4\pi/15,8\pi/15\cdots$。周期N分别为1，15，15，5，15，3，5，15，15，5，3，15，5，15，15  再往后就会循环了。

26. 假如基波的周期$N=13$，那么多次谐波分量的周期分别为将$k/13$化简为最简分数时，分母的值。因为13为质数，因此无论k取任何值，得到的N都为13。因此它只有自己一个谐波。

27. 离散时间周期性复指数信号构成的谐波集合中，所有信号不都是相互独立的，因为存在$\phi_{k+N}[n]=\phi_k[n]$。说明只有N个信号是相互独立的。可以取连续的N个信号来构成一个完备的正交基。这是和连续时间最大的不同。

28. <img src="信号与系统.assets/image-20210315111651119.png" alt="image-20210315111651119" />


## 单位冲激与单位阶跃信号

1. 一般来说单位冲激指的是连续时间的，单位脉冲指的是离散时间的。
2. 连续时间单位脉冲和阶跃信号。离散时间内的差分，转到连续时间上就变成了微分。阶跃函数是不连续的，在t=0处没有定义，可以取任意值。
3. <img src="信号与系统.assets/image-20210315152237151.png" alt="image-20210315152237151"  />
4. $\delta(t)$的函数图像如下，对它进行积分，如果积分区间包含0，则积分值为1，否则为0。
5. <img src="信号与系统.assets/image-20210315153118823.png" alt="image-20210315153118823" />
6. 显然由$\int_{-\infty}^\infty\delta(t)dt=1$，$u(t)=\int_{-\infty}^t\delta(\tau) d\tau=\int_0^{\infty}\delta(t-\tau) d\tau$​。
7. $u(t)$可以看做是斜坡函数$u_\Delta(t)$，当$\Delta\to 0$的极限。因此$\delta_\Delta(t)$的极限也为$\delta(t)$。可以看出，$\delta(t)$在0点的值为$+\infty$，冲击强度（矩形面积）为1，它不是一个普通的函数和信号，这个函数是定义出来的，不是推导出来的。
8. <img src="信号与系统.assets/image-20210315152537843.png" alt="image-20210315152537843"  />
9. 连续时间单位脉冲也有提取样本的作用。$x(t)\delta(t-t_0)=x(t_0)\delta(t-t_0)\ne x(t_0)$。不能省略$\delta(t-t_0)$。
10. 用阶跃信号的差来表示矩形的脉冲，高度为1。
11. <img src="信号与系统.assets/image-20210315154638484.png" alt="image-20210315154638484" />
12. 离散时间的单位脉冲（抽样）序列，这个信号和其他离散时间信号相乘，可以得到一个脉冲信号的倍数，这个倍数为该信号在$n_0$时的值，这个信号可以用来提取对应信号的对应位置的值。如果要提取$n=3$时的值，可以乘以$\delta[n-3]$。$x[n]*\delta[n-n_0]=x[n_0]\delta[n]=x[n_0]$。类似于一个采样的操作。
13. <img src="信号与系统.assets/image-20210315150426756.png" alt="image-20210315150426756"  />
14. 离散时间的单位阶跃信号（序列），这个信号也有提取信号的功能，可以将对应信号的某个点一侧的信号提取出来，例如提取信号从n=4开始向右的值，可以乘以$u[n-4]$。
15. <img src="信号与系统.assets/image-20210315150814775.png" alt="image-20210315150814775"  />
16. 连续时间单位脉冲信号是奇异信号，因为零时刻取值为无穷大，而离散时间单位脉冲信号是正常信号，零时刻取值为1，而非无穷大。后者并非前者的采样，阶跃信号也是一样的。
17. 二者的关系：
    1. $\delta[n]=u[n]-u[n-1]$。一次差分。
    2. $u[n]=\delta[n]+\delta[n-1]+\delta[n-2]+\cdots=\sum\limits_{k=0}^\infty\delta[n-k]$​​。
    3. $x[n]=\sum\limits_{k=-\infty}^{+\infty}x[k] \delta[n-k]$。每一项都可以拆分为一个值缩放的脉冲信号。上式是此式的一个特例。

## 抽样函数

1. $Sa(t)=\frac{\sin t}{t}$，且$Sa(0)=1$，它是一个偶函数。$\int_0^\infty Sa(t)dt=\pi/2$。$\int_0^\infty \frac{\sin(\omega t)}{t}dt=\pi/2$。
2. 该函数的特殊性为：它是唯一一个连续积分，离散求和均为1的函数。
   1. 连续形式：$\int_{-\infty}^{+\infty}\frac{\sin(\omega t)}{\pi t}dt$，当$\omega>0$时，值为1；当$\omega=0$时，值为0；当$\omega<0$时，值为-1。
   2. 离散形式：$\sum_\limits{n=-\infty}^{+\infty}\frac{\sin(\omega n)}{\pi n}$，当$0<\omega<\pi$时，值为1；当$\omega=0$时，值为0；当时$-\pi<\omega<0$，值为-1。

## 系统的分类

1. 输入和输出都是连续时间的系统称为连续时间系统，都是离散时间的，称为离散时间系统。如果一方是离散，另一方是连续，这个就成为数模/模数转换器。
3. 线性，系统满足齐次性和可加性。多个输入信号的线性组合的输出，等于各自信号输出的线性组合。注意，这里都是针对信号值进行操作的，而非自变量t。
   1. 齐次性，如果$x(t)\to y(t)$，那么$ax(t)\to ay(t)$。a是任意实常数。
   2. 可加性，如果$x(t)\to y(t),m(t)\to n(t)$，那么$x(t)+m(t)\to y(t)+n(t)$。
4. 系统$y(t)=x(t)+3$​不满足齐次性，它可以看做是增量齐次的。例如$x(t)=0$的输入。
5. 系统$y(t)=t*x(t)$​​是线性系统，比较反直觉。
6. 系统$y(t)=x(t)^2$​不是线性系统。
7. 系统$y(t)=e^{x(t)}$不是线性系统，可以通过泰勒展开判断。
8. 求导和求积分都是线性的系统。$y[n]=x[n]-x[n-1]$是离散的微分器（差分），$y[n]=\sum\limits_{k=-\infty}^nx[k]$​是离散的积分器。
9. 时不变性，当输入信号有一个时移，那么输出信号也会进行相同的时移，除此之外无任何变化。$x(t)\to y(t),\quad x(t-t_0)\to y(t-t_0)$​。
10. 系统$y(t)=x(2t)$是时变系统。
11. 系统$y(t)=t*x(t)$​是时变系统。
12. 系统$y[n]=x[3-n]$是时变系统。
13. LTI(Linear Time-Invariant System)，线性时不变系统。对于LTI，如果输入是0，那么输出也是0，因为$x(t)-x(t)\to y(t)-y(t)$。
14. 因果系统：系统在任意时刻的输出都只和这个时刻和之前时刻的输入有关，而和这个时刻以后的输入无关。一般来说非因果的系统在物理上不可实现的，只是在理论上分析。
15. 系统$y(t)=x(t-1)$是因果系统。输出比输入延迟1个时间单位。
16. 系统$y(t)=x(t+1)$是因果系统。
17. 系统$y(t)=x(2t)$​是非因果系统。
18. 系统$y[n]=x[3-n]$​​是非因果系统。
19. 微分器是因果的，虽然它需要计算左右极限，但是这里隐含了左右极限相同，因此可以只计算左极限。
20. 对于一些自变量不是时间的信号，例如图像信号（自变量是坐标位置），可以用延时的方法来实现非因果系统。例如$y[n]=x[-n]$​，对于n<0时的输出，是依赖于n>0的输入的。
21. 无记忆系统：系统在任意时刻的输出都只和当前时刻的输入有关，反之为有记忆系统。无记忆系统一定是因果系统。
22. 系统$y(t)=x(t-1)$是记忆系统。
23. 系统$y(t)=t\cdot x(t)$是无记忆系统。
24. 常见的记忆系统有电容器，累加器，差分器。
25. 可逆系统：系统对于不同的输入，一定产生不同的输出，即输入和输出是一一对应的。对于相同的输入，系统一定产生相同的输出，这个是确定无疑的，任意系统都满足。
26. 系统$y(t)=x^2(t)$​不是可逆系统。
27. 积分器是可逆系统。微分器不是，因为积分存在常数C，不唯一。累加器和差分器都是可逆的。
28. 稳定性，当系统的输入有界时，产生的输出也是有界的。单摆，RC电路都是稳定系统。还有一种稳定性的定义就是，系统对于输入的微小变化，输出变化不大，这是蝴蝶效应的观点。
29. 系统$y(t)=e^{x(t)}$是有界的，只有当$x(t)$无界时，$y(t)$才无界。
30. 微分器是不稳定系统，对于阶跃信号输入来说，输出为冲激信号，是无界的。但差分器是稳定的。
31. 积分器是不稳定系统，对于$x(t)=1$的输入，输出是无界的。但累加器是稳定的。
32. 系统之间可以进行互联，一般有两种方式：
    1. 级联，也成为串联，将上一个系统的输出作为下一个系统的输入。
    2. 并联，将相同的输入分别输入两个并联的系统，将得出的两个输出在进行一定的运算，得出并联的输出。
    3. 反馈连接，将第一个系统的输出作为某个反馈系统的输入，将反馈系统的输出和原始输入一起作为第一个系统的输入。
33. 一个系统和它的逆系统串联，则会得到一个恒等系统。输出=输入。
34. 调制和编码过程必须是可逆的，其逆系统为解调器和解码器。

# 线性时不变系统

1. 研究复杂信号在线性时不变系统下的输出，可以将该信号分解为多个基本信号的线性组合，由于基本信号在线性时不变系统中的输出是容易求得的，因此问题的实质是信号的分解。
2. 只需要知道LTI的一个$x(t)$对应的$y(t)$，即可求得所有$x(t)$对应的$y(t)$​。
3. 也可以对LTI系统进行分解，时不变性质允许自变量$t$的平移，线性性质允许因变量$x(t)$​的缩放和叠加。
4. LTI的叠加性是满足可列可加性的。
5. 上述方法是在时域对信号进行分解，也可以在频域或变换域对信号进行分解。

## 离散LTI

1. 对于离散时间信号来说，最简单的就是单位脉冲信号，它可以组合成单位阶跃信号。任意离散信号都可以看做是一系列移位加权单位脉冲信号的求和。

2. 离散的LTI也成为LSI（linear shifting invariant）。

3. 卷积（Convolution）的计算方法有：公式法，列表法。

4. $x[n]=\sum\limits_{k=-\infty}^{+\infty} x[k]\delta[n-k]=x[n]*\delta[n]$，这是离散时间信号的分解。对于一个系统S，输出$S(x[n])$为$\sum\limits_{k=-\infty}^{+\infty}x[k]S(\delta[n-k])$​，这是根据线性性质得到的。

5. 如果是LTI系统，且$\delta[n]\to h[n]$，那么$\delta[n-k]\to h[n-k]$。即不用计算那么多次输入的响应，只用计算一次$\delta[n]$的响应，然后平移即可，这里利用了LTI的时不变性质。$h[n]$称为单位脉冲响应。

6. 如果一个LTI系统S的单位脉冲响应为$h[n]$，则它对于$\delta[n-k]$的响应为$h[n-k]$，因此对于任意输入$x[n]$，它的响应为$\sum\limits_{k=-\infty}^{+\infty}x[k]h[n-k]$。也就是将$\delta$变成$h$。

7. 因此$S(x[n])=x[n]*h[n]=\sum\limits_{k=-\infty}^{+\infty}x[k]h[n-k]$，这个就是标准的卷积和。可以看出来只要知道该系统对于单位脉冲信号的响应$h[n]$，则该系统对于任意输入信号的响应就都可以据此得出。

8. 同理，一个LTI系统也完全可以由它对于的单位脉冲信号的响应来表征。上面这种求得系统对相应输入信号的响应的方法称为卷积和。

9. 使用*来表示两个序列的卷积和，结果也是一个序列。

10. $$
      x[n]*h[n]=\sum_{k=-\infty}^{+\infty}x[k]h[n-k]
$$
11. 列表法计算序列卷积和：可以看到求和的自变量相加$k+(n-k)=n$是一个定值，k是变化的。整个算法对于一些硬件是比较容易实现的。

12. 两个序列分别为<img src="信号与系统.assets/image-20210315200659410.png" alt="image-20210315200659410" style="zoom:50%;" />，箭头表示0点。即$x[0]=0,h[0]=4$。

13. <img src="信号与系统.assets/image-20210315200137322.png" alt="image-20210315200137322"  />

14. 卷积和中的零点位置的计算方法：待卷积序列的起点坐标求和就是卷积和起点坐标。即$-2+(-1)=-3$，$y[-3]=1$​，则卷积和的零点在第四个非零值处。

15. 序列并非在整个整数范围取值都非零，因此卷积和中很多项都是0，也存在很多全0项相加的情况。

16. 列表法计算卷积和的算法复杂度为$O(N^2)$，因为需要$N^2$次乘法和$N^2$次加法。使用快速傅里叶变换的方法，可以将计算复杂度降低为$O(NlogN)$​。

17. 卷积运算可以分为4步：翻转，平移，相乘，求和。将$h[k]$翻转得到$h[-k]$，然后向右移动n个单位，得到$h[-(k-n)]=h[n-k]$​。然后计算两个序列的对应元素的乘积，最后对k求和。

## 连续LTI

1. 类似的，连续时间信号也可以用一系列移位加权单位（纵坐标取值为1，而非冲激函数）脉冲信号的线性组合来近似。

2. 对于一般信号，可以将其分为很多宽度$\Delta$的区段，用一个阶梯信号$x_\Delta(t)$来近似表示$x(t)$。这样的一个阶梯信号可以由多个脉冲信号组合而成。

3. <img src="信号与系统.assets/image-20210315202642647.png" alt="image-20210315202642647" />

4. $u(t-\Delta)-u(t-2\Delta)$就是一个矩形的脉冲$\delta_\Delta(t)$，从$\Delta\to 2\Delta$取值为1，其余均为0。求和范围从$-\infty$到$+\infty$。$x(t)=\cdots+x(k\Delta)[u(t-k\Delta)-u(t-k\Delta-\Delta)]+\cdots$。

5. 给上面的式子乘除一个$\Delta$，再让$\Delta\to 0$，这样无限求和，就可以写成积分的形式。

6. <img src="信号与系统.assets/image-20210315205411177.png" alt="image-20210315205411177" />

7. 定义$\delta(t)=\lim_{\Delta\to0}\delta_\Delta(t)$，若$\delta_\Delta(t)\to h_\Delta(t)$，由于LTI运算和取极限可以交换顺序，假设极限$\lim_{\Delta\to0}h_{\Delta}(t)$存在，且为$h(t)$，则$\delta(t)\to h(t)$。

8. 如果一个线性系统对信号$\delta(t-\tau)$的响应为$h_\tau(t)$，那么该系统对信号$x(t)$的响应为$S(x(t))=\int_{-\infty}^{+\infty}x(\tau)h_\tau(t)$。如果系统是时不变的，即如果$\delta(t)\to h(t)$，那么$\delta(t-\tau)\to h(t-\tau)$。

9. 对于LTI系统，任意信号$x(t)$的响应为：
$$
   S(x(t))=\int_{-\infty}^{+\infty}x(\tau)h(t-\tau)\text{d}\tau=x(t)*h(t)
$$
10. 连续时间系统由它的单位冲激响应$h(t)$​来表征。这种求得系统响应的方法称为卷积积分。

11. 从系统的角度来看，可以说$\delta(t)$是一个恒等系统的单位冲激响应。因此任意信号$x(t)$在恒等系统下的响应仍然是它本身，即$x(t)=x(t)*\delta(t)$，这就是在卷积运算下$\delta(t)$​的定义。可以说冲激信号是和任意信号卷积都等于原信号的信号。

12. 两个宽度一样的方波卷积结果是三角波，宽度不同卷积为梯形波。

13. LTI系统稳定的充要条件：$\int_{-\infty}^{+\infty}|h(t)|dt<+\infty$，即绝对可积。离散情况为：$\sum_{k=-\infty}^{+\infty}|h[n]|<+\infty$。

14. LTI系统是因果系统的充要条件：当$t<0$时，$h(t)=0$。

## 冲激函数

1. 将$\delta(t)$定义为$\text{d}u(t)/\text{d}t$是不严密的，因为$u(t)$在$t=0$时不连续。进而引入$\delta_\Delta(t)$，极限逼近。这种定义的方法仍然不严格。因为有很多不同的函数在$\Delta\to 0$时，都表现为与$\delta_\Delta(t)$相同的特性。
2. <img src="信号与系统.assets/image-20210316151335258.png" alt="image-20210316151335258"  />
3. <img src="信号与系统.assets/image-20210316151532913.png" alt="image-20210316151532913" />
4. 之所以产生这种现象，是因为$\delta(t)$​​是一个非常规函数，也就是奇异函数。通常用在卷积或积分运算下所表现出的特性来定义这些奇异函数。它们在勒贝格相等意义下是一样的。
5. $\lim_\limits{\omega\to+\infty}\frac{\sin(\omega t)}{\pi t}=\delta(t)$​。这个函数是迪利克雷在证明傅里叶级数收敛性时定义的。
6. 黎曼-勒贝格定理：若$x(t)$不是无限振荡的函数，则$\lim_\limits{\omega\to+\infty}\int_{-\infty}^{+\infty}x(t)\cos(\omega t)dt=0$。sin的也一样。
7. 冲激函数的性质：
   1. $\int_{-\infty}^{+\infty}\delta(t)\text{d}t=1$，令$x(t)=1$​，可求得。
   2. $\int_{-\infty}^\infty g(t)\delta(t-t_0)dt=g(t_0)$，这称为抽样性质，可以使用积分中值定理来证明。
   3. $x(t)\delta(t)=x(0)\delta(t)$。使用勒贝格关于函数相等的定义和性质2可以证明。
   4. $\delta(at)=\delta(t)/|a|$，$\delta(at+b)=\delta(t+b/a)/|a|$​。
   5. $\delta(f(t))=\sum_{所有f(t_0)=0}\delta(t-t_0)/|f'(t_0)|$。$\delta(\cos t)=\sum_\limits{k=-\infty}^{+\infty}\delta(t-k\pi-\pi/2)$，是若干个冲激函数的和。
8. 两个函数相等在初等数学中的定义要求二者在所有点上取值都相等。勒贝格在1904年，给出了扩展定义：若$f_1(t)$和$f_2(t)$相等，则对于任意函数$y(t)$，都满足$\int_{-\infty}^{+\infty}y(t)f_1(t)dt=\int_{-\infty}^{+\infty}y(t)f_2(t)dt$。这包含了如下定义：两个函数仅在有限个点上取值不同。这也是为什么阶跃函数在0点没有定义，或者取任意值都可以。
9. 但是如果在一段连续的区间上，两个函数的取值不同，则勒贝格定义下二者不等。
10. 若两个函数按照上述定义相等，则对任意$x(t)$，有$x(t)*f_1(t)=x(t)*f_2(t)$。逆命题也是成立的。
11. 除此之外，勒贝格还定义了一种黎曼积分的扩展，所有黎曼可积的函数，都是勒贝格可积的，反之不一定，例如狄利克雷函数（在有理数时为1，无理数时为0）。
12. 如果使用勒贝格积分，则上述函数相等的定义还可以扩展为可数个点上不等的两个函数。
13. 若$g(t)$是奇函数，则$g(0)=0$，因此$\delta(t)$​为偶函数。
14. 冲激偶函数：$\delta'(t)=d\delta(t)/dt$，具有性质：$\int_{-\infty}^{+\infty}x(t)\delta'(t)=-x'(0)$。用分部积分证明，该性质也可以作为它的定义。之所以称为冲激偶函数，是因为如果将$\delta(t)$看作方波近似时，求导取极限，可以发现在零附近一正一负两个冲激。

## 卷积的性质

1. 连续系统的卷积积分和离散系统卷积和统称为卷积：

2. 交换律：$x[n]*h[n]=h[n]*x[n]$。$x(t)*h(t)=h(t)*x(t)$。

3. 交换率的证明：辩证地看，$h(t)$是一个LTI的单位冲激响应。实际上任意一个信号都可以看做是一个LTI的单位冲激响应。因此$x(t)$也存在一个与之对应的LTI。将x(t)输入h(t)系统得到的响应=将h(t)输入x(t)系统得到的响应。

4. 求和对卷积的分配律，相当于系统的并联。

5. $x(n)*[h_1(n)+h_2(n)]=x(n)*h_1(n)+x(n)*h_2(n)$。

6. $x(t)*[h_1(t)+h_2(t)]=x(t)*h_1(t)+x(t)*h_2(t)$。

7. 等号左右端分别表示如下两个系统对信号x(t)的响应。这个表示两个系统并联的单位脉冲响应=各个系统单位脉冲响应之和。

8. 结合律：级联系统的单位脉冲响应=将第一个系统的单位脉冲响应输入第二个系统所得到个结果。相当于系统的串联。

9. $[x(n)*h_1(n)]*h_2(n)=x(n)*[h_1(n)*h_2(n)]$。

10. $[x(t)*h_1(t)]*h_2(t)=x(t)*[h_1(t)*h_2(t)]$。

11. 由于卷积满足交换律，因此系统级联的顺序可以调换。$[x(n)*h_1(n)]*h_2(n)=[x(n)*h_2(n)]*h_1(n)$。

12. 以上定律的前提条件是卷积求和或积分都是收敛的。

13. 卷积的差分性质：若 $x(n)*h(n)=y(n)$，则 $[x(n)-x(n-1)]*h(n)=y(n)-y(n-1)$​​，分配律的扩展。

14. 卷积的微分器性质：$x(t)*\delta'(t)=dx(t)/dt$。可得$d[x(t)*h(t)]/dt=dx(t)/dt*h(t)=dh(t)/dt*x(t)$。注意，这里不是莱布尼茨规则。

15. 卷积的积分器性质：$x(t)*u(t)=\int_{-\infty}^tx(\tau)d\tau$。用卷积的定义即可证明。

16. 卷积的累加器性质：$x[n]*u[n]=\sum\limits_{k=-\infty}^nx[k]$。

17. 卷积的时移性质：若$x(n)*h(n)=y(n)$，则 $x(n-n_0)*h(n)=x(n)*h(n-n_0)=y(n-n_0)$，可以将$h[n]$看做是一个LTI，LTI具有时不变的性质。同理$x(t+t_0)*h(t-t_0)=x(t)*h(t)$。更进一步：$x[n]*\delta[n-n_0]=x[n-n_0]$。

18. 卷积的求和性质：$[\sum\limits_{k=-\infty}^nx(k)]*h(n)=x(n)*[\sum\limits_{k=-\infty}^nh(k)]=\sum\limits_{k=-\infty}^ny(k)$。

19. 无记忆系统的单位冲激/脉冲响应为$h[n]=k\delta[n]$，$h(t)=k\delta(t)$。 当k=1时，系统是恒等的。恒等系统的单位冲激/脉冲响应为单位冲激/脉冲响应。

20. $\delta(t-t_0)*\delta(t+t_0)=\delta(t)$，延时系统$\delta(t-t_0)$和它的逆系统。

21. 累加器系统的单位冲激/脉冲响应为单位阶跃函数。

22. 连续时间系统的阶跃响应和它的冲激响应之间有如下关系：

23. $$
    \begin{array}{l}
    s(t)=u(t)*h(t)\quad s(n)=u(n)*h(n)\\
    s(t)=\int_{-\infty}^th(\tau)d\tau \quad h(t)=\frac{d}{dt}s(t)\\
    s(n)=\sum\limits_{k=-\infty}^nh(k) \quad h(n)=s(n)-s(n-1)
    \end{array}
$$

24. 卷积中的反问题：已知$x(t)*h(t)=y(t)$中的$x(t)$和$y(t)$，如何求$h(t)$。可以利用卷积定理，对等式两侧分别进行傅里叶变换，可以求得$H(j\omega)$，然后再进行傅里叶逆变换即可求得$h(t)$​。

## 用微分和差分方程来描述因果LTI

1. 除了使用冲激/脉冲响应来表征LTI，还可以用线性常系数的微分/差分方程来表征LTI。

2. LCCDE Linear Constant-Coefficient Differential Equation 线性常系数微分方程。

3. 一般形式如下：方程的解=通解+特解。$y(t)=y_h(t)+y_p(t)$​。
   $$
   \sum\limits_{k=0}^Na_k\frac{d^ky(t)}{dt^k}=\sum\limits_{k=0}^Mb_k\frac{d^kx(t)}{dt^k}\quad a_k,b_k均为常数
   $$

4. 令$b_k=0$，可以求得齐次方程的通解。要求齐次方程的通解，可以根据该齐次方程建立一个特征方程，$\sum\limits_{k=0}^{N}a_k\lambda^k=0$。求出方程的特征根。在特征根均为单阶根时，齐次方程的通解为$\sum\limits_{k=0}^{N}C_ke^{\lambda_kt}=0$。$C_k$是待定的常数，由初始条件和边界条件确定。微分方程的特解是和输入$x(t)$同类型的函数。

5. 当微分方程描述的系统是线性系统时，即系统的输入为$x(t)$，输出为$y(t)$。由于线性系统满足零输入→零输出的特点，因此当$x(t)=0$时，方程的解$y(t)$恒为0。当$x(t)=0$时，微分方程退化为齐次的了，可以导出$C_k=0$。因此描述线性系统的微分方程其通解必为0。即LCCDE具有一组零附加条件时，才能描述线性系统。

6. 当这组零附加条件是在信号加入时刻给出的，LCCDE描述的系统不仅是线性的，还是因果的和时不变的。

7. 在信号加入时刻给出的零附加条件，称为零初始条件。

8. LCCDE具有一组全部为零的初始条件可以描述一个LTI因果系统，这组条件是：$y(0)=y'(0)=\cdots=y^{(N-1)}(0)=0$。

9. 如果一个因果的LTI有LCCDE描述，且具有零初始条件，那么称这个系统初始是静止的，或者最初是松弛的。

10. LCCDE Linear Constant-Coefficient Difference Equation 线性常系数差分方程。
    $$
    \sum\limits_{k=0}^Na_ky(n-k)=\sum\limits_{k=0}^Mb_kx(n-k)
    $$

11. 与微分方程类似，它的解法也是通解+特解。通解也是用特征方程来求。确定通解中的常数，也需要一组附加条件。

12. 如果一个LCCDE具有一组全部为零的初始条件时，所描述的系统就是线性，因果，时不变的。

13. Matlab中使用`filter(b,a,x)`来求解差分方程，其中$b=[b_0,b_1,\cdots,b_M]$，$a=[a_0,a_1,\cdots,a_N]$，且$a_0$不为零（因为它是$y[n]$的系数），$x$为输入序列，函数输出为y。

14. 对于差分方程，可以改写为如下形式：
    $$
    y(n)=\frac{1}{a_0}\left[ \sum\limits_{k=0}^Mb_kx(n-k)-\sum\limits_{k=1}^Na_ky(n-k) \right]
    $$

15. 因此要确定$y[0]$，需要$y[-1],y[-2],\cdots,y[-N]$。这就是一组初始条件。进一步可以由$y[0],y[-1],\cdots,y[-N+1]$得出$y[1]$。可以看出这个系统是具有反馈性质的。将之前的输出作为新的输入的一部分。差分方程可以采用递推的方法求解，因此也称为递归方程。

16. 若$a_k=0,k\ne0$时，差分方程变为$y(n)=\sum\limits_{k=0}^M\frac{b_k}{a_0}x(n-k)$，此时求解方程不再需要迭代计算，没有反馈，因此为非递归方程。

17. 此方程就是卷积和的形式，相当于$h[n]=\frac{b_n}{a_0},0\le n\le M$。此时系统的单位脉冲响应是有限长的，因而将这种方程描述的LTI称为FIR(Finite Impulse Response)有限脉冲响应系统。将递归方程描述的LTI称为IIR(Infinite Impulse Response)无限脉冲响应系统，此时系统的单位脉冲响应是一个无限长的序列。

18. FIR系统一定是稳定的。

19. FIR和IIR系统是离散时间LTI系统中重要的两类系统，他们的特性，结构，设计方法都有很大的差异。

20. 微分方程或差分方程的特解都具有与输入相同的函数形式，即特解由输入信号完全确定。因而特解对应的这部分称为受迫响应，齐次方程通解对应的部分和输入信号无关，也成为系统的自然响应。

21. 用方框图来表示差分方程描述的LTI系统。方程中包含三种基本的运算：乘系数，相加，移位（延迟）。可以用如下三个符号表示：

22. <img src="信号与系统.assets/image-20210316141819461.png" alt="image-20210316141819461" />

23. 方程如下：$y(n)=\frac{1}{a_0}\left[ \sum\limits_{k=0}^Mb_kx(n-k)-\sum\limits_{k=1}^Na_ky(n-k) \right]$拆成两部分，先求FIR系统$x[n]\to w[n]$。

24. 直接I型的系统可以将两个子系统直接级联起来。不过需要两倍的延时器。

25. <img src="信号与系统.assets/image-20210316142033417.png" alt="image-20210316142033417" />

26. 直接II型的系统，假定M<N，则$b_N$的末尾一些系数都为0即可。

27. <img src="信号与系统.assets/image-20210316142344017.png" />

28. 微分方程也可以由框图来表示，乘系数，相加，微分。但是由于微分器在工程上实现有困难，而且对误差和噪声极其敏感，因此工程上通常使用积分器而不是微分器。

29. 将微分方程两侧同时积分N次，即可得到一个积分方程。$\sum\limits_{k=0}^Na_ky_{(N-k)}(t)=\sum\limits_{k=0}^Nb_kx_{(N-k)}(t)$​。

# 傅里叶级数的由来

1. 傅里叶当初时为了求解热传导方程才发明了傅里叶变换的，下式为一维热传导方程，第二行为初始条件，K为导热系数，和介质有关。

2. $$
   \frac{\partial f}{\partial t}=K\frac{\partial^2 f}{\partial x^2}\\
   f(x,0)=f(x)
   $$

3. 对于一般的$f(x)$，上式没有解析解，但是傅里叶发现对于某些特殊的初始条件，可以求得温度随时间的变化$f(x,t)$，例如：

   1. $f(x)=B_0$，推出$f(x,t)=B_0$。
   2. $f(x)=B\cos(\omega x)$，推出$f(x,t)=B\cos(\omega x)e^{-K\omega^2t}$。
   3. $f(x)=C\sin(\omega x)$，推出$f(x,t)=C\sin(\omega x)e^{-K\omega^2t}$。

4. 1807年，傅里叶向巴黎科学院提交论文，推到了著名的热传导方程，并提出：

   1. 如果$f(x)=B_0+\sum_\limits{k=1}^{+\infty}B_k\cos(k\omega_0x)+\sum_\limits{k=1}^{+\infty}C_k\sin(k\omega_0x)$，其中$k$是自然数。则方程的解为$f(x,t)=B_0+\sum_\limits{k=1}^{+\infty}B_k\cos(k\omega_0x)e^{-Kk^2\omega_0^2t}+\sum_\limits{k=1}^{+\infty}C_k\sin(k\omega_0x)e^{-Kk^2\omega_0^2t}$​。这里假定了$f(x)$是以$2\pi/\omega_0$为周期的周期信号，这样才可以保证右侧的级数的每一项都是以$2\pi/\omega_0$为周期的信号。

5. 这是因为热传导方程是线性的，或者说它是一个LTI系统。

6. 上式将初始条件表示为一组基函数的线性组合，$1,\cos(\omega_0x),\cos(2\omega_0x),\cdots,\sin(\omega_0x),\sin(\omega_0x),\cdots$。其中$\omega_0$称为基波频率，$k\omega_0$称为k次谐波频率，$B_k,C_k$为k次谐波的频谱分量，$B_0$为直流分量。之所以将$f(x)$表示为某个基波频率的谐波组合，是为了方便根据给定的$f(x)$，求$\omega_0,B_0,B_k,C_k$。可以通过积分方法可以求解，存在如下性质：

   1. $\int_0^{T_0}\cos(k\omega_0x)dx=0$，$\int_0^{T_0}\sin(k\omega_0x)dx=0$。其中$T_0=2\pi/\omega_0$​，称为基波周期。
   2. $\int_0^{T_0}\cos(k_1\omega_0x)\cos(k_2\omega_0x)dx=0$，当$k_1\ne k_2$。使用积化和差公式证明。
   3. $\int_0^{T_0}\cos(k_1\omega_0x)\sin(k_2\omega_0x)dx=0$​​。
   4. $\int_0^{T_0}\sin(k_1\omega_0x)\sin(k_2\omega_0x)dx=0$，当$k_1\ne k_2$。
   5. $\int_0^{T_0}\cos^2(k\omega_0x)dx=T_0/2$。
   6. $\int_0^{T_0}\sin^2(k\omega_0x)dx=T_0/2$。

7. 以上性质说明了该组基函数中任意两个都是正交的，可见傅里叶将信号进行了正交分解。

8. 可以推出$B_0=(\int_0^{T_0}f(x)dx)/T_0$。在$f(x)$两侧乘以$\cos(k\omega_0x)$然后在$[0,T_0]$积分，即可求得$B_k$。因此$B_k=\frac{2}{T_0}\int_0^{T_0}f(x)\cos(k\omega_0x)dx$，$C_k=\frac{2}{T_0}\int_0^{T_0}f(x)\sin(k\omega_0x)dx$。

9. 傅里叶的论文在提交后，就被拒绝了， 因为它没有证明$f(x)$的级数表示的收敛性，或者说是否任意函数都可以写成级数展开的形式。这一问题指导30年后，才由迪利克雷解决。

10. 傅里叶是第一个将函数分解为一组正交基的线性组合的人。后来又出现了各种类型的正交基。

11. Haar小波正交基：包含无穷多组函数，方波，正负变换的方波，然后继续拆分。之所称之为小波是因为，它只在时间轴上的某段取值不为0，而正余弦函数是不满足这个性质的。

12. PCA是主成分分析，作用是从一大堆数据中，自动训练出一组正交基。在深度学习出来前，人脸识别就是进行PCA，将一个特定的人脸图像分解到一组互相正交的人脸上，然后只要存储线性组合的系数即可。经验来看，世界上的任何一个人脸都可以只取前500项来表示。通过比较两个人脸的系数向量的差的范数来进行人脸相似性识别，而非直接对图片进行做差。


# 周期信号的傅里叶级数表示

1. 周期信号的表示处理是较为容易的。
2. 从分解信号的角度出发，基本信号单元必须满足如下两个条件：
   1. 本身是简单的，且通过LTI系统的响应也是简单的。
   2. 具有普遍性，能够用来构成广泛的信号。
3. 在时域内，单位冲激/脉冲或阶跃信号都满足上面的两个条件。除此之外，还有一类信号就是三角函数。
4. 傅里叶的两个重要贡献：
   1. 周期信号都可以用成谐波关系的正弦信号的加权和。
   2. 非周期信号都可以用正弦信号的加权积分来表示。

## LTI 对复指数信号的响应

1. 两类常见的复指数信号$e^{st}$和$Z^n$。一个是连续时间的，一个是离散时间的。s和Z都是复数。
2. <img src="信号与系统.assets/image-20210316155741210.png" alt="image-20210316155741210" />
3. 特征函数：如果系统对某个信号的响应等于该信号乘以一个常数，那么该信号就被称为系统的特征函数。该常数称为系统与该特征函数对应的特征值。
4. 只有复指数信号才能称为一切LTI的特征函数，前提是特征值$H(s)$的积分收敛。

## 连续时间周期信号的傅里叶级数表示

1. 成谐波关系的复指数信号的集合：$\Phi_k(t)=\{e^{jk\omega_0t}\}\quad k=0,\pm1,\pm2,\cdots$。所有信号都是独立的，每个信号的频率分别为$k|\omega_0|$。这个集合构成一个正交基，由于包含复数，因此函数内积的定义为$<x(t),y(t)>=\int_{T_0}x(t)\cdot\overline{y(t)}dt$，需要用到共轭复数。$\overline{e^{jk\omega_0t}}=e^{-jk\omega_0t}$。
2. 将该信号集合中的所有信号做一个线性组合，有$x(t)=\sum\limits_{k=-\infty}^{+\infty}a_ke^{jk\omega_0t}$。显然$x(t)$也是以$2\pi/|\omega_0|$为周期的。该级数就是傅里叶级数，$a_k$称为傅里叶级数的系数。
3. 这表明傅里叶级数可以用来表示连续时间的周期信号，$a_0$是直流分量。$e^{\pm jk\omega_0t}$​是第k次谐波分量。
4. 实信号的傅里叶级数表示可以简化为三角级数。复数表示和三角函数表示是相通的，$B_0=a_0$，$B_k=a_{-k}+a_k$，$C_k=j(a_k-a_{-k})$。复数形式更加方便。
5. 例如$x(t)=\cos \omega_0t+2\cos3\omega_0t=\frac{1}{2}[e^{j\omega_0t}+e^{-j\omega_0t}]+e^{j3\omega_0t}+e^{-j3\omega_0t}$。该信号中由4个谐波分量，即$k=\pm1,\pm3$是对应的谐波分量。

### 频谱

1. 在傅里叶级数中，各个信号分量间的区别仅仅是幅度$a_k$和频率$\omega$的不同，因此可以用一根线段来表示某个分量，其长度为$a_k$，位置$k\omega_0$表示该分量对应的频率。这一表示就将时域变换到了频域。频谱图就是$a_k\sim\omega$的关系。由于信号的频谱图完全代表了信号的特点，因此研究信号的频谱就可以研究信号。这种表示方法称为信号的频域表示法。有时某些复杂信号，在频域表达较为简单。
3. <img src="信号与系统.assets/image-20210316170846729.png" alt="image-20210316170846729" />
4. 因此，可以画出一半周期信号$x(t)$的频谱图如下：
5. <img src="信号与系统.assets/image-20210316170945278.png" alt="image-20210316170945278" />
6. 如果$x(t)$是实信号，即$x(t)=\overline{x(t)}$，那么可以得出$a_k=\overline{a_{-k}}$。傅里叶系数关于k=0共轭对称。因此$x(t)=a_0+2\sum\limits_{k=1}^\infty A_k\cos(k\omega_o t+\theta_k)$。其中$a_k=A_ke^{j\theta_k}$，$\overline{a_k}=A_ke^{-j\theta_k}$。$a_0,A_k$为实数。

### 傅里叶系数的确定

1. 下式中的$T_0$为$x(t)$的周期。由正交性可得，下式等号右边积分为$a_kT_0$。

2. <img src="信号与系统.assets/image-20210316192921862.png" alt="image-20210316192921862" />

3. 因此可求得$a_k$如下，积分区间不一定是$0\to T_0$，只要是一个长度为$T_0$的范围即可。
   $$
   a_k=\frac{1}{T_0}\int_0^{T_0}x(t)e^{-jk\omega_0t}\text{d}t=\frac{1}{T_0}\int_{T_0}x(t)e^{-jk\omega_0t}\text{d}t
   $$
   
4. $a_k$是信号的某种加权平均。

### 周期型矩形脉冲信号的频谱

1. 周期性脉冲信号的频谱是Sa(x)函数在$k\omega_0$上的采样。也可以看做一个离散的信号，并且正负都有取值。
2. <img src="信号与系统.assets/image-20210316194309730.png" alt="image-20210316194309730" />
3. $\text{sinc}(x)$函数图像为
4. <img src="信号与系统.assets/image-20210316194745063.png" alt="image-20210316194745063" />
5. 脉冲信号相当于是一个窗口，一般情况下设计窗口都是在频谱上先进行设计，再进行逆变换。
6. $2T_1/T_0$被称作脉冲信号的占空比，定义为周期内信号不为零的时间除以整个周期的长度。
7. 周期信号的频谱为离散的。仅在$k\omega_0$这些点上有取值。
8. <img src="信号与系统.assets/image-20210316201735490.png" alt="image-20210316201735490" />

### 傅里叶级数的收敛性

1. 傅里叶级数收敛性的两层含义：
   1. 系数$a_k$是否存在？
   2. 级数是否收敛于$x(t)$？
2. 狄利克雷条件分别保证上述两个收敛性。

   1. 在任何周期内信号都是绝对可积的。由此可得$|a_k|\le\frac{1}{T_0}\int_{T_0}|x(t)e^{-jk\omega_0t}|dt=\frac{1}{T_0}\int_{T_0}|x(t)|dt<\infty$。因此$a_k$为有界值，必存在。

   2. 在任何有限区间内，只有有限个极值点，且极值为有限值。这要求该函数振荡不太剧烈。

   3. 在任何有限区间内，只有有限个第一类间断点。
3. <img src="信号与系统.assets/image-20210316203220800.png" alt="image-20210316203220800" />
4. 第一类间断点包含可去间断点(该点两侧极限均存在，且相等)和跳跃间断点（该点两侧极限均存在，但不等）。不连续点就是间断点。
5. 狄利克雷条件是傅里叶级数收敛的充分条件，不是必要条件。
6. 如果$x(t)\stackrel{FS}{\longrightarrow}a_k$，那么$x(t-t_0)\stackrel{FS}{\longrightarrow}a_ke^{-jk\omega_0t_0}$，其中$\omega_0$为信号$x(t)$的频率。信号的时移会使得频谱在纵轴上进行缩放。
7. 反转后信号的频谱等于将原信号的频谱翻转。$x(-t)\stackrel{FS}{\longrightarrow}a_{-k}$。
8. 尺度变换会改变频谱的横向分布，因为$\omega_0$发生了变化。$x(at)\stackrel{FS}{\longrightarrow}a_k$。相当于在横向对频谱进行了压缩或拉伸。
9. 信号相乘后的频谱等于各自的频谱做卷积和。$x(t)*y(t)\stackrel{FS}{\longrightarrow}\sum\limits_{l=-\infty}^{+\infty}a_lb_{k-l}=a_k*b_k$。
10. 当近似计算时，可以去前几项傅里叶系数，构成的傅里叶级数部分和来逼近信号$x(t)$。
11. 吉布斯现象，信号是一个对称方波，$T=4T_1$。方波满足狄利克雷条件，因此随着$N\to \infty$，$x_N(t)$在不连续点的极限应该是$x(t)$在不连续点处的平均值。从下图可以看出，随着$N\to \infty$，部分和的起伏会向不连续点处压缩。但是对于任何有限的N来说，起伏的峰值大小保持不变，这就是吉布斯现象。是固有的现象，无法去除。如果信号$x(t)$没有间断点，则没有吉布斯现象。
12. <img src="信号与系统.assets/image-20210316210437100.png" alt="image-20210316210437100"  />


## 离散时间周期信号的傅里叶级数表示

1. 考察成谐波关系的复指数信号集：$\Phi_k[n]=\{e^{jk\frac{2\pi}{N}n}\}$，这些信号都是以N为周期的（不一定是它们的基波周期，这个主要看N的因数多少）。该信号集中只有N个信号是互相独立的。

2. 将这N个信号线性组合起来，一定能表示一个以N为周期的序列$x[n]$，这个级数就被称作离散时间傅里叶级数（DFS）。$a_k$就被称作周期信号$x[n]$的频谱。
   $$
   x[n]=\sum_{k=<N>}a_ke^{jk\frac{2\pi}{N}n}\quad其中k为N个相连的整数。
   $$
   
3. DFS更像是普通的求和(有限项)，一定收敛。

### 傅里叶系数的确定

1. 利用正交性来确定系数：

2. $$
   a_k=\frac{1}{N}\sum\limits_{n=<N>}x[n]e^{-j\frac{2\pi}{N}kn}
   $$

3. 可以看出$a_k$也是以周期为N来重复的，$a_k=a_{k+N}$。$a_k$中只有N个是独立的。

4. 周期为N的矩形序列$R_N[n]$如下，可以将[0，N-1]看做基本重复段。也可以将[-N1，N-N1-1]作为基本重复段。占空比为$(2N_1+1)/N$。

5. <img src="信号与系统.assets/image-20210325145455406.png" alt="image-20210325145455406" />

6. 为了方便求解$a_k$，可以取连续的非零段，频谱函数如下：
   $$
   a_k=\frac{1}{N}\frac{\sin\frac{\pi}{N}k(2N_1+1)}{\sin\frac{\pi}{N}k}\quad当k\ne 0,\pm N, \pm 2N,\cdots
   $$

   $$
   a_k=\frac{2N_1+1}{N}\quad 当k=rN时
   $$

7. 显然$a_k$的包络具有函数$\sin\beta x/\sin x$的形状（$\beta=2N_1+1$）。和连续时间信号不同的是，矩形序列的频谱不具有衰减性。

8. <img src="信号与系统.assets/image-20210325153249878.png" alt="image-20210325153249878"  />

9. 当N1不变，N增大时。频谱的包络形状不变，只是幅度减小，谱线变密。水平方向不压缩。

10. 当N不变，N1变大时，即$\beta\uparrow$，频谱的包络形状变化。


# 连续时间的傅里叶变换

## 非周期信号的傅里叶变换

1. 工程应用中相当广泛的信号是非周期的，非周期信号的处理主要有两种方法：

   1. 有限区间上的非周期信号可以将其延拓，变成无限区间上的周期信号，然后再将周期趋向于$\infty$取极限。
   2. 将非周期信号看做周期趋向于$\infty$的周期信号。

2. 傅里叶级数只能对周期信号求得，而傅里叶变换还可以对非周期信号求得。对于周期性矩形脉冲信号，占空比=$2T_1/T_0$，$T_0=2\pi/\omega_0$。

3. <img src="信号与系统.assets/image-20210417092331091.png" alt="image-20210417092331091" />

4. 该周期信号的傅里叶系数如下：
   $$
   a_k=\frac{2T_1}{T_0}\frac{\sin k\omega_0T_1}{k\omega_0T_1}
   $$

5. 当$T_0$增大时，频谱的幅度减小，谱线的间隔$\omega_0$也变小。频谱图的横纵坐标等比例进行了缩放，频谱的形状不变。

6. 当$T_0$趋向于$\infty$时，周期的矩形脉冲趋向于非周期的单个矩形脉冲。同理，他们的傅里叶级数也存在这样的近似。

7. 当$T_0$趋向于$\infty$时，离散的频谱会变成连续的（$\omega_0,k\omega_0\to \text{d}\omega,\omega$）。$a_k$是趋于0的，考虑$a_kT_0$的结果：
   $$
   a_kT_0=\int_{-T_0/2}^{T_0/2}\widetilde{x}(t)e^{-jk\omega_0t}\text{d}t
   $$

8. 当$T_0$趋向于$\infty$时，令上式左边$a_kT_o=X(j\omega)$，则得：
   $$
   X(j\omega)=\int_{-\infty}^{\infty}x(t)e^{-j\omega t}\text{d}t
   $$

9. 称$X(j\omega)$为连续时间信号$x(t)$的傅里叶变换，是一个含参的无穷积分，积分结果是$\omega$的函数，变换到了频域。

10. 与周期信号的傅里叶频谱相比有$a_k=\frac{1}{T_0}X(jk\omega_0)$​。因此，周期信号的频谱就是其对应的非周期信号的频谱的样本。反过来讲，非周期信号的频谱是周期信号频谱的包络。

11. 利用上述公式可以快速计算周期信号的傅里叶级数分解系数$a_k$，傅里叶变换更通用。首先将周期信号截断为仅在任意一个周期内有值的非周期信号，然后对该信号求傅里叶变换，得到$X(j\omega)$，最后利用上述公式得到$a_k$，可以将结果中的$\omega_0 T_0$替换为$2\pi$。

12. $X(j\omega)$并不是非周期信号的频谱，而是频谱密度函数。因为$X(j\omega)=\lim\limits_{T_0\to\infty} a_kT_0=\lim\limits_{f_0\to\infty} a_k/f_0$。因此可以将$X(j\omega)$看做频谱密度函数。这里的$f_0$是频率，$\omega_0$为圆频率。

13. 同理信号$x(t)$可以由它的频谱构成的傅里叶级数求和得到，因此可以求得傅里叶逆变换：
    $$
    x(t)=\frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)e^{j\omega t}\text{d}\omega
    $$

14. 上式表明，非周期信号可以分解为无数多个频率连续（$\omega_0\to0$）分布，幅值$a_k$近似为0的复指数（周期）信号的加权叠加。

15. $x(t)$和$X(j\omega)$称为傅里叶变换对，注意逆变换需要额外除以$2\pi$。傅里叶变换有时可以将复杂的信号变得简单，容易处理。也有先做逆变换，处理完之后，再做正变换，移动通信中的基本都是这样。

16. 傅里叶变换和傅里叶级数的收敛性一致，有两大充分条件，满足其一即可：

    1. 若$x(t)$是能量有限的信号，则它的傅里叶变化一定存在。现实生活中，多数的信号都是能量有限的，一般认为只在观察的时间段是有信号的，其余时间取值都是0。
    2. 满足如下狄利克雷条件，傅里叶变换也存在：
       1. 信号在无穷区间上绝对可积，$\int_{-\infty}^{\infty}|x(t)|<\infty$。注意这里并非一个周期内的积分。
       2. 在任何有限区间内，$x(t)$只有有限个极值点，且极值有限。
       3. 在任何有限区间内，$x(t)$只有有限个第一类间断点。

## 常见的非周期信号的傅里叶变换

1. $x(t)=e^{-at}u(t),a>0$，实负指数衰减信号，信号在负半轴取值为0。经过验算，该信号的总能量为$1/2a$，满足收敛性条件。
2. <img src="信号与系统.assets/image-20210417103211752.png" alt="image-20210417103211752" />
3. $X(j\omega)=1/(a+j\omega)$。通常不将该复数展开为实部和虚部，而是写成欧拉形式$X(j\omega)=|X(j\omega)|e^{j\angle X(j\omega)}$，然后分别绘制幅值和幅角（或相位）关于$\omega$的变化：
4. <img src="信号与系统.assets/image-20210417104807285.png" alt="image-20210417104807285"  />
5. 上述幅度谱可以看出，它是一种典型的低通滤波器（并非完全理想），因为在频率较低时幅度取值较大，频率较高时，幅度取值较小。低通滤波器的截止频率是指幅度衰减为极值$1/a$的$1/\sqrt{2}\approx0.707$倍时对应的频率，此时$\omega=a$，也称为功率衰减3dB（因为$20\log(1/\sqrt{2})≈3$​），也成为半功率点。
6. 关于功率和幅度衰减的分贝定义是不同的，之所以这么定义，是因为$P=F^2/T$。
   1. 功率衰减：$L_{P}=10\log _{10}\!\left({\frac {P}{P_{0}}}\right)\,{\text{dB}}$，其中$P$和$P_0$分别为测量功率和参考功率。

   2. 幅值衰减：$L_{F}=20\log\left({\frac {F}{F_{0}}}\right)\,{\text{dB}}$，其中$F$和$F_0$分别为测量幅值和参考幅值。

7. 通常说的半功率就是指$P/P_0=0.5$，此时$L_P=L_F=-3\text{dB}$。
8. 上述复函数，可以在由$\omega$，实轴，虚轴构成的三维空间中绘制出一条空间曲线。
9. $x(t)=e^{-|a|t},a>0$，傅里叶变换$X(j\omega)=2a/(a^2+\omega^2)$。可知，$X(j\omega)$为实信号。如下：
10. <img src="信号与系统.assets/image-20210417105242597.png" alt="image-20210417105242597"  />
11. 单位冲激信号$\delta(t)$的频谱$X(j\omega)=1$，利用$\delta(t)$的性质可得。这表明$\delta(t)$中包含的所有频率的幅度，相位都是相同的，因此LTI系统的单位冲激响应$h(t)$才能够完全描述一个LTI系统的特性。
12. 矩形脉冲（方波）信号$X(t)=
       \begin{array}{ll}
       1,\quad|t|<T_1\\
       0,\quad|t|>T_1\\
       \end{array}$。频响为：$X(j\omega)=2T_1\sin\omega T_1/\omega T_1=2T_1\text{Sa}(\omega T_1)$。$\omega=0$是该频响函数的一个间断点，不过极限存在，补充定义$X(0)=2T_1$即可。
13. 对应的周期为$T_0$的矩形脉冲信号的频谱为$X(jk\omega_0)/T_0$。
14. 不同脉冲宽度对频谱的影响，可以看出来，脉冲时间$T_1$越长，频谱反而越集中，当$T_1\to+\infty$时，$X(j\omega)\to2\pi\delta(t)$。可以发现，对于时域突变明显的信号，在频域中旁瓣却延绵不断：
15. <img src="信号与系统.assets/image-20210420075216500.png" alt="image-20210420075216500" />
16. 阶跃函数的傅里叶变换对：$u(t)\to\frac{1}{j\omega}+\pi\delta(\omega)$。


## 信号的带宽

1. 一般情况下，信号的主要能量都是在低频分量（傅里叶系数较大），另一方面，信号传输中的系统都有自己的频率属性。在传输信号时，没必要将所有频率的分量都准确地传输，只要保证占据信号能量主要部分的频率分量有效传输即可。因此需要定义信号的带宽：
   1. 当$|X(j\omega)|$下降到最大值的$1/\sqrt{2}$时对应的频率范围，即认为是信号的带宽。此时信号的功率下降到最大功率的一半。
   2. 对于包络是$\text{Sa}(x)$形状的频谱，通常定义主瓣宽度为信号带宽。
2. 以矩形脉冲为例，脉宽$\times$带宽=$2T_1\times 2\pi/T_1=4\pi$​，为常数，称作脉宽带宽积。可以看到二者呈反比的关系。

## 周期信号的傅里叶变换

1. 到目前为止，周期信号用傅里叶级数表示，非周期信号用傅里叶变换表示。数学描述方法不一致。由于周期信号不是能量有限信号，因此不能直接从积分定义出发建立它的傅里叶变换。由于周期信号的傅里叶级数所得的频谱是离散的，因此也需要让它的傅里叶变换的频谱是离散的。

2. 考察$X(j\omega)=2\pi\delta(\omega-\omega_0)$，它所对应的信号为：$x(t)=e^{j\omega_0t}$。因此周期性复指数信号的频谱是一个移位的冲激函数。于是，当把周期信号表示为傅里叶级数时，根据傅里叶变换的线性性质：
   $$
   x(t)=\sum_{k=-\infty}^\infty a_ke^{jk\omega_0t} \stackrel{FT}{\longrightarrow} X(j\omega)=2\pi\sum_{k=-\infty}^\infty a_k\delta(\omega-k\omega_0)
   $$
   
3. 因此周期信号的傅里叶变换由一系列移位（间隔恒定为$\omega_0$）冲激串组合而成。每个冲激分别位于信号的各次谐波频率处，冲激强度正比于其傅里叶级数的系数，为$2\pi a_k$。

4. 周期信号的傅里叶变换不是通过积分定义上面的积分（在无穷区间上积分）求得的，而是先求傅里叶级数的系数（在一个周期内积分），在带入上式得到。

## 常见周期信号的傅里叶变换

1. 实际上正弦信号的傅里叶变换为复数情况，一般应该分别画出幅值和相位谱。$\pi/j=-j\pi$。
2. <img src="信号与系统.assets/image-20210420091334359.png" alt="image-20210420091334359"  />
3. <img src="信号与系统.assets/image-20210420091502817.png" alt="image-20210420091502817"  />
4. 时域中均匀冲激串信号的傅里叶变换也是均匀冲激串。前者的冲激强度为1，后者为$2\pi/T$。
5. <img src="信号与系统.assets/image-20210420091751473.png" alt="image-20210420091751473"  />
6. <img src="信号与系统.assets/image-20210420091818843.png" alt="image-20210420091818843"  />
7. 周期性矩形脉冲的傅里叶变换：
8. <img src="信号与系统.assets/image-20210421095606756.png" alt="image-20210421095606756" />

## 连续信号傅里叶变换的性质

1. 傅里叶变换可以看做一个算子，本质是一个积分运算。以下性质对周期信号和非周期信号的傅里叶变换都是适合的。
2. 线性：如果$x(t)\stackrel{FT}{\longrightarrow} X(j\omega),y(t)\stackrel{FT}{\longrightarrow} Y(j\omega)$，那么$ax(t)+by(t)\stackrel{FT}{\longrightarrow}aX(j\omega)+bY(j\omega)$。
3. 时移：如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，那么$x(t-t_0)\stackrel{FT}{\longrightarrow}X(j\omega)e^{-j\omega t_0}$。信号的时移会影响他的相频特性，增加一个线性相移（因为增加的指数是幅值为1，但是幅角为$-\omega t_0$​的复数）。因此处理信号时，起点的选择不影响幅频特性。
4. 频移性质：如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，则$x(t)e^{j\omega_0t}\stackrel{FT}{\longrightarrow}X(j(\omega-\omega_0))$。将右侧的$\omega$替换为$\omega-\omega_0$​即可。
5. 余弦函数具有平移性质，如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，则$x(t)\cos(\omega_0t)\stackrel{FT}{\longrightarrow}\frac{1}{2}[x(j(\omega-\omega_0))+X(j(\omega+\omega_0))]$。相当于频谱分别左右平移$\omega_0$，然后相加除以2。信号的调制会用到这个性质。
6. 共轭对称：如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，那么$\overline{x(t)}\stackrel{FT}{\longrightarrow}\overline{X(-j\omega)}$。
7. 如果$x(t)$是实信号，即$x(t)=\overline{x(t)}$，那么有$X(j\omega)=\overline{X(-j\omega)}$，可以得出频谱的实部是偶函数（这也是频谱一般都会按照$\omega=0$绘制两侧的原因），虚部是奇函数。幅度是偶函数，相位是奇函数。信号和频谱的奇偶性分别是关于$t$和$\omega$的。一个复数函数可以从实部/虚部或幅值/相位两个角度考察。
8. 如果$x(t)$是一个实偶信号，即$x(t)=\overline{x(t)},x(t)=x(-t)$。则$X(j\omega)=X(-j\omega)=\overline{X(j\omega)}$。即实偶信号的傅里叶变换为实偶函数。
9. 如果$x(t)$是一个实奇信号，则$X(j\omega)$​为虚奇函数。这里的虚函数指的是实部为0。
10. 信号与系统中，默认所有的信时域号都是实信号。
11. 时域微分：如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，则$dx(t)/dt\stackrel{FT}{\longrightarrow}j\omega X(j\omega)$​。时域的微分运算变为了频域的代数运算，纵轴缩放。
12. 频域微分：如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，则$tx(t)\stackrel{FT}{\longrightarrow}j\frac{dX(j\omega)}{d\omega}$。
13. 时域积分：如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，则$\int_{-\infty}^t x(\tau)d\tau\stackrel{FT}{\longrightarrow}X(j\omega)/j\omega+\pi X(j0)\delta(\omega)$。积分可以看作$x(t)*u(t)$，因此只需要将二者的频谱相乘即可。例如阶跃函数可以看做是冲激函数的积分，由$\delta(t)\stackrel{FT}{\longrightarrow} 1$，可得$u(t)\stackrel{FT}{\longrightarrow}1/j\omega+\pi\delta(\omega)$。
14. 时域尺度变换：如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，则$x(at)\stackrel{FT}{\longrightarrow}\frac{1}{|a|}X(j\frac{\omega}{a})$。表明如果信号在时域上扩展a倍，其带宽会相应地压缩a倍，或者说信号在时域胖，则频域瘦，可以通过1和$\delta(t)$的对应观察到。这也印证了信号的脉宽带宽积为常数的结论。
15. 对偶性：如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，则$X(t)\stackrel{FT}{\longrightarrow}2\pi x(-j\omega)$，其中$X(t)$是将$X(j\omega)$中的自变量$\omega$替换为$t$。例如$\delta(t)\stackrel{FT}{\longrightarrow}1$，则$1\stackrel{FT}{\longrightarrow}2\pi\delta(-\omega)=2\pi\delta(\omega)$，因为$\delta(\omega)$​是偶函数。
16. 时域和频域的对偶关系。同时当$T_1\to\infty$时，信号变为恒定信号，频域转变为冲激函数。
17. <img src="信号与系统.assets/image-20210420081619406.png" alt="image-20210420081619406" />

18. 卷积定理（时域卷积性质）：如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，$h(t)\stackrel{FT}{\longrightarrow}H(j\omega)$，则$x(t)*h(t)\stackrel{FT}{\longrightarrow}X(j\omega)H(j\omega)$。时域卷积等于频域乘法。

19. 如果将$x(t)$看作输入信号，$y(t)$看作输出信号，求$h(t)$的过程就是：先计算$H(j\omega)=\frac{Y(j\omega)}{X(j\omega)}$，然后求$H(j\omega)$的傅里叶逆变换，得到$h(t)$。控制论中将$H(j\omega)$称为LTI系统的传递函数或系统函数。
20. 根据卷积定理，微分器这个LTI的$H(j\omega)=j\omega$，积分器的$H(j\omega)=1/j\omega+\pi\delta(\omega)$，延时器的$H(j\omega)=e^{-j\omega t_0}$。
21. 可以使用卷积定理来计算卷积，先对信号的频谱进行乘法，然后再作傅里叶逆变换。
22. 可以使用傅里叶变换求解微分方程问题，例如LTI系统可以用某微分方程表示为$3y'(t)+y(t)=5x'(t)+2x(t)$。对方程两侧同时求傅里叶变换，可得$Y(j\omega)$和$X(j\omega)$的关系，然后根据已知的$x(t)$求得$X(j\omega)$，可以求得$Y(j\omega)$，最后通过傅里叶逆变换可得$y(t)$。
23. 调制性质，即卷积定理的逆形式：如果$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，$h(t)\stackrel{FT}{\longrightarrow}H(j\omega)$，则$x(t)h(t)\stackrel{FT}{\longrightarrow}\frac{1}{2\pi}X(j\omega)*H(j\omega)$。时域乘法等于频域卷积，再除以$2\pi$​​。
24. 周期信号的傅里叶级数的帕赛瓦尔定理：一个周期信号的平均功率就等于他所有谐波分量的平均功率的和。
    $$
    \frac{1}{T}\int_T|x(t)|^2\text{d}t=\sum_{k=-\infty}^\infty|a_k|^2
    $$
25. 傅里叶变换的帕塞瓦尔定理，若$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，则有如下公式。即时域的能量等于频域的能量，傅里叶变换能量守恒，相差一个$2\pi$。
    $$
    \int_{-\infty}^{+\infty}|x(t)|^2dt=\frac{1}{2\pi}\int_{-\infty}^{+\infty}|X(j\omega)|^2d\omega
    $$
26. 

## 调制与解调

1. 调制（Modulation）和解调（Demodulation）是现代通信系统使用的技术。系统会先将要传输的信号$x(t)$使用载波（carrier wave）$\cos(\omega_ct)$进行调制，得到$y(t)=x(t)\cos(\omega_ct)$。载波可以有很多种形式，这里的余弦只是其中一种。收音机的调频91.5MHz，是指$f_c=\omega_c/2\pi=91.5MHz$​。调制的目的就是将原始信号的频谱平移道高频区域，要求载波频率远大于原始信号的频谱范围。
2. 上面的这种方式称为双边带正弦载波幅度调制（DSB），之所称为幅度调制，是因为直接将载波乘以了原始信号的取值。注意频谱不仅是移位了，还缩小了一半。
3. <img src="信号与系统.assets/image-20250317165843379.png" alt="image-20250317165843379" style="zoom:67%;" />
4. 原始信号$x(t)$一般都是带限信号（或基带信号），因为他们的频谱都是有界的。电话声音的频带一般为$\pm4000Hz$，因此电话里的声音和真实声音会不同。可以通过低通滤波器（LPF）来将普通信号变成带限信号（Band Limit）。
5. 之所以不直接传输原始信号，是因为希望频分复用，可以使用不同的载波频率对不同的原始信号调制，然后相加，再进行传输，这样接收端就可以通过选择对应的频率来解调出不同的原始信号，这里利用了三角函数的正交性。除了频分复用外，调制还有个优点，就是调制后的高频信号不易受干扰，所需天线长度小。频分复用的示意图如下，可以看出，要使得调制后的信号在频域不发生混叠，必须要求不同的载波频率之间不能太小，任意两个载波之间频率之差的一半应该＞带限信号的频率：
6. <img src="信号与系统.assets/image-20250317170028750.png" alt="image-20250317170028750" style="zoom:67%;" />
7. 接收到调制后的信号$y(t)$后，解调步骤：计算$y(t)\cos(\omega_ct)$，然后再做傅里叶变换，最后乘以一个幅值为2的低通滤波器，然后逆变换回来即可得到原始的$x(t)$。可见必须要求$\omega_M<\omega_1<2\omega_c-\omega_M$。
8. <img src="信号与系统.assets/image-20250317174100155.png" alt="image-20250317174100155" style="zoom:67%;" />
9. 注意最终传输的信号都是时域的，频谱不会被传递出去。上边频域低通滤波的过程，一半不会进行傅里叶变换或逆变换，而是直接进行时域卷积。
10. 以上的调制与解调过程是可以通过模拟电路实现的，这属于高频电子电路的知识。其他的调制方法会在通信原理课程中介绍。
11. 除了调幅（AM），还有调频（FM）方式，后者的载波频率更高，提供更优的音质，但是传播距离较近。

## 滤波

1. 理想的低通滤波器的频谱如下：
   $$
   X(j\omega)=
   \begin{array}{ll}
   1,\quad|\omega|<\omega_c\\
   0,\quad|\omega|>\omega_c\\
   \end{array}
   $$
2. 它的逆变换为：$x(t)=\omega_c\text{Sa}(\omega_ct)/\pi=\sin(\omega_ct)/\pi t$，也就是该LTI的$h(t)$。可以看到频域规整的信号，时域反而旁瓣比较多。滤波可以在时域或频域进行，频域滤波（频谱相乘即可）更方便，不过还要进行傅里叶逆变换得到时域信号，时域滤波就是信号和$h(t)$​进行卷积。

3. 通常说的截止频率不是$\omega_c$，而是$f_c$，关系为$2\pi f_c=\omega_c$。

4. 理想的低通滤波器是可以包含延迟的，这样滤波后的信号相对于原始信号有延迟，因为实际元件的处理是需要时间的，微小的延迟是可以接受的。

5. 理想低通滤波器的缺点：

   1. 非因果（因为它在$t<0$时，不恒为0），因此无法做出实时处理的系统，因为计算任意$y(t_0)$，都要求所有的$x(t)$。卷积公式为$y(t)=\int_{-\infty}^{+\infty}x(\tau)h(t-\tau)d\tau$。只有当$\tau>t$时，$h(t-\tau)$恒为0时，才可以计算卷积积分，这就是因果系统的要求。虽然不能实时处理，但是可以做到先存储在处理，例如音视频后期处理。

   2. 年轮效应，会把陡峭的上升沿信号变成逐渐衰减的“年轮”传递至无穷远。对于图片来说，就是水波纹效果。

   3. ![image-20250320194749591](信号与系统.assets/image-20250320194749591.png)

6. 设计滤波器时的一个准则：在时域$h(t)$上，增加主瓣面积，减小旁瓣面积，这样可以较好地降低年轮效应。有些滤波器的参数就是主瓣面积占总面积的比例。

7. 收音机中的调谐功能就是一个带通滤波器，只留下对应的频率附近的信号。

8. 对于一维信号，低频分量代表缓慢变化，高频分量代表快速变化。对于二维图像，低频表示主体和背景，高频表示轮廓和边界。锐化和模糊操作就是分别加强频谱中的低频和高频分量。

9. Butterworth滤波器是一种低通滤波器，设计目的是通带内信号平坦，阻带内信号衰减迅速，也被称为最大平坦幅度滤波器。它可以使用LC电路搭建出来，因此是因果的。$H(j\omega )={\frac {1}{\sqrt {1+(\frac{\omega}{\omega_c})^{2n}}}}$。阶次n用来控制阻带内的衰减速度，n越大，频率的截止特性就越好。它的旁瓣面积非常小，因此年轮效应很小。

10. 滤波器一般是在频域进行设计，但是需要在时域内进行实现。之所以称上面是理想的，因为时域的信号是无限长的，需要截断。

11. 滤波器一般都会引入相位延迟（会导致信号的峰值或特征点发生时间偏移，从而影响数据分析的准确性），为了避免这种情况，可以通过双向滤波消除相位延迟。其核心思想是对信号进行两次滤波：

    1. 设原始信号为$x(t)$，滤波器为$h(t)$。
    2. 第一次滤波：$y_1(t)=x(t)∗h(t)$，其中∗表示卷积操作。产生了延迟
    3. 反转信号：$y_2(t)=y_1(−t)$。
    4. 第二次滤波：$y_3(t)=y_2(t)∗h(t)$。此次滤波没有改动频谱值，只是进行了反向位移。
    5. 恢复信号：$y(t)=y_3(−t)$。

12. 

# 离散时间的傅里叶变换

1. 常见的缩写：

   ```
   CFS  (Continuous-Time Fourier Series) 连续时间傅里叶级数
   DFS  (Discrete-Time Fourier Series) 离散时间傅里叶级数
   CTFT (Continuous-Time Fourier Transform) 连续时间傅里叶变换
   DTFT (Discrete-Time Fourier Transform)离散时间傅里叶变换 ，也简称为DFT
   ```

2. 对于离散时间周期矩形脉冲信号$\widetilde{x}[n]$，当$N\to\infty$时，$\omega_0\to0$谱线变密，最终形成连续谱。同时周期序列也变成了非周期的序列。可以预见，一个非周期的序列$x[n]$，频谱是连续的。

3. $a_k$也随着N的增大而减小，可以考虑$\lim\limits_{N\to\infty}\triangleq X(e^{j\omega})$。因为$a_k=\frac{1}{N}\sum\limits_{n=-N/2}^{N/2}\widetilde{x}[n]e^{-j\frac{2\pi}{N}kn}$。认为$\frac{2\pi}{N}k\to\omega$。可得：
   $$
   X(e^{j\omega})=\sum_{n=-\infty}^{\infty}x[n]e^{-j\omega n}
   $$

4. 将$X(e^{j\omega})$当做非周期离散时间信号$\widetilde{x}[n]$​的离散时间傅里叶变换DTFT。

5. $X(e^{j\omega})$的自变量为$\omega$，之所以写成$e^{j\omega}$是为了表明这个是离散时间序列的傅里叶变换，同时表明周期是$2\pi$。

6. 显然$X(e^{j\omega})$对于其自变量$\omega$来说，是以$2\pi$为周期的。即$X(e^{j\omega})=X(e^{j(\omega+2\pi)})$。这个要通过定义来证明，而不能通过$X()$内的公式变换证明，虽然后者也蕴含了这个特征。

7. 对于周期为N的离散时间信号$\widetilde{x}[n]$，$a_k=\frac{1}{N}X(e^{j\omega})|_{\omega=\frac{2\pi}{N}k}$，相当于在非周期离散时间信号的傅里叶变换上进行采样，采样间隔为$\frac{2\pi}{N}$。由此可以推出离散时间信号的傅里叶逆变换IDTFT：
   $$
   x[n]=\frac{1}{2\pi}\int_{2\pi}X(e^{j\omega})e^{j\omega}\text{d}\omega
   $$

8. 上式中被积函数是关于$\omega$的周期为$2\pi$的函数，一般在$[-\pi,\pi]$之间积分。离散时间序列可以分解为频率在$0\to2\pi$区间上分布，幅度为$\frac{1}{2\pi}X(e^{j\omega})\text{d}\omega$的复指数分量的线性组合，无穷多份。

## 常见的非周期序列的DFT

1. 衰减序列$x[n]=a^nu[n],|a|<1$，DTFT为：$X(e^{j\omega})=\frac{1}{1-ae^{-j\omega}}$，是一个复函数。幅频和相频曲线如下：
2. <img src="信号与系统.assets/image-20210422103654084.png" alt="image-20210422103654084"  />
3. 可以看到：
   1. 当$0<a<1$时，幅频曲线表现为低频特性，$x[n]$单调衰减。这里说的低频特性指的是可以近似将该曲线看做一个低通滤波器，在频率较低时的幅值比频率较高时的幅值大。
   2. 当$-1<a<0$时，幅频曲线表现为高频特性，$x[n]$摆动衰减。
4. 对称衰减序列$x[n]=a^{|n|},|a|<1$。$X(e^{j\omega})=\frac{1-a^2}{1+a^2-2a\cos\omega}$。频谱是一个实函数。
5. 实偶序列的DTFT是实偶函数。
6. 矩形脉冲序列：$x[n]=\begin{array}{ll}
   1,\quad|n|\le N_1\\
   0,\quad|n|>N_1\\
   \end{array}$。
7. ![image-20210422105456749](信号与系统.assets/image-20210422105456749.png)

## 离散时间傅里叶变换的性质

1. 扩展性质：若$x[n]\stackrel{FT}{\longrightarrow}X(e^{j\omega})$，则$x_{(k)}[n]$定义为：当$n$是$k$的倍数时，等于$x[n/k]$；当$n$不是$k$的倍数时，等于0。相当于在原来的序列中每相邻两个数之间插入$k-1$个0，以$x[0]$为中心，向两侧扩展。因此$x_{(k)}[n]\stackrel{FT}{\longrightarrow}X(e^{j\omega k})$。也就是将原来的自变量$\omega$变为$k\omega$，后者是以$2\pi/k$为周期的。信号在时域被拉伸然后填充0，因此在频域上就被压缩。
2. 时域卷积性质：若$x[n]\stackrel{FT}{\longrightarrow}X(e^{j\omega})$，$h[n]\stackrel{FT}{\longrightarrow}H(e^{j\omega})$，则$x[n]*h[n]\stackrel{FT}{\longrightarrow}X(e^{j\omega})H(e^{j\omega})$。时域卷积等于频域相乘。
3. 调制性质：若$x[n]\stackrel{FT}{\longrightarrow}X(e^{j\omega})$，$y[n]\stackrel{FT}{\longrightarrow}Y(e^{j\omega})$，则$x[n]y[n]\stackrel{FT}{\longrightarrow}\frac{1}{2\pi}X(e^{j\omega})\circledast Y(e^{j\omega})$。右侧为圆周卷积（或循环卷积），是指在一个$2\pi$周期上的卷积积分：$\frac{1}{2\pi}\int_{2\pi}X(e^{j\theta})\circledast Y(e^{j(\omega-\theta)})d\theta$。
4. $(-1)^n$可以将低通滤波器转化成高通滤波器，例如。$\sin(\omega_0 n)/\pi n$是截止频率为$\omega_0$的低通滤波器，$(-1)^n\sin(\omega_0 n)/\pi n$就变成了高通滤波器，因为它相当于频域的移位$\pi$。
5. 帕萨瓦尔定理：若$x[n]\stackrel{FT}{\longrightarrow}X(e^{j\omega})$，则$\sum_\limits{n=-\infty}^{+\infty}|x[n]|^2=\frac{1}{2\pi}\int_{2\pi}|X(e^{j\omega})|^2d\omega$。
6. 连续时间周期信号的傅里叶级数：连续到连续：$x(t)\to a_k$。
7. 连续时间非周期信号的傅里叶变换：连续到离散：$x(t)\to X(j\omega)$。
8. 离散时间周期序列的傅里叶级数：离散到离散的：$x[n]\to a_k$。也成为快速傅里叶变换。这个是最有用的，因为计算机只能处理离散信号，也只能输出离散结果。1960年有库利和图基提出的。
9. 离散时间非周期序列的傅里叶变换：离散到连续：$x[n]\to X(e^{j\omega})$。

## 离散序列的傅里叶级数

1. $a_k=\sum_\limits{n=0}^{N-1}x[n]e^{-j\frac{2\pi}{N}nk}$。其中$N$为序列$x[n]$的周期。同样可以用级数重构序列：$x[n]=\frac{1}{N}\sum_\limits{k=0}^{N-1}a_ke^{-j\frac{2\pi}{N}nk}$。
2. 因为离散时间非周期序列的傅里叶变换需要进行无穷求和，这对于计算机是无法完成的。因此假设$x[n]$只在$0,1,\cdots,N-1$有任意值，其余位置取值均恒为0，N为人为设定的值。此时无穷求和就变成了有限个非零项的求和了。此时$X(e^{j\omega})$是一个虚假的连续信号，因为只需要知道它在一个周期内的任意N个位置的值，就知道它在周期内的任意点的值。证明思路如下：
3. 经过上面的假设，$x[n]$已经变成一个非周期的序列了，因此可以对其计算离散时间非周期序列傅里叶变换：$X(e^{j\omega})=\sum_\limits{n=0}^{N-1}x[n]e^{-j\omega n}$。假设知道$X(e^{j\omega})$在一个频域周期$2\pi$内的N个点的值，即$(\omega_0,X(e^{j\omega_0})),\cdots,(\omega_{N-1},X(e^{j\omega_{N-1}}))$，其中$\omega_k\in[-\pi,\pi)$。这样可以得到一个关于$x[0],\cdots,x[N-1]$的N元一次方程组，系数行列式就是一个范德蒙行列式。因此只要这N个点不重合，就可以求解序列$x[n]$了，因而可以计算出$X(e^{j\omega})$在任意$\omega$位置的值了，因此认为$X(e^{j\omega})$是一个虚假的连续信号。
4. 一般的做法是对矩阵求逆，然后可以获得线性方程组的解$x[n]$，这个计算复杂度为$O(n^3)$，而库利图基算法可以将计算复杂度降低至$O(n^2)$，这是通过巧妙选择$\omega_k=2\pi k/N$（将$[0,2\pi]$均分为N份）得到的。此时$X(e^{j\omega_k})=a_k$，相当于是说$a_k$是$X(e^{j\omega})$在$[0,2\pi)$上的N次均匀采样。因此上面定义的离散序列的傅里叶级数就是快速傅里叶变换。
5. 由$x[n]$计算$a_k$或反过来进行，计算复杂度都是$O(n^2)$，因为要算N个量，每个量都需要N次运算。1965年库利和图基进一步提出算法，可以将该过程的计算复杂度降低至$O(n\log n)$。
6. 以一个8点的序列的傅里叶变换为例演示，首先展开8项的求和，然后奇偶分组，提取公因式。可以发现前4项为4点序列$x[0],x[2],x[4],x[6]$的傅里叶变换的公式，记为$B_k$，后4项为$x[1],x[3],x[5],x[7]$的傅里叶变换的公式，记为$C_k$。
7. ![image-20250321234053866](信号与系统.assets/image-20250321234053866.png)
8. 假设已经通过某些算法分别获得了$B_1,B_2,B_3,B_4$（下图的第2列的前4行）和$C_1,C_2,C_3,C_4$（下图的第2列的后4行），此时可以通过他们的组合求出$a_k$。例如$a_2=B_2+e^{-j*2\pi*2/8}C_2$。$a_4=B_0-e^{-j*2\pi*0/8}C_0$。$a_4$到$a_7$比较特殊，因为它们在$B_k$和$C_k$中没有对应的项，需要使用二者的周期性来解决，即$B_4=B_0$，$C_4=C_0$。$a_0$和$a_4$都是基于$B_0$和$C_0$的，不同的是$C_0$前的系数，一个是$e^{-j*2\pi*0/8}$，另一个是$e^{-j*2\pi*4/8}$。后者等于$e^{-j*2\pi*(4+0)/8}$，拆分为$-1*e^{-j*2\pi*0/8}$。因此$a_4$到$a_7$需要把$C_k$替换为$-C_k$。
9. ![image-20250321233756324](信号与系统.assets/image-20250321233756324.png)
10. 因此可以完全由2组4点的FFT计算结果组合得到8点FFT。仿照这个，也可以将4点的FFT拆分为2组2点的FFT结果的组合，见下图。这就是分而治之算法。
11. ![image-20250322002210980](信号与系统.assets/image-20250322002210980.png)
12. 而两点的FFT非常简单，$x[0],x[1]$序列的对应的傅里叶变换$a_0=x[0]+x[1]$，$a_1=x[0]-x[1]$。这个也称为蝶形运算。
13. 因为一共有$\log_2n$层，每层有$n$次运算，因此计算复杂度为$O(n\log n)$​。
14. 快速傅里叶逆变换（见下图）就有2点不同，一个是中间所有的系数的指数全部变为正数，另一个是最终结果是$Nx[n]$，还需要除以N才可以得到$x[n]$。
15. ![image-20250322104118585](信号与系统.assets/image-20250322104118585.png)
16. 这种方法特别适合使用递归来编写FFT程序，不过递归会造成栈消耗过大，且时间复杂度提高。
17. 这种分解的方法不仅适用于N为2的幂次的情况，任意自然数m的幂次都一样，此时不再分为2组，而是m组。进一步扩展当N可以分解为多个质数的乘积时，也可以拆分为蝴蝶图。
18. 如果N是质数时，可以使用插值来获得其FFT，相当于先超采样，然后再插值。
    1. 首先在序列末尾补零，至长度为2的幂次。
    2. 对补零后的序列计算FFT，获得$A_k$。
    3. 然后对$A_k$进行插值，获得原始序列的FFT的$a_k$。
19. 末尾补零来增加频域的分辨率，因为补零会增加N，这样会提高$\omega_k$​对$X(e^{j\omega})$​的采样频率。
20. 例如，N=17，补零至128个点，计算获得$A_k$，根据$a_1=2\pi/17\approx2\pi*7.5294/128$，因此$a_1=A_7*(8-7.5294)+A_8*(7.5294-7)$，一般使用线性插值即可，也可以使用复杂的插值方法。
21. 用$x[n_N]$表示N点序列，下标为n，定义循环移位序列：$x[{(n-2)}_N]$为$x[n_N]$循环右移2个单位，即$x[N-2],x[N-1],x[0],\cdots,x[N-3]$。可以认为是先将这个N点序列再$-\infty,+\infty$上进行周期延拓，然后移位，再在$[0,N-1]$上取值。例如$h[n_4]=[2,-1,0,1]$，则$h[(-n)_4]=[2,1,0,-1]$。可以先周期延拓，然后再翻转。$h[(1-n)_4]=h[-(n-1)_4]$，等于$h[-n]$右移一位，为$[-1,2,1,0]$。
22. 定义两个N点序列的圆卷积（循环卷积）：$x[n_N]\circledast y[n_N]=\sum_{m=0}^{N-1}x[m_N]h[(n-m)_N]$。长度不一致，无法定义循环卷积。
23. 定理：若$x[n]\stackrel{FFT}{\longrightarrow}a_k$，$h[n]\stackrel{FFT}{\longrightarrow}b_k$，则$x[n_N]\circledast y[n_N]=\sum_\limits{k=0}^{N-1} a_kb_k$。然后可以使用快速傅里叶逆变换得到卷积$y[n]$，因此使用FFT可以快速计算两个序列的卷积，此时计算复杂度从$O(n^2)$降低为$O(n\log n)$。
24. 可以用补零的方式来使用周期卷积计算线性（普通）卷积。例如：$x[n]=[1,2,3]$，$h[n]=[4,5,6]$，因为二者的普通卷积长度为$3+3-1=5$，因此需要补2个零。可以证明，二者计算的结果是相同的。如果两个序列长度不同，则分别补零到$N_1+N_2-1$长度。
25. 注意，matlab中的fft函数的结果是$[0,N-1]$​的频谱，也就是全是正频率，可以使用fftshift来对fft的结果进行半长度的循环移位。
26. FFT是计算DFT的快速算法，也就是对非周期离散序列进行处理，Matlab中的fft函数要求，序列的长度为2的幂次。
27. `Y = fft(X,n)`函数可以包含可选参数n，如果n比序列X的实际长度要长，则会在末尾补零，反之则截断。指定n为正整数标量可以提高fft的性能。n通常指定为2的幂或可以分解为小素数乘积的值（素数因子不大于 7）。
28. `fft` 的执行时间取决于变换的长度。只有较小素因数（不大于 7）的变换长度的执行时间明显快于素数或具有较大素因数的变换长度。
29. 可以使用fftw函数来潜在地提高fft的速度。此函数控制用于计算特定大小和维度的FFT的算法的优化。

# 采样定理

1. 采样定理：设$x(t)$是某一带限信号，截止频率为$\omega_M$，也就是频谱仅在$[-\omega_M,\omega_M]$间不为0。如果采样频率$\omega_s>2\omega_M$，那么$x(t)$就唯一地由其样本值序列$x[n]=x(nT)$所确定，其中n为任意整数，$T=2\pi/\omega_s$。
2. 由于计算机只能处理离散的数据，因此需要对连续信号进行采样sampling。
3. 人的感官是天然的低通滤波器，例如物体震荡频率快的时候，人就会看的模糊，相当于低通滤波了。车辆从启动到高速运动期间，车轮在人眼看来，一会正着转，一会反着转，这是因为人眼的采样频率是固定的，而轮子的转动频率逐渐提高。
4. 黑暗房间内有一个时钟，角速度为$\omega_M$，每秒钟用相机给它拍一张照片，按顺序播放图片的话，如果发现每秒顺时针转动$\pi/6$，则角速度可能的取值为$\pi/6+2k\pi$，正反转都可以。
5. 对一个余弦函数$\cos(\omega_Mt)$以$T=0.2$（$\omega_s=10\pi$）进行采样，得到如下图1的序列，据此可以求得多个可能的$\omega_M=4\pi+2k\pi/T=4\pi+10k\pi$。可以看出下图中的序列周期为1。
6. ![image-20250322143521446](信号与系统.assets/image-20250322143521446.png)
7. 采样过程相当于，先对连续时间信号$x(t)$乘以$\sum_\limits{n=-\infty}^{+\infty}\delta(t-nT)$，得到$x(t)$的冲激串采样函数$x_p(t)$，该函数在$t=nT$上取值为$x(nT)\delta(t-nT)$，其余位置取值均为0。然后再对$x_p(t)$进行以$T$为间隔的采样，得到$x[n]=x(nT)$​，称为$x(t)$的离散化采样。
8. 以下三个图，分别对应三个傅里叶变换：
   1. $x(t)\to X(j\omega)$。
   2. $x_p(t)\to X_p(j\omega)=\frac{1}{T}\sum\limits_{k=-\infty}^{+\infty}X(j(\omega-k\omega_s))$。就是原来的频谱进行$\omega_s$的移位再叠加（也称为谱搬移），同时纵坐标要除以$T=2\pi/\omega_s$。此时可以发现只有当$\omega_s-\omega_M>\omega_M$时，频域不发生混叠（也成为走样alias），这也是采样定理的要求。如果频域发生混叠，则无法区分混叠区域的各自比例。注意，这也是一个连续时间信号，只是在$nT$上为无穷大，其余位置为0。
   3. $x[n]\to X(e^{j\omega})=X_p(j\omega/T)=\frac{1}{T}\sum\limits_{k=-\infty}^{+\infty}X(j(\frac{\omega-2k\pi}{T})$。对第二步的频谱进行水平坐标乘以T，原有的周期为$\omega_s$，新的周期为$\omega_sT=2\pi$。
9. ![image-20250322150352706](信号与系统.assets/image-20250322150352706.png)
10. 把一个带限信号的截止频率的2倍称为它的奈奎斯特采样频率$2\omega_M$​。
11. 从上面可以发现时域采样等于频域搬移，反之时域周期延拓也等于频域采样。因为周期延拓就是时域卷积连续冲激串，根据卷积定理，就等于频域和连续冲激串相乘，就相当于采样了。
12. 如果非周期函数$x(t)\stackrel{FT}{\longrightarrow}X(j\omega)$，则将$x(t)$按照周期T进行延拓后的函数为$g(t)=\sum_\limits{n=-\infty}^{+\infty}x(t+nT)$。且周期信号$g(t)$的傅里叶级数为$G(j\omega)=\frac{1}{T}\sum_\limits{n=-\infty}^{+\infty}X(\frac{2n\pi}{T})\delta(t-\frac{2n\pi}{T})$。相当于在频域内按照$2\pi/T$的频率对进行采样，不过最终要除以$T$。此公式为泊松求和公式。
13. 带限内插公式：将满足采样定理得到的序列$x[n]$，恢复为连续时间信号$x(t)$。$x(t)=x_p(t)*T\frac{\sin(\omega_0t)}{\pi t}=\frac{T}{\pi}\sum_\limits{n=-\infty}^{+\infty}x[n]\frac{\sin(\omega_0(t-nT))}{t-nT}$。相当于对$x_p(t)$使用理想低通滤波器（截止频率可以为$\omega_s/2$，频谱高度为T，而非1）进行滤波，也称为低通内插公式。如果不限制$x(t)$的频谱范围，或者说采样时不满足采样定理的要求（例如将原来的频谱拆分称2个，然后分别左右移动任意个$\omega_s$距离），也可以得到无穷多个$x(t)$​，此时需要用到带通内插公式。
14. ![image-20250331164301860](信号与系统.assets/image-20250331164301860.png)
15. 采样频率必须要严格大于$2\omega_M$才可以恢复。例如对$\sin(\omega_0t)$进行采样，频率为$2\omega_M$，此时采样得到的序列为全零，这是因为此时将其频谱按照$2\omega_M$进行移位叠加时，会出现正负2个冲激抵消的情况。只有频谱中截止频率处的值为零时，才可以按照$2\omega_M$采样。
16. 某些特殊的带限信号，例如频谱只在$[-\omega_2,\omega_1]$和$[\omega_1,\omega_2]$之间取值不为0，其截止频率为$\omega_2$，如果采样频率<$2\omega_2$，并不一定会发生频域混叠。
17. 理想的采样是通过$\delta(t-nT)$进行的，而实际中无法构造出冲激函数，一般使用零阶保持采样。此时得到的就是$x_0(t)$，而非$x_p(t)$。$x_0(t)=x_p(t)*冲激近似函数$。这个冲激近似函数就是，在$[0,\tau]$内取值为1，其余取值为0。$X_0(j\omega)=X_p(j\omega)\cdot\tau Sa(\tau\omega/2)e^{-j\tau\omega/2}$。因此可以通过$x_0(j\omega)$求得$X_p(j\omega)$，然后低通滤波，逆变换即可得到$x(t)$。注意，这里就不大会像$x_p(t)$一样将$x_0(t)$变为离散序列了，因为无法细分。
18. ![image-20250322185449391](信号与系统.assets/image-20250322185449391.png)
19. 一阶保持：采样点之间用直线连接。$x_1(t)=x_p(t)*三角波$。
20. <img src="信号与系统.assets/image-20250322190945177.png" alt="image-20250322190945177" style="zoom:67%;" />

# 连续时间LTI系统的离散实现

1. 如果想要对连续信号进行处理，之前都是使用连续时间LTI系统来进行处理，即$y(t)=x(t)*h(t)$。而在数字信号处理中，需要用一下几步来实现：
   1. 对$x(t)$进行采样，得到$x[n]=x(nT)$。
   2. 对$x[n]$应用离散时间LTI系统$h_d[n]$，得到$y[n]=x[n]*h_d[n]$。
   3. 然后使用零阶保持，得到$y_0(t)$。还需要通过一个模拟的平滑低通滤波器，这是因为零阶保持会产生高频的矩形波。
   4. 最后通过上节的公式，得到$y(t)$。
2. 第1步和第3步都可以使用ADC芯片实现。主要问题就是$h(t)$和$h_d[n]$​的关系。
3. <img src="信号与系统.assets/image-20250322192635034.png" alt="image-20250322192635034" style="zoom:67%;" />
4. 定理：若上述2次ADC过程均满足采样定理，则$h_d[n]=T\cdot h(nT)$，也就是对$h(t)$采样，然后乘以T。当然这里也要求对$h(t)$的采样满足采样定理，因此采样频率要大于这3个信号的最大频率的2倍。
5. 希尔伯特变换：因果信号$x(t)$（$t>0$时，$x(t)=0$）的傅里叶变换的实部$R(j\omega)$和虚部$I(j\omega)$满足希尔伯特关系。$R(j\omega)=I(j\omega)*\frac{1}{\pi\omega}$，$I(j\omega)=-R(j\omega)*\frac{1}{\pi\omega}$。
6. 可以引入希尔伯特变换：$x(t)\stackrel{HT}{\longrightarrow} \hat{x}(t)=x(t)*\frac{1}{\pi t}=\frac{1}{\pi}\int_{-\infty}^{+\infty}\frac{x(\tau)}{t-\tau}d\tau$，和希尔伯特反变换：$\hat{x}(t)\stackrel{HT^{-1}}{\longrightarrow} x(t)=\hat{x}(t)*-\frac{1}{\pi t}$。
7. 因此可以将上述希尔伯特关系使用希尔伯特变换重写：$R(\omega)=H(I(\omega))$，$I(\omega)=-H(R(\omega))$​。
8. 根据卷积定理，可以发现希尔伯特变换相当于频域乘法$I(j\omega)\cdot j(2u(-\omega)-1)$。该滤波器的幅值恒为1，相位随频率变化。它为函数的每个频率分量赋予±90°的相移 ，正负取决于频率的符号。一个复数乘以$j$相当于逆时针转动90°。
9. ![image-20250322235452725](信号与系统.assets/image-20250322235452725.png)
10. 希尔伯特变换的性质：
    1. $x(t)$进行变换两次会得到$-x(t)$。
    2. $x(t)$与$\hat{x}(t)$正交。这里不要求$x(t)$为实信号。
11. $\cos(\omega_0t)\stackrel{HT}{\longrightarrow}\sin(\omega_0t)$，$\sin(\omega_0t)\stackrel{HT}{\longrightarrow}-\cos(\omega_0t)$。可以利用希尔伯特变换的卷积定义和卷积定理来证明，等号两侧的傅里叶变换相同。
12. 定理：一个实窄带信号$x(t)=a(t)\cos(\omega_0t+\theta(t))$，其中$a(t)$和$\theta(t)$的频带范围$\omega_M<<\omega_0$（即变化缓慢，相对于$\cos(\omega_0t)$可以看成常数），则$\hat{x}(t)\approx a(t)\sin(\omega_0t+\theta(t))$。同时可以得到：$|a(t)|=\sqrt{x(t)^2+\hat{x}(t)^2}$，$\phi(t)=\omega_0t+\theta(t)=\arctan(\frac{\hat{x}(t)}{x(t)})$，$\omega(t)=\frac{d\phi(t)}{dt}=\omega_0+\frac{d\theta(t)}{dt}$。三者分别称为$x(t)$的瞬时包络，顺势相位，瞬时角频率。
13. $|a(t)|$的形状大致为下图中粉色虚线的形状。
14. ![image-20250323102733203](信号与系统.assets/image-20250323102733203.png)

# 拉普拉斯变换

1. 目的是为了设计滤波器。滤波器设计的困难：连续→离散；无限长的$t$要变成有限才能处理；时域的因果性如何保证。
2. 有很多信号无法计算傅里叶变换，因此拉普拉斯提出对信号施加一个指数衰减，然后再求傅里叶变换：$L[x(t)]=F[x(t)\cdot e^{-\sigma t}]=\int_{-\infty}^{+\infty}x(t)e^{-\sigma t}e^{-j\omega t}dt=\int_{-\infty}^{+\infty}x(t)e^{-(\sigma+j\omega) t}dt$。设$s=\sigma+j\omega$为复平面上任意一点，则有拉普拉斯变换：$X(s)=L[x(t)]=\int_{-\infty}^{+\infty}x(t)e^{-st}dt$。
3. 同理可以定义拉普拉斯逆变换：$x(t)e^{-\sigma t}=F^{-1}[X(s)]$，移项可得$x(t)=\frac{1}{2\pi j}\int_{\sigma-j\infty}^{\sigma+j\infty}X(s)e^{st}ds$​​。
4. 这样对于任意信号都可以定义拉氏变换了。
5. 两个重要函数的拉普拉斯变换，这两个函数的拉氏变换一样，不过收敛域互补，也就是说对于同一个拉氏变换结果，$s$取不同值时，逆变换的函数不同：
   1. $e^{-at}u(t)\stackrel{LT}{\longrightarrow}\frac{1}{s+a}$，收敛域为$Re\{s\}>-a$。积分计算时会遇到$e^{-(s+a)\cdot +\infty}$，将s拆分为实部和虚部，可得$e^{-(\sigma+a)+\infty}\cdot e^{-j\omega\cdot +\infty}$。作为一个复数，第一部分为幅值，第二部分为相位，可以发现：
      1. 当$\sigma+a>0$时幅值为0，相位任意，此时复数收敛为0。
      2. 当$\sigma+a=0$时，幅值为1，相位任意，此时复数有界但不收敛。
      3. 当$\sigma+a<0$时，幅值为正无穷大，相位任意，此时复数不收敛。
   2. $-e^{-at}u(-t)\stackrel{LT}{\longrightarrow}\frac{1}{s+a}$，收敛域为$Re\{s\}<-a$。
6. 计算拉普拉斯变换，必须要考虑收敛域。
7. 傅里叶变换是拉氏变换在$s$为纯虚数条件下的特例。
8. 将使得拉普拉斯变换不收敛的点称为极点，例如上两式中的$s=-a$​，此时$X(s)$没有定义。
9. 下图左侧为$a>0$时，$x(t)$的图像。右下角图为该拉普拉斯变换的收敛域在复平面上的区域表示。
10. ![image-20250323122549101](信号与系统.assets/image-20250323122549101.png)
11. 拉普拉斯变换的性质：
    1. $X(s)$的收敛域是复平面上某一竖直线的左侧或右侧。条件是$x(t)$是连续的，且不包含$\delta(t)$等奇异信号。推论是，若$X(s)$在某个点收敛，则在通过该点的竖直线上都收敛。
    2. 时限信号（仅在某个有限区间内取值非零，也就是绝对可积）收敛域是整个复平面。
    3. 右边信号（在$(-\infty,A)$的某个区间上取值均为0，也就是右边无限延伸）的收敛域是复平面上其最右侧极点的右边区域。相当于对任意收敛点的右侧区域均收敛。例如$e^{-at}u(t)$的收敛域就是$(-a,0)$的右侧区域。因果信号是右边信号的特例。
    4. 左边信号（在$(A,+\infty)$​的某个区间上取值均为0，也就是左边无限延伸）的收敛域是复平面上其最左侧极点的左边区域。
    5. 双边信号（既不是左边也不是右边信号，但是可以在任意点拆分为1个左边信号和1个右边信号的和）收敛域是复平面的竖向带状区域（二者的交集）。例如$e^{-b|t|}$的收敛域为$(-b,0)$到$(b,0)$之间的带状区域。
    6. 收敛域的边界由极点限定或延伸至无穷远。
    7. 稳定信号（即绝对可积）的收敛域包含虚轴。
12. 常见信号的拉氏变换：
    1. $u(t)\stackrel{LT}{\longrightarrow}1/s$，收敛域为右半平面。
    2. $\delta(t)\stackrel{LT}{\longrightarrow}1$，收敛域为全平面。
    3. $\cos(\omega_0t)u(t)\stackrel{LT}{\longrightarrow}s/(s^2+\omega_0^2)$，收敛域为右半平面，极点为$(0,\omega_0j)$​。使用欧拉公式，然后拆分为两个信号。
    4. $\sin(\omega_0t)u(t)\stackrel{LT}{\longrightarrow}\omega_0/(s^2+\omega_0^2)$，收敛域为右半平面，极点为$(0,\omega_0j)$。
13. 拉氏变换的性质：
    1. 线性，收敛域至少为两个收敛域的交集，可能会更大。例如$u(t)-u(t)$的拉氏变换为0，在全平面收敛，而原来两个收敛域都是右半平面。
    2. 时域平移性质，若$x(t)\stackrel{LT}{\longrightarrow}X(s)$，且收敛域为$R$，则$x(t-t_0)\stackrel{LT}{\longrightarrow}e^{-st_0}X(s)$，收敛域还是$R$。当$s$为纯虚数时，就是傅里叶变换的时域平移性质。
    3. s域平移性质，若$x(t)\stackrel{LT}{\longrightarrow}X(s)$，且收敛域为$R$，则$e^{at}x(t)\stackrel{LT}{\longrightarrow}X(s-a)$，收敛域为$R+Re\{a\}$，水平方向平移。$a$可以是复数。因为若$X(s)$在某个点收敛，则在通过该点的竖直线上都收敛。因此收敛域一定是沿虚轴无限延伸的，因此$R+Re\{a\}$等价于$R+a$。只需要沿实轴平移即可。
    4. 尺度变换，若$x(t)\stackrel{LT}{\longrightarrow}X(s)$，且收敛域为$R$，则$x(at)\stackrel{LT}{\longrightarrow}X(s/a)/|a|$，收敛域为$aR$。
    5. 时域微分，若$x(t)\stackrel{LT}{\longrightarrow}X(s)$，且收敛域为$R$，则$dx(t)/dt\stackrel{LT}{\longrightarrow} sX(s)$，收敛域至少为R。例如$u(t)$和$\delta(t)$的关系，求导后的收敛域变成了全平面。
    6. s域微分，若$x(t)\stackrel{LT}{\longrightarrow}X(s)$，且收敛域为$R$，则$-tx(t)\stackrel{LT}{\longrightarrow}dX(s)/ds$，收敛域为R。
    7. 卷积性质，若$x_1(t)\stackrel{LT}{\longrightarrow}X_1(s)$，且收敛域为$R_1$，若$x_2(t)\stackrel{LT}{\longrightarrow}X_2(s)$，且收敛域为$R_2$，则$x_1(t)*x_2(t)\stackrel{LT}{\longrightarrow}X_1(s)X_2(s)$，收敛域至少为$R_1\cap R_2$​。
14. 因果信号的初值定理和终值定理：若因果信号$x(t)\stackrel{LT}{\longrightarrow}X(s)$，则$x(0)=\lim_\limits{s\to+\infty}sX(s)$，$x(+\infty)=\lim_\limits{s\to0^+}sX(s)$。第一个是初值，第二个是终值。两个定理是对称的。
15. 因果信号$x(t)=x(t)u(t)$，初值定理可以通过将$x(t)$在0处进行泰勒展开，成立的条件是$x(t)$在零处的任意阶导数必须为有限值。
16. 常微分方程的三种表示形式：
    1. 公式形式，例如$a_2y''(t)+a_1y'(t)+a_0y(t)=b_2x''(t)+b_1x'(t)+b_0x(t)$。
    2. 拉氏变换表示，$H(s)=Y(s)/X(s)=\frac{b_2s^2+b_1s+b_0}{a_2s^2+a_1s+a_0}$。对上述方程的两个同时应用拉氏变换即可，需要用到时域微分性质。这里将常微分方程看作一个LTI系统，$x(t)$为输入和$y(t)$为输出。$H(s)$也成为微分方程这个LTI系统的传递函数或系统函数。
    3. 系统框图表示。对上述微分方程引入中间变量$\omega(t)$，若$a_2\omega''(t)+a_1\omega'(t)+a_0\omega(t)=x(t)$成立。则$y=b_2\omega''(t)+b_1\omega'(t)+b_0\omega(t)$是微分方程的解。可以使用$\omega'(t),\omega(t),x(t)$来表示$\omega''(t)$​。
17. 整个微分方程的系统框图，可以分为左右两个部分，都是从$\omega''(t)$出发，可以分别得到$x(t)$和$y(t)$。一般约定，框图中的连线，系数为1可以不写，系数为0可以不画。时域的积分可以替换为s域的除以s的运算。
18. ![image-20250323202302470](信号与系统.assets/image-20250323202302470.png)
19. 绘制系统框图的目的就是为了方便电路的设计。同时框图中更喜欢使用积分器而非微分器，因为积分器可以很方便地使用电容来实现。
20. 还可以使用梅森公式来快去通过框图求得$H(s)$。
21. 可以使用拉氏变换求解常微分方程：给定$x(t)$和常微分方程，求$y(t)$。可以根据常微分方程求得$H(s)$，根据$x(t)$求得$X(s)$，可得$Y(s)$，最后使用拉普拉斯逆变换得到$y(t)$。
22. 定义单边拉氏变换为：$\widetilde{X(s)}=\int_{0}^{+\infty}x(t)e^{-st}dt$。可知因果信号的单边拉氏变换就是其拉氏变换。
23. 零输入（zero input）响应，零状态（zero state）响应。
24. ![image-20250323211122741](信号与系统.assets/image-20250323211122741.png)
25. 可以将一个微分方程问题拆分，全响应为零输入响应和零状态相应的叠加，以$t=0$分界。
26. <img src="信号与系统.assets/image-20250323211351466.png" alt="image-20250323211351466" style="zoom:67%;" />
27. 之所以这样拆分，是为了使用单边拉氏变换的性质。
28. 零输入=齐次通解=自由响应，零状态=非齐次特解=受迫响应。

# Z变换

1. Z变换可以看成离散形式的拉普拉斯变换。也可以看成扩展范围的傅里叶变换。离散的傅里叶变换是在单位圆上进行，而Z变换是在整个复平面上进行。
2. Z变换可以从理想信号（离散信号）的拉普拉斯变换中得到，也可以独立地对离散序列给出定义。
3. 从$h(t)$到$h[n]$需要先经过一个$\hat{h}(t)$，它称为理想信号。
4. 
5. 
6. 独立定义：针对离散序列定义：$X(z)=\sum_\limits{n=-\infty}^{+\infty}x[n]z^{-n}$，z是一个复数，可以表示为$z=re^{j\omega}$。相当于将$x[n]$乘以$r^{-n}$​，然后进行傅里叶变换。这个级数在复分析中称为洛朗级数，类似于在0处展开的泰勒级数。
7. 逆变换为$x[n]=\frac{1}{2\pi j}\int_{\omega\in2\pi}X(z)z^{n-1}dz=\frac{1}{2\pi j}\oint X(z)z^{n-1}dz$。围道积分，绕原点转$2\pi$的路径即可。
8. 对于$x[n]=a^nu[n]$序列，它的Z变换结果为$\frac{1}{1-a/z}$，收敛域为$|z|>|a|$，即一个圆的外部，a可以为复数。
9. 对于$x[n]=-a^nu[-n-1]$序列，它的Z变换结果为$\frac{1}{1-a/z}$，收敛域为$|z|<|a|$，即一个圆的内部，a可以为复数。
10. 若$x[n]$为上述两个序列的组合，例如$x[n]=a^nu[n]-b^nu[-n-1]$，其中$|a|<|b|$。则收敛域为$|a|<|z|<|b|$，也就是一个圆环范围。
11. 复变函数在收敛域内是解析的，或者说全纯函数，可以任意求导。
12. 

# 数字信号处理

1. 数字信号和离散时间信号不同，数字信号会在自变量和因变量2个层面都进行离散化，而离散时间信号只在自变量层面离散化。
2. 离散时间信号$x[n]=e^{j\frac{2n\pi}{N}}$是周期信号，周期为N。而$x[n]=e^{jn}$不是周期信号。它俩都是对连续事件信号$x(t)=e^{jt}$的采样，前者的间隔为$2\pi/N$，后者的间隔为1。将t替换成nT即可完成采样过程。
   1. 对于前者，令$x[n+M]=x[n]$，可推出$e^{j\frac{2M\pi}{N}}=1$，由于$e^{jx}$的周期为$2\pi$，因此只要$2M\pi/N=2k\pi$即可，$M=N\cdot k$，由于N是正整数，令$k=1$​此时M取最小正整数，就是N。也就是该序列是对$e^{jt}$在一个周期$2\pi$内采样$N$​次得到的。
   2. 若$x[n]=e^{j\cdot 4n\pi/5}$，仿照上面的步骤，推出$4M\pi/5=2k\pi$，即$M=5k/2$。当$k=2$是，M取最小整数5。也就是该序列是对$e^{jt}$在2个周期内采样5次得到的。
   3. 对于后者，同样令$x[n+M]=x[n]$，可推出$e^{jM}=1$。由于$e^{jx}$的周期为$2\pi$，因此只要$M=2k\pi$即可，由于无论k如何取值，始终无法令$2k\pi$​等于一个整数，因此该序列没有周期。

3. 有理数可以写成最简化形式：$p/q$，此时表示在$q$个周期内采样了$p$个点。则离散时间信号的周期为$p$。例如$e^{j\cdot 4n\pi/5}$，有理数为$5/2$​。
4. 离散LTI系统的特点，$y[n]=\sum_\limits{k=-\infty}^{+\infty}x[k]L(\delta[n-k])$。LTI系统具有分离特性，使得计算$x[n]$的响应$y[n]$时，并没有将LTI系统作用到$x[k]$上，而是将其作用到单位脉冲信号$\delta[n-k]$上，然后使用$x[k]$进行线性组合。除此之外，LTI的时不变性质，因此当$L(\delta[n])=h[n]$时，$L(\delta[n-k])=h[n-k]$。因此$y[n]=\sum_\limits{k=-\infty}^{+\infty}x[k]h[n-k]$。这种运算成为卷积：$y[n]=x[n]*h[n]$。
5. 离散LTI是因果的，等价于$h[n]=0$，当$n<0$时。这样卷积才可以忽略$k>n$的部分。
6. 离散LTI是稳定的，等价于$\sum_\limits{k=-\infty}^{+\infty}|h[k]|$，绝对值之和有界，类似于函数的绝对可积。
7. $x[n]=a^n$序列是任意LTI的不变输入，满足$L(x[n])=\alpha x[n]=(\sum_\limits{k=-\infty}^{+\infty}h[k]a^{-k})x[n]$。系数$\alpha$是一个只和LTI系统还有常数$a$有关的量。类似于无穷维的矩阵的特征向量关系。
8. 快速傅里叶变换提出，当$a=e^{j\omega}$时，可以将任意的$x[n]$在$a^n$下展开，且此时计算$\alpha$的速度比任意的$a$要快很多。
9. 有时也将$H(e^{j\omega})=\sum_\limits{k=-\infty}^{+\infty}h[k]e^{-j\omega k}$称为LTI系统的传递函数，可以看出它是以$2\pi$为周期的。
10. 对于窄带信号，例如载波调制后的信号，它的频谱仅在$[\omega_c-\omega_l,\omega_c+\omega_l]$上非零，窄带意味着$\omega_l<<\omega_c$。如果想要直接对该信号进行采样（这样可以尽量减少模拟元件的数量），则采样频率需要很高。实际做法是：先用一个较低的频率$\omega_s$采样，这样会造成频域的搬移，而由于信号是窄带的，因此搬移也不一定会造成混叠。只要满足$\omega_c-\omega_l>\omega_c-\omega_s+\omega_l$即可，即$\omega_s>2\omega_l$。这称为带通采样，而满足采样定理的采样称为低通采样。搬移到零点附近后，可以再低通滤波，然后获得原始信号的频率。
11. A/D芯片的基础是采样保持（Sampling and  Holding）电路，目前全球最顶尖的公司是Keysight（是德科技），最高频率为100GHz左右。该电路是由高速时钟驱动的。连续变化的信号经过采样保持之后，会得到接替变换的连续时间信号。
12. 1999年惠普公司电子测量集团经重组成为安捷伦（Agilent）科技有限公司，2014年再次分拆上市并取名是德科技，成为专注于电子测试测量的一家高科技跨国公司。
13. 如果信号不是带限的，而是近似带限的，即在高频部分的频谱值相比低频部分已经非常小了，或者说高频的能量占比很低，此时可以先通过一个模拟的低通滤波器（也成为抗混叠滤波器，截止频率一般为采样频率的一半）对信号进行滤波，然后再进行采样。
14. 而理想的低通模拟滤波器很难实现，数字滤波器相对简单，直接乘法就可以了。例如butterworth滤波器可以通过LC元件搭建出来，截止频率外的频谱还是不能完全忽略。
15. 此时可以通过过采样（over sampling）来避免这种问题。首先对原始的模拟信号应用模拟的非理想低通滤波器，得到近似带限信号，然后再进行过采样（采样频率不止是有效频率的2倍），此时会频谱会进行搬移，由于是近似带限信号，因此在有效频率范围内的混叠并不大，然后再应用数字的低通滤波器（可以做到理想的，因为这是数字的）即可。最后还需要应用降采样，得到低频的数字信号来处理，降低复杂度。过采样的倍数和模拟低通滤波器的理想程度有关。
16. ![image-20250324190129152](信号与系统.assets/image-20250324190129152.png)
17. 实际上不进行模拟的抗混叠滤波也行，不过此时就要求进行更高倍率的过采样了，也要求原始信号是近似带限的信号。
18. 工程领域，采样频率一般要超过5倍的信号最高频率。
19. 如果采样频率不够高，或者低通滤波器不够理想，会导致发生混叠，此时会将高频的噪声混叠到低频的有效信号上，降低信噪比（SNR），这也是数字信号或采样的问题。
20. A/D不仅是采样，还会进行量化，也就是用有限精度来表示实数值，量化完成后还要进行编码，才能存储到计算机中。量化也会引入误差，一般将其当作随机过程来分析，因为每个采样点都会有一个随机变量，认为它们都服从均匀分布$U[-\Delta/2,\Delta/2]$，且不同采样点的随机变量不相关，也就是白噪声随机过程。均匀分布的随机变量的期望为0，方差为$var=\Delta^2/12$。
21. 假设一个A/D的量化精度为B位，同时量程归一化，则最小精度$\Delta$为$2^{-B}$，方差转化成分贝为$10\log var\approx 6.02B-10.8$。位数相差1，量化噪声相差6分贝。
22. 线性卷积需要翻转，移动，相乘求和，在两侧的时候，会存在有些位置的数字没有对应的情况，而圆周卷积不存在这个问题，因为它是对周期信号进行的，任意位置时都不存在没有对应的情况。
23. 直接计算线性卷积的复杂度为$O(n^2)$，可以先将二者进行FFT变换到频域，然后相乘，最后再进行FFT逆变换回去。不过离散时间信号的卷积定理是时域原卷积等于频域乘法。因此需要根据如下线性卷积和圆周卷积的关系：$x[n]\circledast h[n]=\sum_\limits{k=-\infty}^{+\infty}h[n]*x[n-kT]$，其中$T$是周期。
24. 圆周卷积等价于信号做周期延拓，然后再进行线性卷积。可以将$x[n],h[n]$​末尾补零，使得长度超过二者长度之和-1。
25. 白噪声的核心特征是：
    1. 均值恒定（通常为零）：$E[x(t)]=0$。
    2. 自相关函数为狄拉克δ函数：$R_{xx}(τ)=σ^2δ(τ)$，即在任意两个不同时刻的取值不相关。
    3. 功率谱密度平坦：在所有频率上具有相同的功率（类似于白光包含所有颜色）。
26. 高斯过程是指任意有限维度的联合分布都是多元高斯分布的随机过程。这意味着：
    1. 任意时间点上的取值服从高斯分布。
    2. 任意多个时间点的联合分布也是高斯的。
27. 白噪声不一定是高斯分布，白噪声的瞬时幅度的概率分布可以是任意的（如均匀分布、泊松分布等）。若白噪声的任意时刻取值服从高斯分布，且不同时刻独立，则它是高斯白噪声。
28. 信号的均方值：$E(x^2(t))=\lim_\limits{T\to +\infty} \frac{1}{T}\int_0^Tx^2(t)dt$，其平方根为有效值RMS，是信号能量的一种表示。对于周期信号，选择一个周期内计算即可，对平方和求平均数，然后再开根号就是RMS。
29. 数字信号处理中，测量周期一半会在中性点，而非峰值点，因为峰值点的变化比较平缓，误差大。周期，相位可以通过“过零点检测法”来获得。
30. ![image-20250325211727560](信号与系统.assets/image-20250325211727560.png)


# 使用FFT进行频谱分析

1. 频谱分析比时域分析抗干扰能力强，低功率的噪声引入在频谱中可以滤波取出。

2. 周期信号的频谱图有如下几种，横坐标都是频率，纵坐标都可以从其傅里叶级数的系数中获得：

3. ![image-20250325231632553](信号与系统.assets/image-20250325231632553.png)

4. 周期信号频谱的特点：
   1. 离散性，每条谱线代表一个频率分量。
   2. 谐波性，谱线出现在基波频率$f_0$的整数倍上。
   3. 收敛性，谐波次数越高，分量越小。

5. fft的例子：

   ```matlab
   clear;
   close all;
   
   Fs=8*1024; %采样频率，一般为2的幂次，这里是8kHz
   dt=1/Fs; %采样间隔
   T=1; %总时长
   t=0:dt:T-1/Fs;%不包括末尾点
   N=length(t); %采样点数
   x = 10*sin(2*pi*100*t);%+10/3*sin(2*pi*300*t)+10/9*sin(2*pi*600*t); %最高频率为300Hz，满足采样定理
   plot(t,x);
   y=fft(x,2.^nextpow2(N)); %y的量纲为x的量纲一样。
   
   A1=abs(y);Q1=angle(y);
   figure;
   subplot(2,1,1);plot(A1); %幅值
   subplot(2,1,2);plot(Q1); %相位
   
   %以上绘制的图的横坐标都不是频率，而是结果数组下标，[1,Fs]。
   %y1=fftshift(y); %频率搬移
   A1=abs(y)/(N/2); %幅值缩放，归一化。
   Q1=angle(y)*180/pi; %相位转化为角度
   f=linspace(0,Fs/2,2.^nextpow2(N)/2); %单位Hz
   figure;
   subplot(2,1,1);plot(f,A1(1:2.^nextpow2(N)/2));
   subplot(2,1,2);plot(f,Q1(1:2.^nextpow2(N)/2));
   ```

6. 使用FFT计算得到的频谱需要注意以下问题：

   1. 需要再通过`fftshift(y)`将零频分量搬移到频谱中心。该函数本质就是一个循环移位操作。
   2. 需要将曲线的横坐标进行缩放，还原为频率。
   3. 将曲线的纵坐标缩放，还原量纲。

7. 可以对幅值谱的纵坐标平方，得到功率谱，如果平方后的不同频率处的峰值差异过大，可以使用对数功率谱，也成为分贝谱。

   ```matlab
   %功率谱和对数功率谱
   A2=A1.^2; %幅值缩放
   P2=10*log10(A2); %单位为分贝。
   figure;
   subplot(2,1,1);plot(f,A2(1:2.^nextpow2(N)/2));
   subplot(2,1,2);plot(f,P2(1:2.^nextpow2(N)/2));
   ```

8. 下图是方波信号的功率谱和对数功率谱，可以发现功率谱中高阶次谐波的频谱值就很小了，难以分辨，而在对数功率谱中，可以清晰分辨。

9. ![image-20250326134729832](信号与系统.assets/image-20250326134729832.png)


## 能量泄露

1. 用计算机处理信号，除了采样造成的离散误差外，还存在一个问题，就是无法对无限长的信号进行测量和运算，只能取有限长的一部分进行分析，这称为截断。为了便于数学上的处理，对截断信号进行周期延拓，可得到虚拟的无限长的周期信号，无论原来的信号是否是周期信号。

2. 即使原来是周期信号，由于不一定截断为完整周期，因此周期延拓后的信号，接头处信号可能跳变。这在频域上表现为能量泄露，将无限高的冲激分散在附近多个频率上。因为周期信号的频谱都是离散的脉冲。

3. ![image-20250326163205756](信号与系统.assets/image-20250326163205756.png)

4. 信号截断相当于在时域用一个矩形窗函数和原始信号相乘，因此在频域就是二者的频谱卷积。

5. ![image-20250326163554616](信号与系统.assets/image-20250326163554616.png)

6. 工程可以通过将周期信号进行整周期截断，来避免能量泄露，不过很难达到。由于截断的存在，无论信号本身是周期或者非周期的，采样后都会变成以截断窗口为周期的周期信号。


## 栅栏效应

1. 如果信号的频率分量位置不是正好处在频率采样点上，会出现栅栏效应，如下图所示，之所以称之为栅栏，是因为这就像透过一个栅栏来观察频率，只有在有缝隙的地方可以观察到。例如周期信号是一个100Hz信号，而FFT得到的频谱的横坐标也是离散的（都是$f_0$的整数倍），不一定正好在100Hz处取值。频率间隔为$f_0=Fs/N=1/T$，采样频率除以数据点数，T为采样时间长度，这个可以在频率归一化的公式中看出来。可以通过增加采样时间长度。栅栏效应会导致观察的频谱值比实际值要小，最多小36%。不过实际的频率间隔并非是$1/T$​​，因为如果N不是2的幂次的话，还需要补零，应该为`Fs/2.^nextpow2(N)`。

   ```matlab
   f=linspace(0,Fs/2,2.^nextpow2(N)/2+1); %单位Hz
   f(end)=[]; %删除数组最后一个元素
   ```

2. ![image-20250326204021836](信号与系统.assets/image-20250326204021836.png)

3. 谱峰越尖锐，造成的栅栏效应就越明显，产生的误差可能就越大。例如对于没有截断的正弦信号，它的频谱只在离散点上取值，且为无穷大，如果该频率不是$f_0$的整数倍，则结果为0。

4. 由于截断的存在，频谱会发生能量泄露，取值不是单点的无穷大值，而变成了分布的有限值，也间接地降低了栅栏效应。


## 窗函数

1. 可以使用特定的窗函数，来控制截断造成的能量泄露的形式。能量泄露分为主瓣泄露和旁瓣泄露，主瓣泄露可以减少因为栅栏效应带来的谱峰值估计误差，有好的一面，而旁瓣泄露。矩形窗函数的能量泄露情况如左下图，主瓣窄而尖，会造成的栅栏效应误差较大；旁瓣较高，也不好。理想的窗函数的能量泄露应该是右下图，只在主瓣内有能量泄露，旁瓣没有，且主瓣的宽度正好等于两条谱线的间距$f_0$，不过这样的理想窗函数是不存在的。

2. ![image-20250326210503673](信号与系统.assets/image-20250326210503673.png)

3. 信号加窗截断就是用窗函数与截断的信号相乘，从时域角度看，可以减少周期延拓时，接头处的跳变（这要求窗函数在两侧趋近于0，例如下图的汉宁窗）；从频域角度看，可以抑制旁瓣的能量泄露。主瓣横向增宽，旁瓣纵向压缩。

4. ![image-20250326211601633](信号与系统.assets/image-20250326211601633.png)

5. 常用的窗函数：由于窗函数会对信号的幅值进行修改，因此信号的能量会变化，因此FFT之后的结果应该乘以窗函数对应的幅值修正系数。

6. ![image-20250326211738930](信号与系统.assets/image-20250326211738930.png)

7. matlab中有现成的函数可以生成窗，第一个参数必选为窗长度，第二个为窗采样flag，默认为symmetric，也可以是periodic，此选项对于频谱分析很有用，因为它使加窗信号可具有离散傅里叶变换中固有的完美周期延拓。当指定`periodic`时，窗函数 计算长度为L+1的窗，并返回前L个点。

   ```matlab
   rectwin %矩形窗
   hann    %汉宁窗
   hamming %海明窗
   Blackman %布拉克曼窗
   flattopwin %平顶窗，主瓣最宽，因此对于栅栏效应的修正最好。具有极低的通带波纹 (< 0.01 dB)，主要用于标定目的。其带宽大约是汉宁窗的 2.5 倍。
   ```

8. 加窗的主要作用是减弱因无穷级数截断而产生的吉布斯现象的影响。

9. 使用窗函数：

   ```matlab
   clear;
   close all;
   
   Fs=8*1024; %采样频率，一般为2的幂次，这里是8kHz
   dt=1/Fs; %采样间隔
   T=1.1; %总时长
   t=0:dt:T-1/Fs;%不包括末尾点
   N=length(t); %采样点数
   x = 10*sin(2*pi*100*t)+10/3*sin(2*pi*300*t)+10/9*sin(2*pi*600*t); %最高频率为300Hz，满足采样定理
   % plot(t,x);
   w=hann(N,"periodic")';
   y=fft(2*x.*w,2.^nextpow2(N)); %y的量纲为x的量纲一样。
   
   A1=abs(y)/(N/2); %幅值缩放，归一化。
   Q1=angle(y)*180/pi; %相位转化为角度
   f=linspace(0,Fs/2,2.^nextpow2(N)/2+1); %单位Hz
   f(end)=[]; %删除数组最后一个元素
   figure;
   subplot(2,1,1);plot(f,A1(1:2.^nextpow2(N)/2));
   subplot(2,1,2);plot(f,Q1(1:2.^nextpow2(N)/2));
   ```

10. 当周期信号的频率正好和谱线重叠时，没有栅栏效应，此时加任何窗的效果都是一样的。当谱线不重叠时，不同的窗造成的栅栏效应有差异。除了矩形窗外，改变频率使得谱线不重叠，可以发现频谱峰值变化不大。

11. 同一个音符在不同乐器上听起来不同，是因为他们的泛音结构不同，也就是都是同样的倍频，但是权重不同。

12. 只使用正弦或余弦函数来做傅里叶级数展开时，级数求和的相位总是为0或$\pi/2$（谈论相位，需要有一个基准，默认认为正弦函数的相位为0）。然而实信号的相位不总是零，因此需要将正弦和余弦级数组合起来。$a\sin(\omega t)+b\cos(\omega t)=c\sin(\omega t-\phi)$。调整a和b的比值，即可调整相位$\phi$。所有的正弦都通过$(0,0)$，所有的余弦在$x=0$时，切线都水平。

13. 可以通过末尾补零的方式提高频谱的分辨率，例如1014→2048。

14. 可以使用ZOOM-FFT技术来细致观察某个频率附近的频谱。

15. 对于受到噪声干扰的频谱，可以使用谱平均技术把多次的频谱累加平均，降低噪声的影响。

16. 传感器采集的信号都是实信号，FFT默认是对复信号进行处理，因此可以使用实信号FFT计算技术来使得计算速度提高一倍。

17. 频谱分析可以寻找出共振频率，然后让机器的工作频率避开该频率区域。例如对于旋转机械，可以逐步改变机器的转速，可以找到共振频率，然后让机器的工作转速避开该临界转速。


# 信号的时差域分析

1. 信号的相关分析（cross correlation）是用来分析两个信号之间的相似程度或一个信号自身的时间依赖关系的方法，分别成为自相关和互相关。公式为：
   $$
   \rho_{xy}(t)=\frac{\int_{-\infty}^\infty x(\tau)y(\tau-t)d\tau}{[\int_{-\infty}^\infty x^2(t)dt\int_{-\infty}^\infty y^2(t)dt]^{1/2}}
   $$

2. 分子并非两个信号的卷积，而是将信号$y(\tau)$平移$t$后，再和$x(\tau)$做乘积积分。分母为两个信号的能量的乘积再开根号，除以分母是为了做归一化。相关函数在$t$时刻的取值表示了这两个信号延时$t$的可能性，$\rho_{xy}$取值范围为$[-1,1]$，$t$的取值范围为实数。

3. 例如距离同一个声源不同距离的两个麦克风，由于声音传播的延迟，采集到的信号会存在时移的相似性，相关函数存在一个峰值，这个峰值对应的$t$​就是两个麦克风的距离除以音速所得的时间。

4. 音乐厅的空间会产生回声，听众会听到原始声音和延迟后的回声，叠加起来有混响的效果。这可以通过原始信号+衰减且延迟一定周期后的原始信号来完成，$y[n]=x[n]+\alpha x[n-R]+\alpha^2 x[n-2R]+\cdots$，$0<\alpha<1$，可以多次延时叠加，产生多重回声。

5. 探测飞机的雷达可以通过计算发射出去的脉冲和接收到的反射信号的相关性，来计算信号的延迟，这个比直接比较发射信号和反射信号的峰值差要靠谱。因为反射信号的形状可能因为反射面的形状或材料性质而改变较大。也可以通过相关分析来分析得到反射面的材料或形状。回声测距相当于简化版的雷达。

6. 匹配滤波会使用到相关分析的技术。

7. 统计学上使用相关系数来描述两个随机变量之间的相关性，它是二者乘积的数学期望。
   $$
   \rho_{xy}=\frac{c_{xy}}{\sigma_x\sigma_y}=\frac{E[(x-\mu_x)(y-\mu_y)]}{\{E[(x-\mu_x)^2]E[(y-\mu_y)^2]\}^{1/2}}
   $$

8. 将随机变量变为信号，也就是随机过程，当信号为平稳（均值为0）随机过程时，公式就变成了上面的。不同的是，随机变量很少计算自相关，因为结果恒为1，而信号则不同。

9. 如果只是关心相似程度，而不是具体的相关系数的值，可以不进行归一化，此时公式为$\rho_{xy}(t)=\int_{-\infty}^\infty x(\tau)y(\tau+t)d\tau$。

10. 在matlab中使用`xcoor`函数计算离散信号的自（互）相关函数，如果对一个1024点的信号求自相关，结果为2048点，零时移的结果在中间，左右分别为负和正时移。

11. 相关函数的性质：

    1. 自相关函数是偶函数。

    2. 当$t=0$时，自相关函数取值最大，因为此时信号完全重合。

    3. 周期信号的自相关函数仍然是周期的，不过失去了原有的相位信息。也就是说改变信号的相位，不影响自相关函数的取值。

    4. 随机噪声信号的自相关函数随$t$增大，快速衰减。因为它在不同时刻的取值是独立的。可以利用这个特性来进行相关滤波。

    5. 两同频率的周期信号的互相关函数仍是同频率的周期信号，且保留了相位信息。即改变二者的相位差，会改变互相关函数的取值。

    6. 两个非同频率的周期信号不相关。这是因为三角函数的正交性。

12. 利用线性卷积来定义实序列的相关性：$\rho_{xy}[n]=x[n]*y[-n]$，$\rho_{yx}[n]=x[-n]*y[n]$，$\rho_{xx}[n]=x[n]*x[-n]$。由于卷积会先进行翻折，因此就会出现$x[n]\cdot y[n+k]$这样的项。

13. 离散信号的相关性计算公式：$\rho_{xy}(k)=\sum_\limits{n,k=0}^{N-1}x[n]y[n+k]$​。这是一个双重循环，因此在数字信号处理中通常使用FFT将其分别变换到频域，然后计算卷积，最后再逆变换回来即可。matlab中的xcoor函数就是这个思路。

14. ![image-20250328232217448](信号与系统.assets/image-20250328232217448.png)

15. 注意这里时域是移位相乘，频域需要对$Y[n]$做共轭。

16. 由于FFT计算中会引入周期延拓，因此使用它进行相关函数计算会产生重叠失真。

17. ![image-20250329105535387](信号与系统.assets/image-20250329105535387.png)

18. 因此可以使用改进的周期延拓来计算FFT，也就是在$x[n]$后面补零。但是由于后面有大量的零存在，因此相关系数会衰减。

19. ![image-20250329001827001](信号与系统.assets/image-20250329001827001.png)

20. 因此需要在`xcoor`函数中设置第二个参数为`"unbiased"`无偏，就可以避免衰减。下面中间图就是衰减的，最下方图是无偏的。

21. ![image-20250329110020405](信号与系统.assets/image-20250329110020405.png)

22. 超声波探伤也利用了相关分析的技术，这是内部缺陷回波会比底面回波提前反射。

23. ![image-20250329110321473](信号与系统.assets/image-20250329110321473.png)

24. 地下管道破损点的查找：每个一段距离安置一个检修井，在相邻两个检修井中分别放置测量传感器，检测从破损点发出的固体中的声波，如果破损点正好在中心，则两侧同时到达。可以通过相关性分析确定具体位置。

25. 如果对周期信号的采集中混入了随机噪声，可以通过计算自相关函数来滤除噪声，获得真实的频率和幅值。直接计算出来就是滤波后的了。

26. ![image-20250329111014321](信号与系统.assets/image-20250329111014321.png)


# 信号的幅值域分析

1. 信号的幅值域分析又称为信号的概率密度曲线和概率分布曲线分析。

2. 随机振动下结构的寿命预估需要通过对振动幅值信号进行幅值域分析，获得不同幅值的概率密度曲线，然后估计寿命。不同的振动幅值会造成不同的损伤程度。

3. 对概率密度函数（PDF）进行积分就得到概率分布函数（CDF），又称为累积概率，即信号取值小于某个特定值的概率。

4. 照片的分析中也会用到直方图，也成为灰阶图，分别统计不同亮度的像素块的数量。除了灰度图，也有RGB三色的分别的图。均匀分布是最好的，如果集中在暗部，表示曝光不足，集中在亮部，表示曝光过度。如果集中在中间，表示对比度不足。

5. 概率密度函数要满足如下三个条件：
   1. $p(x)>0$

   2. $\int_{-\infty}^{+\infty}p(x)dx=1$

   3. $P(a<x<b)=\int_a^bp(x)dx$

6. 获取信号的概率密度函数在$x$点的取值的方法：在纵轴上的$x$点附近做一个小区间$[x,x+\Delta x]$。用这个区间去水平截取信号，可能获得多段区间，其信号取值落在$[x,x+\Delta x]$，将这多段区间的长度加起来，除以信号的总长度$T$，然后令$\Delta x\to 0$，即可得到$p(x)$的值，令$x$遍历$X_{min}$到$X_{max}$即可求得$P(x)$的所有取值。
7. ![image-20250329201743391](信号与系统.assets/image-20250329201743391.png)

8. 直方图和概率密度函数类似，只不过是直方图没有进行归一化。

9. matlab中没有专门计算pdf的函数，可以通过直方图除以信号长度来获得：`pdf=hist(y)/length(y)`。matlab中有专门计算概率分布的函数`cdf(y)`。

10. 均匀分布的概率密度函数，对应的概率分布函数为一条斜直线。

11. 一个像素的RGB数据可以使用如下公式来计算其等效的灰度值：$gray=0.299*R+0.587*G+0.114*B$。matlab中可以使用`rgb2gray`函数来转换。

12. 灰度图像可以计算直方图，也可以对其进行直方图均衡的操作，这样可以调整曝光和对比度到合适的位置。如果对彩色图像的RGB三个通道分别进行直方图均衡，不过这样可能会改变图片的色彩。


# 信号的数字滤波

1. 滤波器是一种选频装置，能够使信号中特定频率的成分通过，而衰减其他频率的成分。

2. 下图是钢棒缺陷检测设备，由于设备需要套在钢棒外侧，因此二者之间有间隙，而设备滑动时，间隙会变大或变小，影响测得的回波信号，此时需要将低频的滤掉才能得到下方的图。

3. ![image-20250329215137040](信号与系统.assets/image-20250329215137040.png)

4. 血氧饱和度测量：随着心脏的跳动，指尖的毛细血管内的血液会流动，测量设备夹住指尖，一侧是一个发光二极管，另一侧是一个光强度接收装置，结果中容易耦合进交流电或空气中无线电信号的的干扰，需要滤波后才可以使用。

5. 滤波的前提是信号和噪音的频带不重叠。

6. 音响的均衡器就可以对不同的频段施加不同的增益或衰减。

7. 倍频程是指（octave band）又称为倍频带，是将整个频谱范围划分为若干频带的方法，每个频带的上限频率是下限频率的两倍。类似地，1/3倍频程，指每个频带的上限频率与下限频率之比是2的立方根。

8. 复杂的模拟滤波器会使用到很多元器件，而数字滤波器的成本和复杂程度无关。模拟滤波器在A/D之前，数字滤波器在A/D之后。

9. RC模拟滤波器：电容通交流，隔直流。

10. ![image-20250329220449192](信号与系统.assets/image-20250329220449192.png)

11. 模拟信号中一般都包含高频的噪声，如果不进行模拟滤波就采样，为了满足采样定理，就需要较高的采样频率。因此可以先通过一个模拟滤波器，滤掉高频噪声后，再通过低频的采样即可。

12. 如果干扰是低频的大幅值信号，则可以先进行模拟滤波，滤波后信号的实际幅值较小，可以先通过模拟放大器，然后再进行A/D量化，可以提高A/D的有效位数。

13. ![image-20250329220805973](信号与系统.assets/image-20250329220805973.png)


# 滤波器

1. 实际（非理想）滤波器的参数：截止频率是指衰减幅度为最高值的0.707倍时的频率，此时功率衰减一半，也就是衰减3dB，也成为半功率点。在截止频率（频率通带）内，$A_0$的波动称为纹波幅度$d$。带宽$B=f_{c2}-f_{c1}$。品质因数$Q=通带中心频率W_0/带宽B$，越大表示分离信号中相邻频率成分能力（频率选择性）就越强。倍频程选择性是指与上、下截止频率处相比，频率变化一倍频程时幅频特性的衰减量，用来描述带宽外的衰减程度，$W$越大，说明选择性越好。

2. ![image-20250329221334421](信号与系统.assets/image-20250329221334421.png)

3. 滤波器的评价指标：从频域看，过渡区（截止频率附近）应该是陡峭的。从时域看，脉冲响应应该是紧支集，也就是说取值不为零的点应该尽可能地少，这样计算起来效率较高。而这两者通常是矛盾的。

4. 使函数取值不为零的点的集合的闭包为该函数的支集。若支集为紧的，则称f(x)有紧支集。不严格地说，函数有紧支集是指该函数取值不为零的点在有界区域中(或局部的)。


## 频域滤波器

1. 一个实信号经过FFT之后，得到的结果为复数列，如下图所示，两侧是低频，中间是高频，关于该序列中间对称（这是因为原信号是实信号）。滤波时都会将所有的复数部分变为0。

2. ![image-20250330094220528](信号与系统.assets/image-20250330094220528.png)

3. 对于长数据信号，不建议直接完整信号进行滤波，仅为其借用了FFT变换，后者计算可能耗时很长，例如一个mp3音乐，每秒44.1k个点，3分钟时长共有7.9M个点，直接对这么长的信号进行FFT，可能会很久。有时需要实时处理，也无法在获得完整的信号后再处理。

4. 此时可以对信号分段处理，每次截取2的幂次长度来处理。为了避免滤波器暂态过程（头尾会失真）的影响，采用帧数据重叠技术，对重叠部分进行掐头去尾处理，将滤波数据头部和尾部的64点（信号片段为1024点时）或128点（信号片段为2048点时）舍去。这个类似于短时傅里叶变换。

5. ![image-20250330095447629](信号与系统.assets/image-20250330095447629.png)

6. 实际滤波器和理想滤波器的区别是，前者在通带和阻带之间还有过渡带。


## 时域滤波器

1. 有时滤波器的时域表达比较简单，例如为紧支集（长度为m点），此时可以进行时域滤波，也就是时域卷积运算。$y[k]=h[0]x[k]+h[1]x[k+1]+\cdots+h[m]x[k+m]$，$k$取值为0到N-1。

2. Z变换就是通过频域响应$H[f]$得到时域响应$h[k]$或$H[z]$所需的方法，将在频域定义的滤波器转化为时域的。

3. ![image-20250330101126757](信号与系统.assets/image-20250330101126757.png)

4. 对于离散序列，z变换中的z算子的作用就是简单的数据移位运算。若$H[z]=z^{-1}$，则$y[n]=x[n-1]$。若$H[z]=z^2$，则$y[n]=x[n+2]$。

5. 拉普拉斯变换和Z变换的关系，也就是S平面中的一个点和Z平面中的点的映射关系：$z=e^{sT}$。

6. ![image-20250330101802462](信号与系统.assets/image-20250330101802462.png)

7. 时域滤波的关键就是得到Z变换形式的滤波器，例如：
   1. 数字差分就是简单的高通滤波器。$y[n]=(x[n+1]-x[n-1])/2\Delta t$。这个滤波器的$H(z)=(z^1-z^{-1})/2\Delta t$。

   2. 数据平滑（移动平均）就是简单的低通滤波器。$y[n]=\frac{1}{M}\sum_\limits{i=0}^{M-1} x[n+i]$。

   3. 高斯平滑滤波器是移动平均的特例，它会参考左右的点，同时各点的权重取值为高斯函数。matlab中可以使用`gausswin`函数获得系数序列，中心点的权重始终为1。

   4. $2m+1$点中值滤波器，$y[n]=Mid(x[k])$，其中$n-m\le k\le n+m$。中值滤波器可以滤除掉高频脉冲噪声。
   
8. 时域数字滤波就是将信号与滤波器的单位脉冲响应（z域滤波器系数，如下图）进行卷积，寻找所需的滤波器单位脉冲响应的过程就是滤波器的设计。

9. ![image-20250330115317061](信号与系统.assets/image-20250330115317061.png)

10. 上面这种滤波器由于使用到了$x[k-1]$这样的序列，因此在起始点需要特殊处理，对于$y[0],y[1],y[2]$这三个值的计算中引用到的$x[-3],x[-2],x[-1]$​都认为是0即可。
11. 从上面可以看出，滤波器的系数越多，头尾部的暂态响应就越长。


# FIR滤波器

1. FIR（Finite Impulse Response）又称为有限脉冲响应滤波器，是时域滤波器的一种。传递函数为$H(z)=\sum_\limits{k=0}^{N}a_kz^{-k}$。脉冲响应函数为$h[k]=a_k$，k取值0到N。由于$h[k]$是一个有限长度的序列，因此称之为FIR。输入为脉冲，输出响应为有限长度的。

2. matlab中可以使用`fir2(N,f,m)`来进行基于频域采样的FIR滤波器设计，从而获得FIR滤波器的$a_k$，其中N+1为输出相应的长度，也就是$a_k$的长度。$f$为归一化频率（实际频率除以采样频率）序列，$m$为对应频率处的频谱值。

   ```matlab
   f=[0 0.2 0.25 1];
   m=[1 1 0.2 0];
   ak=fir2(20,f,m); %ak长度为21。
   [h,w]=freqz(ak,1,128);
   subplot(2,1,1); plot(f,m,w/pi,abs(h));
   subplot(2,1,2); impz(ak,1);
   ```

3. ![image-20250330120916971](信号与系统.assets/image-20250330120916971.png)

6. fir1只能设置截止频率，也就是原始的4种滤波器。fir2允许用户自定义频谱，以出现平滑过渡，不仅如此，fir2还可以定义复杂的频率通带，例如有多个不连续通带的滤波器，例如音乐播放器的数字均衡器。

5. firls函数使用最小二乘来设计滤波器，设计出的滤波器特性曲线在之顶点的误差平方和最小，这里就不用窗函数了。

   

# IIR滤波器

1. IIR就是无限脉冲响应滤波器。传递函数为：$H(z)=\sum_\limits{k=0}^{N}b_kz^{-k}/(1+\sum_\limits{k=0}^{N}a_kz^{-k})$。IIR为递归型结构，即带有反馈环路。展开后为无穷序列求和：$H(z)=\sum_\limits{k=0}^{+\infty}c_kz^{-k}$。因此其脉冲响应$h[k]$是一个长度无限的序列，因此将其称为IIR滤波器。

2. 在相同系数长度和计算量情况下，IIR滤波器的幅频滤波特性会更好，但是存在相频失真。可以将FIR滤波器做成对称或反对称，相位失真可以为零。

3. IIR滤波器的设计方法和FIR不同，一般是先借助模拟滤波器进行设计，然后再将模拟滤波器转化为数字滤波器。常用的模拟滤波器有巴特沃斯，切比雪夫I和II型，椭圆滤波器。转换方法有：双线性变换法和冲击响应不变法。

4. 设计IIR滤波器时，也会用到窗函数，不过这次是在频域，因此窗函数不总是用在时域上。

5. matlab中可以直接调用butter来创建巴特沃斯滤波器。

   ```matlab
   [b,a]=butter(8,0.1,"low"); %8阶，归一化截止频率为0.1，低通。
   x2=filter(b,a,x1); %对x1信号应用滤波器，结果为x2。
   ```


# 其他滤波器

1. 陷波（notch）滤波器：可以将某个频率点的频谱快速衰减，以达到阻止该频率信号通过的目的，属于带阻滤波器的一种，只不过其阻带非常窄。例如血氧仪测得的信号需要滤除工频交流电的噪声。matlab中可以使用irrnotch函数来生成这样的滤波器。

2. ![image-20250330154217183](信号与系统.assets/image-20250330154217183.png)

3. 尖峰滤波器，正好和陷波滤波器相反，只允许某一特定频率的信号通过。matlab中可以使用irrpeak函数生成该滤波器。

4. 梳状滤波器，分为两类，陷波和尖峰。具有多个不连续的阻带或通带。一般来说工程上的工频干扰，除了50Hz本身外，其各种倍频也会掺入其中，梳状滤波器可以对多个倍频进行滤波。matlab中可以使用irrcomb函数生成该滤波器。

5. ![image-20250330154757247](信号与系统.assets/image-20250330154757247.png)

6. 半带滤波器，通带和阻带对称，二者的误差相同，关于中心频率镜像对称。上方为理想，下方为实际的。同一个信号分别经过半带高通和半带低通后，再相加就可以还原信号（不过头部相比会有延迟，这是因为滤波器的系数长度造成的暂态效应）。小波分析中会用到这个。matlab中使用firhalfband来生成该滤波器。

7. ![image-20250330155214888](信号与系统.assets/image-20250330155214888.png)

8. 希尔伯特全通滤波器90°相移滤波器，幅值不变，相位变化90°，可以用于包络信号的检波处理。对于幅值调制的信号，其包络往往比载波包含更多的信息。matlab中使用envelope函数设计该滤波器。效果会将正弦信号变为余弦信号。实信号的希尔伯特变换就是将其与$1/\pi t$做卷积。

9. ![image-20250330155957251](信号与系统.assets/image-20250330155957251.png)

10. 常见的调制解调方法如下。其中调相是非线性变换，比较复杂。

11. ![image-20250330160512466](信号与系统.assets/image-20250330160512466.png)


# 信号的时频分析

1. 之前的分析方法一共有4种：时域分析，频域分析（通过FFT），幅值分析（概率密度函数），相关分析。

2. 时频分析就是将时域分析和频域分析叠加起来。

3. 仅靠频域分析无法区分下面的分段函数和$x(t)=\cos(2\pi*10t)+\cos(2\pi*25t)+\cos(2\pi*50t)+\cos(2\pi*100t)$这两个信号，因为二者的频谱是一样的，都有4个峰值。两个信号不同的是，分段函数在不同时间段只有一个频率成分，而求和的信号在任意时间段都是4种频率成分的叠加。

4. ![image-20250330210103073](信号与系统.assets/image-20250330210103073.png)

5. 频谱分析无法处理频谱随时间变化的信号。

6. 对于频率逐渐变化的信号，例如扫频波信号，改变变化的方向，不会影响二者的频谱。

7. 时域的波形分析只能对简单信号进行处理，不能处理多个频率叠加的信号。

8. 频域的频谱分析只能用于稳态信号，不能用于时变信号分析，也不能用于跳变信号分析。只能提供全局频率信息，不能提供某一时刻的频率信息。


## 短时傅里叶分析

1. 短时傅里叶分析（Short-time Fourier Transform）是一种用于确定时变信号局部区域（时间区间）频率特征的方法。思想是：选择一个较短的窗函数对信号予以截断，计算该窗口内的信号的频率特征。然后在采样窗口上移动（前后两次可以重叠一部分）该窗函数，从而得到不同时刻的频率信息。通常将变化的频谱绘制为时间函数，称为谱阵或瀑布图。横纵坐标分别表示时间和频率，颜色深浅表示频谱强度，也可以绘制成三维图。

2. ![img](信号与系统.assets/Spectrogram-19thC.png)

3. ![image-20250330211950407](信号与系统.assets/image-20250330211950407.png)

4. 它是由1971年的诺贝尔奖物理学奖（因为发明了全息摄影）得主Dennis Gabor提出的。Gabor 变换以Dennis Gabor的名字命名，是短时傅里叶变换的一个特例。

5. 傅里叶变换的公式为：$X(f)=\int_{-\infty}^{+\infty}x(t)e^{-j2\pi ft}dt$。短时傅里叶变换的公式为$STFT(\tau,f)=\int_{-\infty}^{+\infty}[x(t)\cdot W(t-\tau)]e^{-j2\pi ft}dt$，其中$\tau$为时移参数，$f$为频率参数，$W$为滑移窗函数。STFT离散公式：$STFT[n,f]=\sum_{m=-\infty}^{+\infty}x[m-n]\cdot w[m]\cdot e^{-j2\pi fm}$​。

6. 因为STFT使用FFT来计算频谱，因此窗口长度需要为2的幂次。

7. matlab中可以使用`spectrogram`函数来生成谱阵。

   ```matlab
   Z=spectrogram(x,1024,512); %窗口宽度为1024点，相邻两个窗口重叠长度为512点。
   P=20*log10(sqrt(Z.*cong(Z)));
   X=linspace(0,Fs/2,513);
   Y=linspace(0,dt*N,63);
   mesh(X,Y,P'); %绘制三维图
   view(15,70);  %观察点选择
   ```

8. 时频测不准原则：STFT结果的时间分辨率取决于窗的宽度$N$，频率分辨率取决于$FS/N$。提高时间分辨率就会降低频率分辨率，反之亦然。存在如下约束关系：$\Delta t\cdot \Delta f\ge\frac{1}{4\pi}$。

9. matlab中可以使用chirp函数生成扫频信号。

10. 音乐播放器的频谱图就是截取一段进行频谱显示，利用的就是STFT的技术。


## 小波分析

1. 小波（wavelet）就是一个能量有限的信号，在频域上它是带通的，在时域上它是震荡衰减的，因为它是一个有限波的形式，所以称之为小波。正弦波可以称之为大波，因为它无限延伸。
2. 要求满足：$\int \phi(t)dt=0$，$\int|\phi(t)|^2dt=1$。
3. ![image-20250330224844643](信号与系统.assets/image-20250330224844643.png)
4. STFT的不足：因为采用固定长度的窗口，在时频分析中，时域和频域的分辨率都是固定的。对于低频信号来说，窗口可能太小，未覆盖足够长的信号段；对高频信号来说，窗口可能太大，不能及时反映频率随时间的变化，如下图所示。
5. ![image-20250330225158798](信号与系统.assets/image-20250330225158798.png)
6. 小波分析是为了改善STFT的不足而发明的。使用可随信号频率变化的可变长度窗口。低频段采用较宽的窗口，高频段采用较小的窗口。
7. ![image-20250330225507825](信号与系统.assets/image-20250330225507825.png)
8. 1910年，就出现了Harr小波基函数，而直到1980年代才由Morlet提出小波的概念。1989年Mallat提出了快速小波变换，类似于FFT在傅里叶变换中的地位。
