# 基础

1. 变量的分类，数字常量默认都是double类型，即使看上去是个整数，例如`A=10`。可以使用`class(obj)`或`whos obj`来获取变量的类型。

2. ![image-20220502210213475](Matlab基础.assets/image-20220502210213475.png)

3. 逻辑类型的变量只有2个取值，true或false，数值表示分别为1和0。

4. 可以保存工作区，以便后续使用，格式可以是.mat（二进制数据）或.m（命令格式的文本）。

   ```matlab
   %也可以使用save指令来完成该操作
   save xx.mat  %默认为二进制格式
   save xx.mat --ascii  %保存为文本格式，此时就无法再导入进matlab了，因为文本中只有值，而没有数据的结构了。
   load('xx.mat')  %从.mat文件导入变量到工作空间，相当于在matlab中右键→加载。而在matlab中右键→导入可以选择导入一部分变量。
   ```

5. 可以使用xlsread和xlswrite来读写excel文件。可以使用writematrix将矩阵写入到csv格式的文件。可以使用导入工具来将外部数据导入到matlab中，可以将该导入动作保存为函数，脚本等，方便后续调用。默认导入为表格，可以变为数值矩阵。

6. matlab界面左侧是当前目录，其中亮色的目录是指该目录包含在软件的path中。右键可以将一个目录或其所有子目录都包含到path中。

7. log是自然对数函数，log10是以10为底，log2是以2为底。

8. matlab是弱类型的语言，使用变量前不需要声明类型。变量名区分大小写，变量名不能以数字开头。

9. 特殊的变量和常量：

   1. ans：answer的缩写，如果计算结果没有显式指定给某个变量的话，默认会存储到这里。
   2. i，j：虚数单位。
   3. inf或Inf：无穷大，例如`x=1/0`，`inf*-1`结果为`-inf`。可以使用`isinf`判断。
   4. eps：2.2204e-16，一般用来作为浮点数相等的界限。
   5. NaN或nan：not a number，例如`x=inf/inf`，`inf-inf`，值不确定。可以使用`isnan`判断。
   6. pi：圆周率的精确值。如果要输入$\pi$，则可以使用`\pi`。例如`xlabel('xx \pi')`。

10. 名称的优先级从高到低分别为：变量，内置函数，子函数，私有函数（MEX文件，P文件，M文件）。

11. 输入iskeyword命令来查看所有的关键字，变量名要避开这些关键字。matlab的函数调用和数字索引都是使用`()`。使用clear x将变量x从工作空间删除，不加变量名会清空整个工作空间。

    ```matlab
    >> cos(8)
    ans = -0.1455
    cos = 'This string'  %会覆盖内置的cos函数。
    >> cos(8)    %表示获取字符串的第8个字符,下标从1开始。
    ans = r
    >> clear cos  %清理用户定义的名字，恢复系统默认的
    >> cos(8)
    ans = -0.1455
    ```

12. 数据类型转换，并不会改变原来变量的类型：

    ```matlab
    double()  %转化为double类型
    single()  %单精度，也就是float
    int8()
    int16()
    int32()
    int64()
    uint8()
    uint16()
    uint32()
    uint64()
    ```

13. matlab有两种字符串类型，一个是由char拼成的字符数组（用单引号包裹起来），一个是字符串string类型（用双引号包裹起来）。前者可以像数组一样进行自由拼接，后者不可以，因此推荐使用前者。

    ```matlab
    >> a = 'a';  %1x1的char类型，一共2个字节。
    >> str1 = 'abc'; %1x3的char类型，一共6个字节。
    >> str2 = "bcd";  %1x1的string类型，150个字节，这并不是表示每个字符占用50个字节，而是默认申请150个字节的长度。
    >> whos
      Name      Size            Bytes  Class     Attributes
      a         1x1                 2  char                
      str1      1x3                 6  char                
      str2      1x1               150  string
    %转化为数字
    >> uint8("def");  #会报错，无法从string转换为uint8或16。
    >> uint8('abc');  #结果为1x3的uint8类型，[97 98 99]。
    %字符数组拼接
    >> ['as' 'de'] %水平拼接，结果为1x4的char类型，'asde'。
    >> "as"+"de" %水平拼接，结果为1x1的string类型，"asde"。
    >> ["as" "de"]  %矩阵形式的水平拼接,结果为1x2的string类型，即字符串构成的矩阵。此时ans(1)为"as"，ans(2)为"de"。
    >> ['asf';'dem']  %竖向拼接，结果为的2x3char类型。要进行竖向拼接的2个数组的维度必须一致，否则会报错。
    >> ["as";"de"]  %竖向拼接,结果为2x1的string类型，字符串矩阵。
    %字符数组索引
    >> x="abcd";x(2);  %不可以将string字符串当作字符向量来看到，用索引来取元素，会报错。
    >> y='abcd';y(2);  %结果为'b'。
    %字符数组比较
    >> 'a' == 'abada';  %相当于用'a'和字符串的每个字符去比较，结果为逻辑数组[1 0 1 0 1]。
    >> x='abada';x(x == 'a') = 't';  %会将x中的'a'替换为't'
    >> "ab" == "abada"; %会报错，提示数组的大小不兼容。
    >> strcmp("ab","bc");  %结果为false，比较两个字符串是否完全相等。
    ```

14. 字符串和字符数组相互转化：

    ```matlab
    >> char("abc")   %结果为'abc'
    >> string('ab')  %结果为"ab"
    ```

15. 字符串和数字的转换函数：

    ```matlab
    >> num2str(1.5)    %将数字转换为字符数组，结果为'1.5'
    >> str2num("2.5")  %将字符数组转换为数字，结果为2.500000000000000
    ```

16. 结构体struct类型。

    ```matlab
    %student是一个1x1的struct，也就是结构体数组，包含3个字段。
    student.name = 'john joe';
    student.id = 2;
    student.grade = [80,68,90];
    >> student
    student = 
      包含以下字段的 struct:
         name: 'john joe'
           id: 2
        grade: [80 68 90]
    %向结构体数组中添加结构体
    student(2).name = "zj"; %没有提供的字段会为默认值
    ```

17. 也可以使用struct函数来创建结构体：

    ```matlab
    >> a = struct('f1','a','f2',[]) %键值对形式
    a = 
      包含以下字段的 struct:
        f1: 'a'
        f2: []
    ```

18. 结构体可以嵌套存在：

    ```matlab
    student.name = 'zj';
    student.grade = struct('math',80,'englist',75);
    ```

19. 结构体字段相关的函数：

    ```matlab
    cell2struct %将cell数组转化为struct数组
    struct2cell %将struct数组转化为cell数组
    fieldnames  %获取结构体的字段名
    getfield(S,field) %返回结构体S的指定字段中的值。如果S.a=1，则getfield(S,'a')返回1。
    isfield(S,field)  %如果field是结构体S的一个字段的名称，则返回1。否则将返回0。
    isstruct(A) %如果A为结构体，则返回逻辑值1，否则返回逻辑值0。
    orderfields(S) %按名称对S中的字段排序，然后输出。
    rmfield(s,field) %从结构体数组s中删除指定的一个或多个字段。
    setfield(S,field,value) %为结构体S的指定字段赋值。setfield(S,'a',1)相当于S.a = 1。
    structfun(func,S) %将函数func应用于标量结构体S的每个字段，每次一个字段。然后将func的输出串联成列向量。
    ```

20. cell array（元胞数组），类似于矩阵，但是每个元素的类型可以不同，定义时它的元素都要使用`{ }`包括起来，或者将索引用`{ }`包括起来，此时等号右侧就不用`{ }`包括了，推荐使用后者。matlab内部是存储每个元素的指针，因此cell可以看作是指针数组。

    ```matlab
    >> A(1,1) = {[1 2 3]};
    >> A(1,2) = {3+5i};
    A =
      1×2 cell 数组
        {[1 2 3]}    {[3.000000000000000 + 5.000000000000000i]}
    >> A{2,1} = 'abc';
    A =
      2×2 cell 数组
        {[1 2 3]}    {[3.000000000000000 + 5.000000000000000i]}
        {'abc'  }    {0×0 double                              }
    ```

21. 获取元素时，也有两种方式，`( )`和`{ }`，前者结果是1x1的cell，后者结果就是cell内的数据类型，也推荐使用后者。

    ```matlab
    >> A(1,1)  %结果为1×1的cell数组，{[1 2 3]}。
    >> A{1,1}  %结果为1x3的double数组，[1 2 3]。
    ```

22. 创建元胞数组的其他方式：

    ```matlab
    >> C = {1 2 3;'text' rand(5,10,2) {11; 22; 33}}; %只是将数组的[]变成了{}
    C =
      2×3 cell 数组
        {[   1]}    {[          2]}    {[     3]}
        {'text'}    {5×10×2 double}    {3×1 cell}
    ```

23. 矩阵分块的方法：

    ```matlab
    A = magic(3); %A是一个3x3的矩阵
    C = mat2cell(A,[1 1 1],[1 2]); %行按照1 1 1分开，列按照1 2分开。
    C =
      3×2 cell 数组
        {[8]}    {[1 6]}
        {[3]}    {[5 7]}
        {[4]}    {[9 2]}
    ```

24. 高维数组：

    ```matlab
    >> A = rand(2,2,2); %三个维度分别为row,column,layer。
    >> A
    A(:,:,1) =  %第1层
       0.644318130193692   0.811580458282477
       0.378609382660268   0.532825588799455
    A(:,:,2) =  %第2层
       0.350727103576883   0.875942811492984
       0.939001561999887   0.550156342898422
    ```

25. 可以沿不同的维度对矩阵进行拼接（concatenation）：

    ```matlab
    A = [1 2;3 4];
    B = [5 6;7 8];
    vert = cat(1,A,B) %沿着第1维度进行拼接，相当于[A;B]
    horz = cat(2,A,B) %沿着第2维度进行拼接，相当于[A B]
    layr = cat(3,A,B) %没有以上简便的方法
    %结果
    vert =
         1     2
         3     4
         5     6
         7     8
    horz =
         1     2     5     6
         3     4     7     8
    layr(:,:,1) =
         1     2
         3     4
    layr(:,:,2) =
         5     6
         7     8
    ```

26. reshape可以在不改变数组数据的前提下，改变其结构形式：

    ```matlab
    A = [1 2;3 4];
    >> reshape(A,1,4) %结果为[1 3 2 4]，因为矩阵在内存中是按列存储的。
    ```

27. format指令控制数字的显示样式，不加任何参数就是默认的short，这可以在设置中设置。

    ```matlab
    >> pi
    ans = 3.1416
    >>  pi-3.1416
    ans = -7.3464e-06  %可以证明pi的实际值3.1416，只是显示为3.1416
    >> format long     %双精度浮点数
    >> pi
    ans = 3.141592653589793
    >> format shortE       %单精度科学计数法
    >> pi
    ans = 3.1416e+00
    >> format longE        %双精度科学计数法
    >> pi
    ans = 3.141592653589793e+00
    >> format hex          %16进制显示
    >> pi
    ans = 400921fb54442d18
    >> format rat          %将结果有理数显示
    >> pi
    ans = 355/113
    >> 3/13
    ans = 3/13
    ```

28. 语句最后如果没有分号，会将结果输出到界面上，不过并不会影响是否赋值给ans。

    ```matlab
    >> 3
    ans = 3
    >> 5;
    >> 3+5
    ans = 8
    >> 3+6;    %仍会将计算结果赋值给ans
    >> ans
    ans = 9
    ```

29. 常用命令：

    ```matlab
    clc  %清理屏幕的输出,快捷键为Ctrl+L
    clear %清理工作空间的所有变量
    who   %列出工作空间的所有变量
    whos  %列出工作空间的所有变量的详细信息
    %%%%%%%%%%%%%
    >> a=1.5
    a =
         1.500000000000000e+00
    >> b=int8(a)
    b =
      int8
       2
    >> whos
      Name      Size            Bytes  Class     Attributes
      a         1x1                 8  double              
      b         1x1                 1  int8   
    ```

30. 可以使用disp函数在命令行输出变量，类似于C语言的printf，matlab的print是打印图窗或保存为特定文件格式。

# 向量和矩阵

1. matlab会将常量和向量都当作矩阵，而不是单独的类型。

2. 向量，下标默认从1开始。对行列向量都可以使用`( )`来选取元素。

   ```matlab
   a = [1 2 3 4]    %行向量 维度为1x4。也可以用逗号分隔 [1,2,3,4]
   b = [1; 2; 3; 4] %列向量 维度为4x1
   ̃>> a*b  %将向量当作矩阵来计算乘法
   ans = 30  %结果为1x1的矩阵，就是一个数
   >> b*a  %结果为4x4的矩阵
   ans =
       1    2    3    4
       2    4    6    8
       3    6    9   12
       4    8   12   16
   ```

3. 矩阵：

   ```matlab
   >> a = [1 2 3;4 5 6;7 8 9]
   a =
      1   2   3
      4   5   6
      7   8   9
   ```

4. Matlab用（）来做向量和矩阵的索引。认为矩阵是按列存储的，虽然最常用的矩阵赋值是按行赋予的。

   ```matlab
   >> a = [1 2 3;4 5 6;7 8 9]
   a =
      1   2   3
      4   5   6
      7   8   9
   >> a(4)     %将矩阵划分为列向量组，从左到右拼接成一个列向量，再做索引。
   ans = 2
   a(2,3)     %第2行，第3列的元素
   ans = 6
   >> a([1 2 5]) %等价于从列向量组拼成的向量中取出3个数。
   ans =
      1   4   5
   %%% 以下可以从括号内是一个量还是由逗号分隔的2个量来区分，前者的话就是从列向量组中取值，后者就是从矩阵中取值。
   >> a([1 3],[1 3])  %按照[1 3],[1 3]的方式取出子矩阵，也就是网格形式，可以看作是a(2,3)的扩展，行和列的索引都变成了向量。这里不能将[1 3],[1 3]看作两个行向量的水平拼接，因为这里的逗号是用作索引的区分。
   ans =
      1   3
      7   9
   >> a([[1 3],[1 3]]) %等价于a([1 3 1 3])
   ans =
      1   7   1   7
   >> a([1 2;3 4])  %从列向量组拼成的向量中，依次取出[1 2;3 4]，放在对应的位置，组成一个二阶矩阵，相当于 [a(1) a(2);a(3) a(4)]，也就是[1 4;7 2]。
   ans =
      1   4
      7   2
   %%%%%%%%%
   >> b(1)=1; %可以不用声明b是一个向量，可以直接写入
   >> b(3)=3; %间隔写入，会导致中间的都被写入为0
   >> b(2)
   ans = 0
   >> b(4)    %没有声明不能直接读取
   error: b(4): out of bound 3 (dimensions are 1x3)
   ```

5. 索引也可以是logical的向量

   ```matlab
   >> a = [1 2 3 4 ];
   >>  a(logical([1 0 1]))  %按照下标的逻辑值取出向量的元素，构成新的向量，索引必须为logical的向量。
   ans =
      1   3
   >> a(a == 2) =6     %将向量a中等于2的元素都赋值为6
   a =
      1   6   3   4
   ```

6. 为数组预先分配内存会提高速度：

   ```matlab
   %没有为数组预先分配内存
   tic  %计时开始
   for i=1:2000
     for j=1:2000
       A(i,j) = i+j;
     end
   end
   toc  %计时结束 Elapsed time is 2.016782 seconds.
   %为数组预先分配内存
   tic
   A = zeros(2000);
   for i=1:2000
     for j=1:2000
       A(i,j) = i+j;
     end
   end
   toc  %Elapsed time is 0.030410 seconds.
   ```

7. 冒号运算符，用来生成等比数列的向量，默认公差为1。在作为索引时，还表示全部行或列的意思。

   ```matlab
   a = [1:5]   %等价于a = [1 2 3 4 5]。也可以省略中括号写作a = 1:5
   a = [1:2:5] %等价于[1 3 5]
   a = [1:2:4] %结果为[1 3]
   >> a = [1:3;2:4]
   a =
      1   2   3
      2   3   4
   >> a(1,:)     %获取矩阵a的第一行和所有列构成的子矩阵。
   ans =
      1   2   3
   >> a(:,[1 3]) %获取矩阵的第1和3列构成的子矩阵。
   ans =
      1   3
      2   4
   >> linspace (1,5,3)  %将区间[1,5]做3-1等分，结果有3个点，包括起止点。结果存储在一个行向量中，第三个参数默认为100，即分为99份。
   ans =
      1   3   5
   ```

8. 矩阵的拼接，类似于分块矩阵。

   ```matlab
   >> A = [1 2; 3 4];     %也可以看作为两个行向量的竖向拼接
   >> A = [[1;3] [2;4]];  %也可以用列向量水平拼接来构造矩阵
   >> B = [5 6;7 8];
   >> C = [A B]   %水平拼接
   C =
      1   2   5   6
      3   4   7   8
   >> D = [A;B]   %竖向拼接
   D =
      1   2
      3   4
      5   6
      7   8
   >> C = [A zeros(2);zeros(2) B] %对角拼接
   C =
        1     2     0     0
        3     4     0     0
        0     0     5     6
        0     0     7     8
   ```

9. 删除矩阵的某些行或列：

   ```matlab
   A = [1 2 3; 0 5 6;7 0 9];
   A([1 2],:)=[]; %删除A的第1，2行。
   >> A
   A =
        7     0     9
   ```

10. 四则运算，默认进行的是矩阵的乘除法，加点才会进行元素的运算。

    ```matlab
    >> A = [1 2; 3 4];
    >> B = [5 6;7 8];
    >> c = 2;
    >> A+B ;A-B;  %对应的元素相加减
    >> A*B        %矩阵的乘法，要求第一个矩阵的列数=第二个矩阵的行数
    ans =
       19   22
       43   50
    >> A/B       %也就是A*B^(-1),是矩阵方程CB=A的解
    ans =
       3  -2
       2  -1
    >> A.*B     %对应元素相乘，要求两个矩阵的行列数相同
    ans =
        5   12
       21   32
    >> A./B    %对应元素相除
    ans =
       0.2000   0.3333
       0.4286   0.5000
    >> A+c     %矩阵和数运算，就是将改数依次和每个元素进行相同的运算。
    ans =
       3   4
       5   6
    %A*c和A.*c是相同的结果。
    >> A^c   %等价于c个矩阵连乘，例如A^3为A*A*A  只有A是方阵,才有意义
    ans =
        7   10
       15   22
    >> A.^c   %每个元素都进行乘方运算，A的形状任意
    ans =
        1    4
        9   16
    >> A'    %矩阵的转置，也适用于行列向量
    ans =
       1   3
       2   4
    ```

11. 特殊的矩阵：

    ```matlab
    eye(3)     %3阶单位矩阵,eye(2,4)为2行4列的单位矩阵，多余的行或列全为0。
    zeros(3,4) %3行4列的零矩阵,zeros(3)为3阶零矩阵。
    ones(2,4)  %2行4列的全为1的矩阵。ones(3)为3阶全为1的矩阵
    diag([1 2 3 4])  %对角矩阵，只有对角线非零，对角线元素依次为1 2 3 4
    rand(3)    %3阶均匀分布的随机矩阵，取值范围为0到1。rand(2,3)为2行3列的均匀分布的随机矩阵
    ```

12. 矩阵相关的函数，下面的所有操作都不改变矩阵本身：

    ```matlab
    >> A = [1 2 3; 0 5 6;7 0 9]
    A =
       1   2   3
       0   5   6
       7   0   9
    >> max(A)    %相当于对矩阵的列向量组执行max函数。找出每一列的最大值。如果要求每一行的最大值，可以用max(A')，结果都是1x3的向量。如果要找整个矩阵的最大值，可以嵌套max(max(A))。
    ans =
       7   5   9
    >> sum(A)    %对每一列求和
    ans =
        8    7   18
    >> mean(A)   %对每一列求平均值
    ans =
       2.6667   2.3333   6.0000
    >> prod([1 2 3]) %连乘，可以用来计算阶乘。
    ans =
         6
    >> sort(A)   %对每一列单独进行排序,从小到大
    ans =
       0   0   3
       1   2   6
       7   5   9
    >> sortrows (A, 2)  %按照第2列升序排序,整行联动。第二个参数，默认为1
    ans =
       7   0   9
       1   2   3
       0   5   6
    >> sortrows (A, -2) %按照第2列降序排序,整行联动
    ans =
       0   5   6
       1   2   3
       7   0   9
    >> size(A) %获取A的维度，结果为一个行向量[3 3]。size(A(:,1))结果为[3 1]。
    ans =
       3   3
    >> length([1 2 3]) %专门用来获取向量的长度，结果为一个整数。如果对矩阵使用，则结果为行或列的最大值。
    ans = 3
    >> size([1 2 3])  %用size也可以获取向量的维度，不过会当作矩阵来处理，某一个方向的维度为1。
    ans =
       1   3
    >>  find(A == 0)  %查找元素等于0的那个索引,也就是说A(2)和A(6)等于3。实际上A==0的结果是一个和A同维度的逻辑量矩阵，等于0的位置为真，也就是1，反之为假，也就是0。
    ans = 7
    ```


# 结构化程序

1. 脚本需要先存储为.m文件才可以运行，文件名不能以数字开头，大小写有区别，类似于变量名。脚本文件中的每一行都建议用；结尾，这样可以只输出想要输出的。

2. 需要将.m文件存储到path包含的路径或当前目录中，才可以在命令行直接输入文件名来执行该脚本。

3. %之后的内容为单行注释，两个%%中间的为一个section，代码块。也可以通过插入分节符来完成，可以单独运行一节。如果不想保存文件的同时运行代码，可以点击运行节。%%后面也可以添加注释。

4. 只有保存文件后，才可以在文件中打断点进行调试。调试过程中，命令行输出界面的`>>`变为`K>>`，此时也是可以继续在此执行命令的。

5. matlab可以设置条件断点或暂时禁用断点。还可以设置出现NaN或Inf，警告或错误时暂停执行当前脚本。

6. matlab的缩进是非必须的，可以全选使用智能缩进。

7. 流程控制语句，if，while，for都必须用end结尾，条件部分都不用加分号，语句可以加可不加，会影响输出。

   ```matlab
   if 条件1        %条件不需要加括号等，esleif和else都可以省略
   	语句1
   elseif 条件2  %可以有多个
   	语句2
   else          %只能有一个，而且没有条件，执行到此时，会无条件进入
   	语句3
   end   %不能省略
   %%
   switch 表达式    %表达式的结果是一个数
   case 值1         %可以有多个
   	语句1
   otherwise     %只能有一个，如果以上都不满足，最终会执行到这里，类似于if中的else
   	语句n
   end
   %%
   while 表达式    %先判断表达式，为真的话执行语句，然后再判断表达式，循环往复。
   	语句
   	if a > 3
   		break     %终止本层循环
   		continue  %跳过本次循环中未执行的代码
   	end
   end
   %%
   for 变量=起点:增量:终点
   	语句
   end
   ```

8. 关系运算符，结果为logical类型的，1表示真，0表示假：

   ```matlab
   <  % 小于
   <= % 小于等于
   >  % 大于
   >= % 大于等于
   == % 是否相等
   ~= % 是否不相等
   && % 逻辑与
   || % 逻辑或
   ~  %逻辑非
   ```

9. 部分符号和数字之间必须有空格，建议都加上空格。

   ```matlab
   >> a += 1;
   >> a +=1;   %会报错
   error: a used as variable and later as function
   ```

10. 脚本的开头建议执行一下几条语句：

    ```matlab
    clear all   %清理所有的变量
    close all   %关闭所有的图片
    clc         %清理显示终端
    ```

11. 有时一行不够书写时，可以使用`...`来续行。在脚本和命令行中都可以使用。

12. 如果左下角显示Busy或正忙，则表示当前程序正在执行，还没有返回。可以按Ctrl+C强制终止。

13. 函数和脚本类似，不过脚本没有输入参数和输出结果，脚本的所有的变量都是在全局空间中的，而函数都是在局部空间内。

14. 函数的定义需要保存到单独的和函数名相同文件中，文件需要放在matlab的路径下，才能搜索到，所有的输入和输出都是可选的，调用时不检查参数：

    ```matlab
    function y = mean(x,dim,flag)      %定义函数,接受3个参数,将y作为输出返回,最后可以没有end，如果没有的话，就表示到文件结尾都是函数的范围。因此建议加上end，这样可以在一个文件中定义多个函数。
    function [y,v] = mean(x,dim,flag)  %若要返回多个值，可以用向量包裹起来，
    [a b] = mean(1,2,3)                %调用的时候也用向量来接受
    ```

15. 同一个文件中，第一个定义的函数为全局函数（可以被外部直接调用），必须和文件名相同，后续函数都是局部函数，只能内部使用，且不能和全局函数重名。内部函数的出现是为了方便函数编写而拆分的。

    ```matlab
    % 文件名为test.m
    function y=test(x)
    y=test2(x); %调用局部函数
    end
    % 局部函数，
    function y=test2(x)
    y=x-3;
    end
    ```

16. 函数的实际参数个数不能大于形式参数个数，即可以省略参数，此时不报错。

17. 函数内会有一些默认的变量：

    ```matlab
    inputname(argNumber) %返回与参数编号argNumber对应的工作区变量名称。如果参数是常量，则函数范围空字符串。
    mfilename  %当前函数所在的m文件的名称，不包括.m
    nargin     %实际输入参数的个数，而非函数定义中的形参个数。
    nargout    %实际输出参数的个数，这个和调用函数时使用了几个参数来接受有关，而非函数定义中的输出个数。有些函数会根据用户调用时的输入参数和输出参数的数量，进行不同的操作，返回不同的结果。
    %例如test(5,6)，nargin为2，nargout为0。
    varargin   %输入参数的维度
    varargout  %输出参数的维度
    ```

18. 函数句柄，也就是匿名函数，内置函数也可以作为参数传递给需要句柄的函数中，不过前面要加上@，例如@mean。

    ```matlab
    f = @(x) exp(-2*x);   %x是输入变量，后面是函数体。f是function handle类型的，会作为一个变量出现在工作空间中，优先级比文件中的函数高。
    x=3;
    f(x) %结果为0.002478752176666
    ```

19. which函数可以定位函数和文件的完整路径。

    ```matlab
    >> which("mean.m")
    D:\Program Files\MATLAB\R2023b\toolbox\matlab\datafun\mean.m
    ```

20. matlab中函数的调用：

    ```matlab
    which("mean.m")  %等价于 which mean.m，后者不用加引号，不过不是所有函数都支持后者的方式。
    ```

# 绘图

1. matlab无法直接绘制函数图，只能人工离散化后再进行绘制。
2. 一个图窗包含多个对象，Figure对象（也就是背景布），Axes对象（坐标系统），Line对象（曲线），前者包含后者。Axes中除了包含曲线外，还可以包含Legend图例，Text文本，Surface曲面等。
3. `plot(x,y)`，要求1维数组x和y的大小相同，行或列向量无所谓。如果省略x则，会用`[1:n]`替代，其中`n=length(y)`。
4. 如果当前没有图窗，则会创建一个新的图窗用于绘制。默认情况下，新的plot会顶替掉旧的。
5. 使用`hold on`可以在同一个图窗上绘制多个曲线。

   ```matlab
   figure;
   hold on %这个hold on也可以放在第一个plot函数之后
   plot(cos(0:pi/20:2*pi));
   plot(sin(0:pi/20:2*pi));
   hold off
   ```
6. plot的第三个参数用于设置点的形式和颜色，线的形式和颜色。
7. 一个plot命令中也可以绘制多条曲线：

   ```matlab
   plot(0:pi/20:2*pi,cos(0:pi/20:2*pi),0:pi/20:2*pi,sin(0:pi/20:2*pi)) %注意这里不能省略x，否则第1个y会被当作x。
   ```
8. 使用`legend("cos(x)","sin(x)")`来按顺序设置图例，`title("图名")`添加图名，`xlabel("x轴")`添加xyz轴的标题。这里都支持latex的语法。
9. 绘制线段：

   ```matlab
   line([2,2],[2,5]);  %绘制一个，这个不需要hold on，也不会顶替当前图。
   ```
10. 向图中添加文字标注和箭头指向：

    ```matlab
    str = '$$\int_0^{2\pi}x^2dx$$'; %构造内容
    text(2.5,2,str,'interpreter','latex'); %前两个参数是位置，使用坐标轴的度量，第4和5个参数是设置属性，表示使用latex来作为解释器。
    annotation('arrow','X',[0.32 0.5],'Y',[0.6 0.4]); %设置箭头形式，起始点坐标为(0.32,0.6)，终点坐标为(0.5,0.4)，注意这里的坐标是图形的百分比，而非坐标轴的绝对值。
    ```
11. 可以使用如下函数操作图窗及其子对象：

    ```matlab
    f1 = figure; %该命令会创建一个新的图窗，使用变量f1保存。
    gcf  %返回当前图窗的句柄。如果图窗不存在，则gcf将创建一个图窗并返回其句柄。
    gca  %返回当前figure中的当前axes（或独立可视化）。如果当前图窗中没有坐标区或图，则gca会创建一个笛卡尔坐标区对象。
    child_handles = allchild(handle_list) %为每个句柄返回所有子对象的列表（包括具有隐藏句柄的子级）。如果handle_list为单个元素，则allchild以向量返回该输出。
    p = ancestor(h,type) %如果前代是type指定的图形对象类型之一，则返回h的最近前代的句柄。type可以是{'figure','axes'}。
    delete(obj) %删除指定的对象。如果 obj 是数组，则 delete 将删除数组中的所有对象。
    h = findall(objhandles) %返回objhandles中的图形对象及其所有后代。
    ```
12. 使用get和set函数来获取和设置对象的属性，注意get和set的属性名不区分大小写，而使用点获取属性需要区分大小写。

    ```matlab
    s = plot([1 2 3]);
    get(s,"color") %返回[0 1 0]
    set(s,"Color",[1 0 0]) %设置颜色为红色，等价于s.color = [1 0 0]
    ```
13. tick为坐标轴上的tick的数值，必须是一个数值数组，ticklabel为对应tick处显示的文本（可以使用latex语法），可以和tick相同，也可以不同。
14. 使用subplot为图窗添加多个axes，也就是绘制子图。

    ```matlab
    %切换到子图中，如果没有则创建。
    subplot(1,2,1); plot([1 2 3]); %1行2列，1表示第1个，按行索引。
    subplot(1,2,2); plot([4 5 6]); %1行2列，2表示第2个。
    ```
15. 如果有多个figure，gcf和gca都是最后产生的figure。
16. `axis equal`，可以设置两个坐标轴的实际像素占比相同。
17. ![image-20250404135756470](Matlab基础.assets/image-20250404135756470.png)
18. `axis off`，`box off`，`grid off`可以分别关闭坐标轴，框线和格线。
19. 可以使用saveas或print（可以控制大小和解析度）来保存图片，可以是位图或矢量格式。
20. `semilogx，semilogy，loglog`函数可以绘制单对数或双对数曲线图。
21. `plotyy(x,y1,x,y2)`可以绘制双y轴曲线，二者共用1个x轴。
22. `polar(theta,r)`函数可以根据极坐标来绘制图形。
23. `errorbar(x,y,e)`函数可以绘制带误差棒的曲线。
24. `fill`函数可以填充封闭的曲线。
25. matlab使用一个包含三个元素的数组来表示颜色，`[0 255 0]`表示绿色。
26. 可以将一个三维的图的第三维度变成颜色，绘制在平面上，也就是云图效果。

    ```matlab
    [x y] = meshgrid(-3:0.2:3, -3:0.2:3); %30x30的网格
    z = x.^2+x.*y+y.^2;
    surf(x,y,z); box on;
    imagesc(z); %将数组z中的数据显示为一个图像，该图像使用颜色图中的全部颜色。z的每个元素指定图像的一个像素的颜色。生成的图像是一个m×n像素网格，其中m和n分别是z的行列数。这些元素的行索引和列索引确定了对应像素的中心。
    ```
27. ![image-20250404141735058](Matlab基础.assets/image-20250404141735058.png)
28. `colorbar`可以显示颜色栏（可以在图窗上的工具栏手动添加），类似于云图的图例。还可以使用`colormap`函数来指定图例的颜色过度类型。
29. 3维绘图函数，实际上plot绘制的图也是3维的，不过z轴取值都是0，可以通过旋转图像发现。

    ```matlab
    plot3(x,y,z)   %3D空间的曲线图，其中x,y,z分别为一维数组，长度为曲线的点数。
    surf(x,y,z)    %3D空间的曲面图，其中x,y,z都是二维数组。
    surface(x,y,z) %
    mesh(x,y,z)    %和surf类似，不过不填充网格小面。
    contour(x,y,z) %等高线彩色图(不填充)，可以控制等高线的间隔。
    contourf(x,y,z)%填充的等高线彩色图
    surfc(x,y,z)   %就是surf和contour的组合，会在底部z平面绘制等高线图。
    meshc(x,y,z)   %就是mesh和contour的组合，会在底部z平面绘制等高线图。
    ```
30. 使用meshgrid生成坐标网格

    ```matlab
    [x y] = meshgrid(-2:1:2, 2:1:5);  %创建曲面图所需的网格。第一个参数是x轴范围，第二个是y轴范围。
    %两个矩阵都是4x5的
    x = %将-2:1:2=[-2 -1 0 1 2]向下扩展
        -2    -1     0     1     2
        -2    -1     0     1     2
        -2    -1     0     1     2
        -2    -1     0     1     2
    y = %将(2:1:5)'=[2 3 4 5]'向右扩展
         2     2     2     2     2
         3     3     3     3     3
         4     4     4     4     4
         5     5     5     5     5
    ```
31. 例子：

    ```matlab
    >> [x y] = meshgrid(-3.5:0.2:3.5, -3.5:0.2:3.5);
    >> z = x.*exp(-x.^2-y.^2);
    >> subplot(2,2,1); mesh(x,y,z);
    >> subplot(2,2,2); surf(x,y,z);
    >> subplot(2,2,3); contour(x,y,z); 
    >> subplot(2,2,4); surfc(x,y,z);
    ```
32. <img src="Matlab基础.assets/image-20250405011505927.png" alt="image-20250405011505927" style="zoom:67%;" />
33. `view(Azimuth, Elevation)`可以为当前坐标区设置相机视线的方位角和仰角，角度单位。`view(2)`可以按俯视角度观察，此时相当于`view(0,90)`。使用工具旋转时，图窗左下角也会显示这两个参数。
34. ![image-20250405010934302](Matlab基础.assets/image-20250405010934302.png)
35. light函数可以设置光源位置，等属性。一个图窗可以有多个光源。
36. `patch(X,Y,C)` 可以创建一个或多个彩色多边形补片，也就是小面。

# 符号运算

1. 符号计算可以含有未定义的符号变量，计算结果是精确的，运行速度稍慢，数值计算的结果是有限精度的。符号运算可以用于公式推导。数值计算中必须先对变量进行赋值，然后才能参与运算。符号变量可以赋值，也可以不赋值。

2. 数值计算在处理病态问题时，收敛慢且容易出错。符号运算可以给出精确结果，可以避免舍入误差。

3. Maple软件的符号计算功能比matlab要强。

4. 创建符号变量：

   ```matlab
   x = sym("x", set); %set为字符串类型，用于设置符号变量的取值约束，可以为positive，integer，rational，real或composite等。
   sym("x", "clear"); %清楚先前用set参数设置的符号变量var的约束。
   %
   y=sin(x); %定义一个依赖于符号变量的表达式，而非符号函数，因为此时x和y的函数关系是明确的。
   %可以同时创建多个同名的符号变量
   syms x a;  %相当于x=sym("x");x=sym("a");
   syms z(t); %定义1个符号变量t，和一个符号函数z，z是t的函数。
   syms x y z positive; %创建3个符号变量，并设置3个约束。
   ```

5. 推荐仅使用sym创建符号变量，然后再使用assume设置其约束。

   ```matlab
   assume(x,{'positive','integer'}); %正整数，第一个参数不应为字符串，而应该是符号变量，因为此时该符号变量已经创建了。
   assume(y<-1 | y>1); %或的关系
   assume(z>-1 & z<1); %且的关系
   assume(~in(y,'integer'));  %y不是整数
   assume(z/2, 'integer'); %z为偶数
   assume(z<x); %可以引用其他符号变量
   %可以输出符号变量的约束，默认输出所有的约束，也可以指定要查看的符号变量或表达式。
   >> assumptions
   ans =
   [in(x, 'integer'), 1 <= x] %2个，都是关于x的
   %对同一个符号变量的多个assume，后者会覆盖前者。可以使用assmueAlso来附加约束。
   >> assume(x<4)
   >> assume(x>1)
   >> assumptions
   ans =
   1 < x
   >> assumeAlso(x<6)
   >> assumptions
   ans =
   [1 < x, x < 6]
   ```

6. 可以保存假设，并再后期恢复假设：

   ```matlab
   syms x;
   assume(x<4);
   tmp = assumptions; %保存所有假设，也可以只保存指定符号变量的假设。tmp的类型也是符号变量。
   assume(tmp);%恢复tmp中保存的假设
   ```

7. 可以将数值转化为一个符号，这样可以保留精度来进行运算。

   ```matlab
   x = sym(2);
   x^0.01^100; %结果为2，如果x不是符号变量，则结果为2.000000000000015
   %推荐对子表达式定义符号变量，而非对整个表达式
   y= sym(1234567);
   z=1/y;  %而非z=sym(1/1234567)，因为后者会被当作7650239286923505/9444732965739290427392。
   z=sqrt(123456); %而非z=sym(sqrt(123456))，后者会被当作3090622161171759/8796093022208。
   ```

8. 创建符号矩阵

   ```matlab
   A = sym('A',[3,4],'positive'); %A为3行4列的矩阵，通过(m,n)来索引，而非Am_n。每个元素都是正数。
   A =
   [A1_1, A1_2, A1_3, A1_4]
   [A2_1, A2_2, A2_3, A2_4]
   [A3_1, A3_2, A3_3, A3_4]
   %也可以手动设置每项的格式
   B = sym('B%d%d',3) %3阶方阵
   B =
   [B11, B12, B13]
   [B21, B22, B23]
   [B31, B32, B33]
   ```

9. 从匿名函数句柄创建符号表达式：

   ```matlab
   fhandle1 = @(x) sin(x)+cos(x); %创建函数句柄
   sym_h = sym(fhandle1); %创建符号表达式
   ```

10. 可以用ezplot或ezmesh来根据符号变量绘制2D曲线或3D曲面。

11. 定义向量值函数：

    ```matlab
    syms x;
    f(x) = [x+1 x.^2];
    f(3)     %结果为[4 9]
    f([2 6 4]) %结果为1x2的cell数组，{[3    7    5]}    {[4    36    16]}
    ```

12. 查找符号表达式中的符号，像pi，i，j等这样的变量，不用定义，可以直接当作符号变量来使用。

    ```matlab
    symvar('cos(pi*x - beta1)')  %结果为2×1的cell数组{'beta1'} {'x'}。
    %symvar(expr) 搜索表达式 expr，查找除 i、j、pi、inf、nan、eps和公共函数之外的标识符。这些标识符是表达式中变量的名称。
    ```

13. 合并同类项，也就是归纳为变量的多项式：

    ```matlab
    syms x;
    f1 = (exp(x)+x)*(x+2);
    collect(f1);  %结果为x^2 + (exp(x) + 2)*x + 2*exp(x)。首先展开，然后按照x(如果不指定变量，默认为x)的幂次合并同类项。
    syms x y;
    f2 = x^2*y+y*x-x^2-2*x;
    collect(f2,x); %关于x合并，结果为(y - 1)*x^2 + (y - 2)*x。
    collect(f2,y); %对y进行合并，结果为(x^2 + x)*y - x^2 - 2*x。
    %可以指定对多个符号变量进行合并同类项，可以构成乘积项。
    syms a b x y;
    f3 = a^2*x*y+a*b*x^2+a*x*y+x^2;
    collect(f3,[x y]) %结果为(a*b + 1)*x^2 + (a^2 + a)*x*y
    ```

14. 展开符号表达式，操作对象可以是多项式，三角函数，指数函数等。

    ```matlab
    syms x y;
    f1 = sin(x+3*y);
    e1 = expand(f1) %结果为4*cos(y)^3*sin(x) - 3*cos(y)*sin(x) - cos(x)*sin(y) + 4*cos(x)*cos(y)^2*sin(y)
    %然后可以再对结果进行合并同类项
    collect(e1,cos(y)) %结果为4*sin(x)*cos(y)^3 + 4*cos(x)*sin(y)*cos(y)^2 + (-3*sin(x))*cos(y) - cos(x)*sin(y)
    collect(e1,'cos') %也可以对函数形式进行合并，结果为4*sin(y)*cos(x)*cos(y)^2 + (-sin(y))*cos(x) + 4*sin(x)*cos(y)^3 + (-3*sin(x))*cos(y)
    %多项式展开
    syms x y;
    f1 = (x+y)^3;
    expand(f1) %结果为x^3 + 3*x^2*y + 3*x*y^2 + y^3
    %可以设置只只进行算术（加减乘除，乘方，开方操作）展开
    syms x;
    f1 = (sin(3*x)+1)^2;
    expand(f1) %默认会展开3*x，结果为sin(x)^2 - 2*sin(x) + 8*cos(x)^2*sin(x) - 8*cos(x)^2*sin(x)^2 + 16*cos(x)^4*sin(x)^2 + 1
    >> expand(f1,"ArithmeticOnly",true) %结果为 2*sin(3*x) + sin(3*x)^2 + 1
    %忽略约束条件
    syms x y;
    f1 = log(x*y);
    expand(f1) %结果还是log(x*y)
    expand(f1,"IgnoreAnalyticConstraints",true) % log(x) + log(y)，这个展开只有在满足x和y均大于0时才有效。注意，这里不会自动为x,y加约束。
    ```

15. 将函数转化为嵌套表达式，多项式的嵌套格式会在计算是减少运算次数。秦九韶算法（也成为霍纳算法）。

    ```matlab
    syms x;
    f1 = expand((x+3)^3);
    horner(f1) %结果为x*(x*(x + 9) + 27) + 27
    ```

16. 因式分解：

    ```matlab
    factor(5*9*8*7); %结果为[2 2 2 3 3 5 7]
    factor(sym('1234567898765432')) %大数可以用字符串表示，转化为符号后，再进行因式分解。结果为[2, 2, 2, 7, 11, 73, 101, 109, 109, 137, 167]
    factor(sym(112/81)) %分数也可以，结果为[2, 2, 2, 2, 7, 1/3, 1/3, 1/3, 1/3]
    syms x;
    factor(4*x^3+x^4+8*x+5*x^2+6) %可以对符号表达式分解，结果为[x + 3, x + 1, x^2 + 2]
    %默认情况下，只对有理数进行因式分解，也可以指定参数
    syms x;
    factor(x^4 - 2*x^2 - 3, x) %默认结果为[x^2 - 3, x^2 + 1]
    factor(x^4 - 2*x^2 - 3, x,"FactorMode","real") %会将x^2-3进行分解，结果为[x - 1.7320508075688772935274463415059, x + 1.7320508075688772935274463415059, x^2 + 1.0]
    factor(x^4 - 2*x^2 - 3, x,"FactorMode","complex") %会将x^2+1进行分解，结果为[x + 1.7320508075688772935274463415059, x - 1.7320508075688772935274463415059, x + 1.0i, x - 1.0i]
    ```

17. 化简表达式，使用Maple中的化简方法。通常情况下，matlab输出的结果都是化简过的，再对其进行化简，效果不大。

    ```matlab
    syms x;
    simplify(sin(x)^2+cos(x)^2) %结果为1
    simplify((x^2+5*x+6)/(x+2)) %结果为x + 3
    ```

18. 符号表达式的替换

    ```matlab
    %将符号表达式中，重复出现的字符串替换为中间变量，以简化表达式。
    syms x;
    f1 = (x^2+1)/(x^2+3)+x^4;
    subexpr(f1,"beta") %结果为(beta + 1)/(beta + 3) + beta^2，其中beta = x^2。matlab会使用beta来表示中间变量，如果没有提供，则使用默认的sigma。
    %将符号表达式中的符号变量替换为具体的值或普通变量，也就是对符号表达式进行求值
    syms x;
    f1 = x^2;
    subs(f1,3) %结果为9，用3替换x。
    %将符号表达式中的符号变量替换为新的符号变量
    syms x t;
    f1 = x^2;
    f2 = subs(f1,x,t) %结果为t^2，注意，不会改变f1。
    ```

19. 将有理表达式转化为浮点数：

    ```matlab
    syms x;
    f = 1/3*sin(2*pi*x);
    s1 = subs(f,0.2) %结果为(2^(1/2)*(5^(1/2) + 5)^(1/2))/12
    vpa(s1) %结果为0.31701883876505119070547977779313
    vpa(s1, 15) %只保留8位有效数字，0.317018838765051。
    ```

20. 符号表达式的美化显示：

    ```matlab
    syms x;
    f1 = sin(x)+x^3+3*x+2;
    pretty(f1)
    %输出结果为
                    3
    3 x + sin(x) + x  + 2
    latex(f1) %结果为'3\,x+\sin\left(x\right)+x^3+2'
    ```

21. 对符号函数进行绘图，也可以直接对函数句柄进行绘制，而不用转化为符号表达式。

    ```matlab
    %ezplot和ezplot3分别进行2D和3D曲线的绘制，不过推荐使用fplot和fplot3替换二者。
    %ezmesh和ezsurf绘制3D网格图和3D表面图，不过推荐使用fmesh和fsurf替换二者。
    %ezcontour和ezcontourf绘制等值线和带有填充的等值线，不过推荐使用fcontour。
    %ezmeshc和ezsurfc相当于ezmesh和ezsurf附加了投影等高线图，推荐使用fmesh和fsurf附加'ShowContour','on'参数来开启投影等高线图。
    %ezpolar绘制极坐标图，默认域为0到2pi。
    ```

22. `ezplot`的默认的区间为`[-2pi, 2pi]`，可以手动指定区间。

    ```matlab
    syms y(x); %显函数
    ezplot(y,[xmin,xmax]);
    f(x,y)=0; %隐函数绘制，功能非常强大
    ezplot(f,[xmin,xmax,ymin,ymax]); %默认x,y都在[-2pi,2pi]。
    x=x(t),y=y(t); %参数方程
    ezplot(x,y,[tmin,tmax]); %默认t在[-2pi,2pi]。
    ```

23. `ezplot3`函数可以添加'animate'参数来生成空间曲线的运动轨迹。图窗左下角可以重复播放动画。

24. 空间曲面的显式方程可以指定区间：`ezmesh(z,[min,max])`区间表示的是x和y的坐标范围，默认平均分为60段，如果x和y的范围不同，可以分别指定。

25. 空间曲面的参数方程需要两个参数，一般为s和t。`ezmesh(x,y,z,[smin,smax,tmin,tmax])`如果s和t的范围相同，可以指定一对范围。

26. 符号表达式求极限：

    ```matlab
    limit(F,x,a) %计算当x趋近于a时，表达式F的值。可以添加'right'或'left'来单独求左或右极限。
    ```

27. 

28. 

29. 

30. 

31. 

32. 

33. 

34. 

35. 

36. 