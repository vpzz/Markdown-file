# 基础

1. 安全通信的三要素：
   1. 机密性，双方要传递的信息不能被第三方看到，可以通过将明文加密解决。
   2. 报文完整性，不会被篡改。 可以通过数字摘要+数字签名的方式来解决。
   3. 端点鉴别，通信双方能够证实另一方的身份。不能冒充身份。可以通过消息认证码或数字签名解决。
   4. 防止事后否认，这里不包括恶意的第三方。       可以通过数字签名解决。
2. 互联网上使用的加密和解密算法都是公开的，通信双方具有第三方所没有的，就是密钥。
3. 对称密钥系统：发送方和接收方使用相同的密钥进行加密和解密。如何安全地分发密钥是一个重要问题，一般采用线下的方法。对称加密的密钥是由一方生成，然后发送给另一方。
4. 公开密钥系统：使用不同的密钥进行加密和解密，公钥能解密私钥加密的数据，私钥也能解密公钥加密的数据。每个人都有一对公钥和私钥。看起来是一种天衣无缝的方法，但是有两个缺点：
   1. 第三方虽然不可以解密内容，但是可以对密文进行胡乱修改，接收方收修改后的到密文，并不能判断密文的是否被修改过。
   2. 效率比对称密钥系统低。

# 散列函数

1. ，又称为哈希函数，特点如下：
   1. 无论的数据长短，计算总是得到一个定长的内容。
   2. 相同的输入，一定得到相同的输出。
   3. 正求哈希值很容易，反求则不可行。
2. 对一个好的散列函数来说，要找到两个不同的输入对应相同的输出（哈希碰撞），实际上是不现实的。就像数据的指纹。数据被修改后，它的散列值就会发生变化。
3. 哈希函数的应用有：
   1. 防止传输的密码泄露。登录网站时，会在本地将输入的密码进行哈希运算，然后上传到服务器，和服务器保存的注册时的密码的哈希值对比。及时网站被人盗取，密码的明文也不会被泄露，防止被用于撞库，因为一个人在大部分网站设置的密码都是一样的。

# 数字签名

1. 利用数字签名来识别身份：
   1. 利用发送方的私钥对内容进行加密（这一步成为签名）。
   2. 发送方把内容和签名后的内容一同发送给接收方。
   3. 接收方使用发送方声称的身份的公钥（公开获取的）解密，如果发现结果和内容相同，则可以认为发送方确实是拥有该公钥对应的私钥。即可判定发送方的身份。
2. 数字签名不仅可以识别身份，还可以确保内容的完整性，如果第三方篡改了内容，接收方在解密后发现结果和内容不符，即可认为该内容被篡改。当然也有可能是发送方并不是该公钥的拥有者，即身份不对。
3. 实际使用中，由于对大块内容进行签名耗费时间，一般是对内容的哈希值进行签名。接收方解密后，计算内容的哈希值，比较即可认定内容的完整性。
4. 公钥算法的两大应用就是：更安全的加密（加密和解密）和数字签名（签名和验证）。     这也是为什么公钥也被称作key的原因。
5. 数字签名需要内容和私钥，产生签名后的文件和签名信息        验证签名需要  公钥，签名后的文件和签名信息，结果为是否通过验证。
6. 数字签名的三大作用：
   1. 认证，确实文件是否为特定人签署。这也是最基本的作用。如果用他的公钥可以通过验证，那么就是他签名的。
   2. 防止抵赖，同上
   3. 防止篡改，签名的内容是要传输内容的哈希值。如果解密出来的哈希值和传输内容的对不上，那么内容就被修改了。        这个是纸笔签名不能做到的。
7. <img src="加解密基础.assets/image-20210128004956954.png" alt="image-20210128004956954"  />
8. 私钥不能泄露，同时非对称算法要求不能通过一个公钥算出另一个私钥。反之亦然。
10. 非对称加密无法防止中间人攻击，公钥交换时，第三方将自己的公钥分发给了双方。这样双方发送的消息，第三方都能解密，然后可以进行修改后再发送给接收方。
11. 混合加密，分别用到了对称和非对称加密的优点。传输大量数据时，发送方生成一个对称密钥，然后用接收方的公钥加密该对称密钥，发送给接收方，接收方解密后获得对称密钥，之后双方使用对称密钥来传输大量数据。混合加密也会受到中间人攻击，因为他是用到了非对称加密。
12. 预防中间人攻击的可靠方法是选取一个可信的中间人。即CA。

# 消息认证码

1. 消息认证码使用对称加密，双方有两套密钥，一套用来加解密发送内容的密钥A，一套用来生成消息认证码的密钥B。这两个密钥要以安全的方式发送给对方，不能泄露。可以使用混合加密+CA的方式。
2. 发送方先用A密钥来加密要发送的内容，然后把密文和密钥B一起丢入哈希函数，计算得到消息认证码。再将密文和消息认证码一起发送给接收方。接收方收到后，用自己密钥B和收到的密文进行哈希运算，查看得到的结果和收到的消息认证码是否一致。如果一致，然后再用密钥A对密文进行解密。如果不一致，则丢弃。
3. 消息认证码可以防止篡改，因为第三方截获密文和消息认证码后，对密文或消息认证码修改，因为没有密钥B，所以无法保证修改后的密文和消息认证码对应。
4. 消息认证码还可以防止假冒身份，第三方因为没有密钥A和B，生成的密文和消息认证码，在接收方处，无法通过密钥B的检验。
5. 消息认证码加上随机数就可以预防==重放攻击==，重放攻击指的是，第三方截获消息后，不修改，而是多次给接收方发送消息，这样也有可能会导致问题出现。如果只是用之前的机制，接收方是无法判断发送方到底发送了多少次。
   1. 为了预防重放攻击，发送方再生成消息认证码时，除了加入密钥B，还加入一个随机数，将密文，随机数，消息认证码一起发出去。每条消息都是用不同的随机数。这样接收方在收到后，只要观察到随机数相同的包，就丢弃后到的。
   2. 还有一种加入随机数的方法是，把随机数加入到要加密的明文中，生成消息认证码和之前一样，这样接收方就需要解密后才能看到随机数，判断是否为存在重放。
